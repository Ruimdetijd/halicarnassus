!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Halicarnassus=e():t.Halicarnassus=e()}(this,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/dist/",i(i.s=96)}([function(t,e,i){"use strict";i.d(e,"q",function(){return n}),i.d(e,"u",function(){return r}),i.d(e,"d",function(){return o}),i.d(e,"e",function(){return s}),i.d(e,"E",function(){return a}),i.d(e,"F",function(){return h}),i.d(e,"r",function(){return c}),i.d(e,"a",function(){return l}),i.d(e,"j",function(){return u}),i.d(e,"x",function(){return d}),i.d(e,"v",function(){return p}),i.d(e,"i",function(){return f}),i.d(e,"f",function(){return _}),i.d(e,"b",function(){return g}),i.d(e,"w",function(){return v}),i.d(e,"h",function(){return y}),i.d(e,"t",function(){return m}),i.d(e,"G",function(){return b}),i.d(e,"I",function(){return x}),i.d(e,"H",function(){return E}),i.d(e,"l",function(){return C}),i.d(e,"s",function(){return O}),i.d(e,"m",function(){return T}),i.d(e,"J",function(){return w}),i.d(e,"o",function(){return R}),i.d(e,"A",function(){return I}),i.d(e,"B",function(){return S}),i.d(e,"C",function(){return P}),i.d(e,"D",function(){return M}),i.d(e,"z",function(){return j}),i.d(e,"y",function(){return L}),i.d(e,"c",function(){return A}),i.d(e,"n",function(){return F}),i.d(e,"K",function(){return k}),i.d(e,"g",function(){return z}),i.d(e,"p",function(){return N}),i.d(e,"k",function(){return G});var n=1,r=770,o=36064,s=16384,a=4,h=5,c=771,l=34962,u=34963,d=35040,p=35044,f=35048,_=2884,g=3042,v=2960,y=2929,m=3089,b=5121,x=5123,E=5125,C=5126,O=6408,T=35632,w=35633,R=9729,I=10240,S=10241,P=10242,M=10243,j=3553,L=33984,A=33071,F=36160,D=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function k(t,e){for(var i=D.length,n=0;n<i;++n)try{var r=t.getContext(D[n],e);if(r)return r}catch(t){}return null}var N,G,z=!0;if("undefined"!=typeof window&&"WebGLRenderingContext"in window)try{var U=k(document.createElement("CANVAS"),{failIfMajorPerformanceCaveat:!0});U&&(!0,N=U.getParameter(U.MAX_TEXTURE_SIZE),G=U.getSupportedExtensions())}catch(t){}},function(t,e,i){"use strict";var n=i(11),r=i(48),o={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function s(t){for(var e=f(),i=0,n=t.length;i<n;++i)E(e,t[i]);return e}function a(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function h(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function c(t,e,i){var n,r;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*r}function l(t,e){return d(t,e[0],e[1])}function u(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function d(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function p(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],a=e[0],h=e[1],c=o.UNKNOWN;return a<i?c|=o.LEFT:a>r&&(c|=o.RIGHT),h<n?c|=o.BELOW:h>s&&(c|=o.ABOVE),c===o.UNKNOWN&&(c=o.INTERSECTING),c}function f(){return[1/0,1/0,-1/0,-1/0]}function _(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function g(t){return _(1/0,1/0,-1/0,-1/0,t)}function v(t,e){var i=t[0],n=t[1];return _(i,n,i,n,e)}function y(t,e){return C(g(e),t)}function m(t,e,i,n,r){return O(g(r),t,e,i,n)}function b(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function x(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function E(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function C(t,e){for(var i=0,n=e.length;i<n;++i)E(t,e[i]);return t}function O(t,e,i,n,r){for(;i<n;i+=r)T(t,e[i],e[i+1]);return t}function T(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function w(t,e,i){var n;return(n=e.call(i,I(t)))?n:(n=e.call(i,S(t)))?n:(n=e.call(i,D(t)))?n:(n=e.call(i,F(t)))||!1}function R(t){var e=0;return G(t)||(e=k(t)*L(t)),e}function I(t){return[t[0],t[1]]}function S(t){return[t[2],t[1]]}function P(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function M(t,e){var i;return e===r.a.BOTTOM_LEFT?i=I(t):e===r.a.BOTTOM_RIGHT?i=S(t):e===r.a.TOP_LEFT?i=F(t):e===r.a.TOP_RIGHT?i=D(t):Object(n.a)(!1,13),i}function j(t,e,i,n,r){var o=e*n[0]/2,s=e*n[1]/2,a=Math.cos(i),h=Math.sin(i),c=o*a,l=o*h,u=s*a,d=s*h,p=t[0],f=t[1],g=p-c+d,v=p-c-d,y=p+c-d,m=p+c+d,b=f-l-u,x=f-l+u,E=f+l+u,C=f+l-u;return _(Math.min(g,v,y,m),Math.min(b,x,E,C),Math.max(g,v,y,m),Math.max(b,x,E,C),r)}function L(t){return t[3]-t[1]}function A(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return N(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):g(n),n}function F(t){return[t[0],t[3]]}function D(t){return[t[2],t[3]]}function k(t){return t[2]-t[0]}function N(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function G(t){return t[2]<t[0]||t[3]<t[1]}function z(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function U(t,e){var i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n}function B(t,e,i){var n=!1,r=p(t,e),s=p(t,i);if(r===o.INTERSECTING||s===o.INTERSECTING)n=!0;else{var a,h,c=t[0],l=t[1],u=t[2],d=t[3],f=e[0],_=e[1],g=i[0],v=i[1],y=(v-_)/(g-f);s&o.ABOVE&&!(r&o.ABOVE)&&(n=(a=g-(v-d)/y)>=c&&a<=u),n||!(s&o.RIGHT)||r&o.RIGHT||(n=(h=v-(g-u)*y)>=l&&h<=d),n||!(s&o.BELOW)||r&o.BELOW||(n=(a=g-(v-l)/y)>=c&&a<=u),n||!(s&o.LEFT)||r&o.LEFT||(n=(h=v-(g-c)*y)>=l&&h<=d)}return n}function Y(t,e,i){var n=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(n,n,2),function(t,e,i){return _(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}([n[0],n[2],n[4],n[6]],[n[1],n[3],n[5],n[7]],i)}i.d(e,"b",function(){return s}),i.d(e,"c",function(){return a}),i.d(e,"d",function(){return h}),i.d(e,"e",function(){return c}),i.d(e,"f",function(){return l}),i.d(e,"g",function(){return u}),i.d(e,"h",function(){return d}),i.d(e,"i",function(){return f}),i.d(e,"j",function(){return _}),i.d(e,"k",function(){return g}),i.d(e,"l",function(){return v}),i.d(e,"m",function(){return y}),i.d(e,"n",function(){return m}),i.d(e,"o",function(){return b}),i.d(e,"p",function(){return x}),i.d(e,"q",function(){return E}),i.d(e,"r",function(){return O}),i.d(e,"s",function(){return w}),i.d(e,"t",function(){return R}),i.d(e,"u",function(){return I}),i.d(e,"v",function(){return S}),i.d(e,"w",function(){return P}),i.d(e,"x",function(){return M}),i.d(e,"y",function(){return j}),i.d(e,"z",function(){return L}),i.d(e,"A",function(){return A}),i.d(e,"B",function(){return F}),i.d(e,"C",function(){return D}),i.d(e,"D",function(){return k}),i.d(e,"E",function(){return N}),i.d(e,"G",function(){return G}),i.d(e,"H",function(){return z}),i.d(e,"I",function(){return U}),i.d(e,"F",function(){return B}),i.d(e,"a",function(){return Y})},function(t,e,i){"use strict";i.d(e,"a",function(){return h}),i.d(e,"b",function(){return c}),i.d(e,"c",function(){return l}),i.d(e,"e",function(){return u}),i.d(e,"d",function(){return d});var n=i(10);function r(t,e,i,n){for(var r,o=0,s=t.length;o<s;++o)if((r=t[o]).listener===e&&r.bindTo===i)return n&&(r.deleteIndex=o),r}function o(t,e){var i=t.ol_lm;return i?i[e]:void 0}function s(t){var e=t.ol_lm;return e||(e=t.ol_lm={}),e}function a(t,e){var i=o(t,e);if(i){for(var r=0,s=i.length;r<s;++r)t.removeEventListener(e,i[r].boundListener),Object(n.b)(i[r]);i.length=0;var a=t.ol_lm;a&&(delete a[e],0===Object.keys(a).length&&delete t.ol_lm)}}function h(t,e,i,n,o){var a=s(t),h=a[e];h||(h=a[e]=[]);var c=r(h,i,n,!1);return c?o||(c.callOnce=!1):(c={bindTo:n,callOnce:!!o,listener:i,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var i=t.listener,n=t.bindTo||t.target;return t.callOnce&&u(t),i.call(n,e)};return t.boundListener=e,e}(c)),h.push(c)),c}function c(t,e,i,n){return h(t,e,i,n,!0)}function l(t,e,i,n){var s=o(t,e);if(s){var a=r(s,i,n,!0);a&&u(a)}}function u(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=o(t.target,t.type);if(e){var i="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&a(t.target,t.type)}Object(n.b)(t)}}function d(t){var e=s(t);for(var i in e)a(t,i)}},function(t,e,i){"use strict";i.d(e,"b",function(){return r}),i.d(e,"a",function(){return o});var n=0;function r(t){return t.ol_uid||(t.ol_uid=++n)}var o="5.1.3"},function(t,e,i){"use strict";e.a={CHANGE:"change",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"}},function(t,e,i){"use strict";i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"e",function(){return s}),i.d(e,"h",function(){return a}),i.d(e,"g",function(){return h}),i.d(e,"f",function(){return c}),i.d(e,"i",function(){return l}),i.d(e,"j",function(){return u}),i.d(e,"d",function(){return d}),i.d(e,"c",function(){return p});var n=i(11);function r(t,e,i){return Math.min(Math.max(t,e),i)}var o="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function s(t){return Object(n.a)(0<t,29),Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function a(t,e,i,n,r,o){var s=r-i,a=o-n;if(0!==s||0!==a){var c=((t-i)*s+(e-n)*a)/(s*s+a*a);c>1?(i=r,n=o):c>0&&(i+=s*c,n+=a*c)}return h(t,e,i,n)}function h(t,e,i,n){var r=i-t,o=n-e;return r*r+o*o}function c(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,r=Math.abs(t[i][i]),o=i+1;o<e;o++){var s=Math.abs(t[o][i]);s>r&&(r=s,n=o)}if(0===r)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var h=i+1;h<e;h++)for(var c=-t[h][i]/t[i][i],l=i;l<e+1;l++)i==l?t[h][l]=0:t[h][l]+=c*t[i][l]}for(var u=new Array(e),d=e-1;d>=0;d--){u[d]=t[d][e]/t[d][d];for(var p=d-1;p>=0;p--)t[p][e]-=t[p][d]*u[d]}return u}function l(t){return 180*t/Math.PI}function u(t){return t*Math.PI/180}function d(t,e){var i=t%e;return i*e<0?i+e:i}function p(t,e,i){return t+i*(e-t)}},function(t,e,i){"use strict";i.d(e,"c",function(){return o}),i.d(e,"f",function(){return s}),i.d(e,"e",function(){return a}),i.d(e,"i",function(){return c}),i.d(e,"a",function(){return l}),i.d(e,"g",function(){return u}),i.d(e,"h",function(){return d}),i.d(e,"j",function(){return p}),i.d(e,"b",function(){return f}),i.d(e,"d",function(){return _});var n=i(11),r=new Array(6);function o(){return[1,0,0,1,0,0]}function s(t){return h(t,1,0,0,1,0,0)}function a(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],h=e[0],c=e[1],l=e[2],u=e[3],d=e[4],p=e[5];return t[0]=i*h+r*c,t[1]=n*h+o*c,t[2]=i*l+r*u,t[3]=n*l+o*u,t[4]=i*d+r*p+s,t[5]=n*d+o*p+a,t}function h(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function c(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function l(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function u(t,e){var i=Math.cos(e),n=Math.sin(e);return a(t,h(r,i,n,-n,i,0,0))}function d(t,e,i){return a(t,h(r,e,0,0,i,0,0))}function p(t,e,i){return a(t,h(r,1,0,0,1,e,i))}function f(t,e,i,n,r,o,s,a){var h=Math.sin(o),c=Math.cos(o);return t[0]=n*c,t[1]=r*h,t[2]=-n*h,t[3]=r*c,t[4]=s*n*c-a*n*h+e,t[5]=s*r*h+a*r*c+i,t}function _(t){var e=function(t){return t[0]*t[3]-t[1]*t[2]}(t);Object(n.a)(0!==e,32);var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],h=t[5];return t[0]=s/e,t[1]=-r/e,t[2]=-o/e,t[3]=i/e,t[4]=(o*h-s*a)/e,t[5]=-(i*h-r*a)/e,t}},function(t,e,i){"use strict";e.a={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"}},function(t,e,i){"use strict";e.a={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5}},function(t,e,i){"use strict";function n(){return!0}function r(){return!1}function o(){}i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r}),i.d(e,"c",function(){return o})},function(t,e,i){"use strict";i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o}),i.d(e,"d",function(){return s});var n="function"==typeof Object.assign?Object.assign:function(t,e){var i=arguments;if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,o=arguments.length;r<o;++r){var s=i[r];if(void 0!==s&&null!==s)for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])}return n};function r(t){for(var e in t)delete t[e]}function o(t){var e=[];for(var i in t)e.push(t[i]);return e}function s(t){var e;for(e in t)return!1;return!e}},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(68);function r(t,e){if(!t)throw new n.a(e)}},function(t,e,i){"use strict";i.d(e,"b",function(){return u});var n=i(3),r=i(36),o=i(66),s=i(17),a=i(10),h=function(t){function e(e,i,n){t.call(this,e),this.key=i,this.oldValue=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(s.a),c=function(t){function e(e){t.call(this),Object(n.b)(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return Object(a.a)({},this.values_)},e.prototype.notify=function(t,e){var i;i=u(t),this.dispatchEvent(new h(i,t,e)),i=r.a.PROPERTYCHANGE,this.dispatchEvent(new h(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(o.a),l={};function u(t){return l.hasOwnProperty(t)?l[t]:l[t]="change:"+t}e.a=c},function(t,e,i){"use strict";function n(t,e){return t>e?1:t<e?-1:0}function r(t,e){return t.indexOf(e)>=0}function o(t,e,i){var n,r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;if(i>0){for(n=1;n<r;++n)if(t[n]<e)return n-1}else if(i<0){for(n=1;n<r;++n)if(t[n]<=e)return n}else for(n=1;n<r;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return r-1}function s(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]}function a(t,e){var i=t.indexOf(e),n=i>-1;return n&&t.splice(i,1),n}function h(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function c(t,e){var i,n=t.length,r=Array(t.length);for(i=0;i<n;i++)r[i]={index:i,value:t[i]};for(r.sort(function(t,i){return e(t.value,i.value)||t.index-i.index}),i=0;i<t.length;i++)t[i]=r[i].value}function l(t,e,i){var r=e||n;return t.every(function(e,n){if(0===n)return!0;var o=r(t[n-1],e);return!(o>0||i&&0===o)})}i.d(e,"f",function(){return n}),i.d(e,"c",function(){return r}),i.d(e,"e",function(){return o}),i.d(e,"b",function(){return s}),i.d(e,"g",function(){return a}),i.d(e,"a",function(){return h}),i.d(e,"h",function(){return c}),i.d(e,"d",function(){return l})},function(t,e,i){"use strict";e.a={ANIMATING:0,INTERACTING:1}},function(t,e,i){"use strict";function n(t,e){var i=document.createElement("CANVAS");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function r(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}function o(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}function s(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function a(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function h(t){for(;t.lastChild;)t.removeChild(t.lastChild)}i.d(e,"a",function(){return n}),i.d(e,"c",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"f",function(){return s}),i.d(e,"e",function(){return a}),i.d(e,"d",function(){return h})},function(t,e,i){"use strict";i.r(e);var n=i(60),r=i(1),o=i(5),s=i(18),a=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};a.prototype.canWrapX=function(){return this.canWrapX_},a.prototype.getCode=function(){return this.code_},a.prototype.getExtent=function(){return this.extent_},a.prototype.getUnits=function(){return this.units_},a.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||s.a[this.units_]},a.prototype.getWorldExtent=function(){return this.worldExtent_},a.prototype.getAxisOrientation=function(){return this.axisOrientation_},a.prototype.isGlobal=function(){return this.global_},a.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},a.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},a.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},a.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},a.prototype.setWorldExtent=function(t){this.worldExtent_=t},a.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},a.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var h=a,c=6378137,l=Math.PI*c,u=[-l,-l,l,l],d=[-180,-85,180,85],p=function(t){function e(e){t.call(this,{code:e,units:s.b.METERS,extent:u,global:!0,worldExtent:d,getPointResolution:function(t,e){return t/Object(o.b)(e[1]/c)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(h),f=[new p("EPSG:3857"),new p("EPSG:102100"),new p("EPSG:102113"),new p("EPSG:900913"),new p("urn:ogc:def:crs:EPSG:6.18:3:3857"),new p("urn:ogc:def:crs:EPSG::3857"),new p("http://www.opengis.net/gml/srs/epsg.xml#3857")];function _(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=l,a=0;a<n;a+=r){o[a]=s*t[a]/180;var h=c*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));h>s?h=s:h<-s&&(h=-s),o[a+1]=h}return o}function g(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/l,o[s+1]=360*Math.atan(Math.exp(t[s+1]/c))/Math.PI-90;return o}var v=[-180,-90,180,90],y=6378137*Math.PI/180,m=function(t){function e(e,i){t.call(this,{code:e,units:s.b.DEGREES,extent:v,axisOrientation:i,global:!0,metersPerUnit:y,worldExtent:v})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(h),b=[new m("CRS:84"),new m("EPSG:4326","neu"),new m("urn:ogc:def:crs:EPSG::4326","neu"),new m("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new m("urn:ogc:def:crs:OGC:1.3:CRS84"),new m("urn:ogc:def:crs:OGC:2:84"),new m("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new m("urn:x-ogc:def:crs:EPSG:4326","neu")],x={};i(10);var E={};function C(t,e,i){var n=t.getCode(),r=e.getCode();n in E||(E[n]={}),E[n][r]=i}function O(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function T(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function w(t){!function(t,e){x[t]=e}(t.getCode(),t),C(t,t,O)}function R(t){t.forEach(w)}function I(t){var e=null;if(t instanceof h)e=t;else if("string"==typeof t){e=function(t){return x[t]||null}(t)}return e}function S(t,e,i,r){var o,a=(t=I(t)).getPointResolutionFunc();if(a)o=a(e,i);else if(t.getUnits()==s.b.DEGREES&&!r||r==s.b.DEGREES)o=e;else{var h=G(t,I("EPSG:4326")),c=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];c=h(c,c,2),o=(Object(n.a)(c.slice(0,2),c.slice(2,4))+Object(n.a)(c.slice(4,6),c.slice(6,8)))/2;var l=r?s.a[r]:t.getMetersPerUnit();void 0!==l&&(o/=l)}return o}function P(t){R(t),t.forEach(function(e){t.forEach(function(t){e!==t&&C(e,t,O)})})}function M(t,e,i,n){t.forEach(function(t){e.forEach(function(e){C(t,e,i),C(e,t,n)})})}function j(){x={},E={}}function L(t,e){return t?"string"==typeof t?I(t):t:I(e)}function A(t){return function(e,i,n){for(var r=e.length,o=void 0!==n?n:2,s=void 0!==i?i:new Array(r),a=0;a<r;a+=o){var h=t([e[a],e[a+1]]);s[a]=h[0],s[a+1]=h[1];for(var c=o-1;c>=2;--c)s[a+c]=e[a+c]}return s}}function F(t,e,i,n){var r=I(t),o=I(e);C(r,o,A(i)),C(o,r,A(n))}function D(t,e){return U(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function k(t,e){var i=U(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),n=i[0];return(n<-180||n>180)&&(i[0]=Object(o.d)(n+180,360)-180),i}function N(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?i:G(t,e)===O&&i}function G(t,e){var i=function(t,e){var i;return t in E&&e in E[t]&&(i=E[t][e]),i}(t.getCode(),e.getCode());return i||(i=T),i}function z(t,e){return G(I(t),I(e))}function U(t,e,i){return z(e,i)(t,void 0,t.length)}function B(t,e,i){var n=z(e,i);return Object(r.a)(t,n)}function Y(t,e,i){return G(e,i)(t)}function W(){P(f),P(b),M(b,f,_,g)}i.d(e,"cloneTransform",function(){return O}),i.d(e,"identityTransform",function(){return T}),i.d(e,"addProjection",function(){return w}),i.d(e,"addProjections",function(){return R}),i.d(e,"get",function(){return I}),i.d(e,"getPointResolution",function(){return S}),i.d(e,"addEquivalentProjections",function(){return P}),i.d(e,"addEquivalentTransforms",function(){return M}),i.d(e,"clearAllProjections",function(){return j}),i.d(e,"createProjection",function(){return L}),i.d(e,"createTransformFromCoordinateTransform",function(){return A}),i.d(e,"addCoordinateTransforms",function(){return F}),i.d(e,"fromLonLat",function(){return D}),i.d(e,"toLonLat",function(){return k}),i.d(e,"equivalent",function(){return N}),i.d(e,"getTransformFromProjections",function(){return G}),i.d(e,"getTransform",function(){return z}),i.d(e,"transform",function(){return U}),i.d(e,"transformExtent",function(){return B}),i.d(e,"transformWithProjections",function(){return Y}),i.d(e,"addCommon",function(){return W}),i.d(e,"METERS_PER_UNIT",function(){return s.a}),W()},function(t,e,i){"use strict";i.d(e,"b",function(){return r});var n=function(t){this.propagationStopped,this.type=t,this.target=null};function r(t){t.stopPropagation()}n.prototype.preventDefault=function(){this.propagationStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},e.a=n},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},r={};r[n.DEGREES]=2*Math.PI*6370997/360,r[n.FEET]=.3048,r[n.METERS]=1,r[n.USFEET]=1200/3937,e.b=n},function(t,e,i){"use strict";i.d(e,"c",function(){return r}),i.d(e,"g",function(){return o}),i.d(e,"i",function(){return s}),i.d(e,"d",function(){return a}),i.d(e,"b",function(){return h}),i.d(e,"a",function(){return c}),i.d(e,"h",function(){return l}),i.d(e,"f",function(){return u}),i.d(e,"e",function(){return d});var n="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",r=-1!==n.indexOf("firefox"),o=-1!==n.indexOf("safari")&&-1==n.indexOf("chrom"),s=-1!==n.indexOf("webkit")&&-1==n.indexOf("edge"),a=-1!==n.indexOf("macintosh"),h=window.devicePixelRatio||1,c=function(){var t=!1;try{t=!!document.createElement("CANVAS").getContext("2d").setLineDash}catch(t){}return t}(),l=(navigator,"ontouchstart"in window),u="PointerEvent"in window,d=!!navigator.msPointerEnabled},function(t,e,i){"use strict";e.a={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"}},function(t,e,i){"use strict";i.d(e,"c",function(){return n}),i.d(e,"d",function(){return r}),i.d(e,"e",function(){return o}),i.d(e,"b",function(){return s}),i.d(e,"a",function(){return a}),i.d(e,"f",function(){return h});var n="ol-hidden",r="ol-selectable",o="ol-unselectable",s="ol-control",a="ol-collapsed",h=function(){var t,e={};return function(i){if(t||(t=document.createElement("div").style),!(i in e)){t.font=i;var n=t.fontFamily;if(t.font="",!n)return null;e[i]=n.split(/,\s?/)}return e[i]}}()},function(t,e,i){"use strict";var n=i(68),r=i(24),o=i(12),s="length",a=function(t){function e(e,i){t.call(this,e),this.element=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(i(17).a),h=function(t){function e(e,i){t.call(this);var n=i||{};if(this.unique_=!!n.unique,this.array_=e||[],this.unique_)for(var r=0,o=this.array_.length;r<o;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(s)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new a(r.a.ADD,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new a(r.a.REMOVE,e)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new a(r.a.REMOVE,n)),this.dispatchEvent(new a(r.a.ADD,e))}else{for(var o=i;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(s,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===t&&i!==e)throw new n.a(58)},e}(o.a);e.a=h},function(t,e,i){"use strict";function n(t){return Math.pow(t,3)}function r(t){return 1-n(1-t)}function o(t){return 3*t*t-2*t*t*t}function s(t){return t}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o}),i.d(e,"d",function(){return s})},function(t,e,i){"use strict";e.a={ADD:"add",REMOVE:"remove"}},function(t,e,i){"use strict";function n(t,e,i,n,r,o){for(var s=o||[],a=0,h=e;h<i;h+=n){var c=t[h],l=t[h+1];s[a++]=r[0]*c+r[2]*l+r[4],s[a++]=r[1]*c+r[3]*l+r[5]}return o&&s.length!=a&&(s.length=a),s}function r(t,e,i,n,r,o,s){for(var a=s||[],h=Math.cos(r),c=Math.sin(r),l=o[0],u=o[1],d=0,p=e;p<i;p+=n){var f=t[p]-l,_=t[p+1]-u;a[d++]=l+f*h-_*c,a[d++]=u+f*c+_*h;for(var g=p+2;g<p+n;++g)a[d++]=t[g]}return s&&a.length!=d&&(a.length=d),a}function o(t,e,i,n,r,o,s,a){for(var h=a||[],c=s[0],l=s[1],u=0,d=e;d<i;d+=n){var p=t[d]-c,f=t[d+1]-l;h[u++]=c+r*p,h[u++]=l+o*f;for(var _=d+2;_<d+n;++_)h[u++]=t[_]}return a&&h.length!=u&&(h.length=u),h}function s(t,e,i,n,r,o,s){for(var a=s||[],h=0,c=e;c<i;c+=n){a[h++]=t[c]+r,a[h++]=t[c+1]+o;for(var l=c+2;l<c+n;++l)a[h++]=t[l]}return s&&a.length!=h&&(a.length=h),a}i.d(e,"c",function(){return n}),i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"d",function(){return s})},function(t,e,i){"use strict";e.a={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"}},function(t,e,i){"use strict";function n(t){return t[0]>0&&t[1]>0}function r(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function o(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o})},function(t,e,i){"use strict";e.a={IDLE:0,LOADING:1,LOADED:2,ERROR:3}},function(t,e,i){"use strict";i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r});var n=.5,r=!0},function(t,e,i){"use strict";i.d(e,"b",function(){return a}),i.d(e,"a",function(){return c}),i.d(e,"c",function(){return u});var n=i(11),r=i(5),o=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,s=/^([a-z]*)$/i;function a(t){return"string"==typeof t?t:u(t)}var h=function(){var t={},e=0;return function(i){var r;if(t.hasOwnProperty(i))r=t[i];else{if(e>=1024){var a=0;for(var h in t)0==(3&a++)&&(delete t[h],--e)}r=function(t){var e,i,r,a,h;s.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}(t));if(o.exec(t)){var c,u=t.length-1;c=u<=4?1:2;var d=4===u||8===u;e=parseInt(t.substr(1+0*c,c),16),i=parseInt(t.substr(1+1*c,c),16),r=parseInt(t.substr(1+2*c,c),16),a=d?parseInt(t.substr(1+3*c,c),16):255,1==c&&(e=(e<<4)+e,i=(i<<4)+i,r=(r<<4)+r,d&&(a=(a<<4)+a)),h=[e,i,r,a/255]}else 0==t.indexOf("rgba(")?l(h=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((h=t.slice(4,-1).split(",").map(Number)).push(1),l(h)):Object(n.a)(!1,14);return h}(i),t[i]=r,++e}return r}}();function c(t){return Array.isArray(t)?t:h(t)}function l(t){return t[0]=Object(r.a)(t[0]+.5|0,0,255),t[1]=Object(r.a)(t[1]+.5|0,0,255),t[2]=Object(r.a)(t[2]+.5|0,0,255),t[3]=Object(r.a)(t[3],0,1),t}function u(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}},function(t,e,i){"use strict";i.d(e,"b",function(){return p});var n=i(2),r=i(4),o=i(3),s=i(12),a=i(69),h=i(20),c=i(10),l=i(46),u=i(32),d=function(t){function e(e){var i=Object(c.a)({},e);delete i.source,t.call(this,i),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),Object(n.a)(this,Object(s.b)(h.a.SOURCE),this.handleSourcePropertyChange_,this);var r=e.source?e.source:null;this.setSource(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(h.a.SOURCE)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():u.a.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Object(n.e)(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Object(n.a)(t,r.a.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Object(n.e)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Object(n.e)(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Object(n.a)(t,l.a.PRECOMPOSE,function(t){var e=this.getLayerState();e.managed=!1,e.zIndex=1/0,t.frameState.layerStatesArray.push(e),t.frameState.layerStates[Object(o.b)(this)]=e},this),this.mapRenderKey_=Object(n.a)(this,r.a.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(h.a.SOURCE,t)},e}(a.a);function p(t,e){return t.visible&&e>=t.minResolution&&e<t.maxResolution}e.a=d},function(t,e,i){"use strict";e.a={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"}},function(t,e,i){"use strict";i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return s});var n=i(1);function r(t,e,i,r,s){return!Object(n.s)(s,function(n){return!o(t,e,i,r,n[0],n[1])})}function o(t,e,i,n,r,o){for(var s=0,a=t[i-n],h=t[i-n+1];e<i;e+=n){var c=t[e],l=t[e+1];h<=o?l>o&&(c-a)*(o-h)-(r-a)*(l-h)>0&&s++:l<=o&&(c-a)*(o-h)-(r-a)*(l-h)<0&&s--,a=c,h=l}return 0!==s}function s(t,e,i,n,r,s){if(0===i.length)return!1;if(!o(t,e,i[0],n,r,s))return!1;for(var a=1,h=i.length;a<h;++a)if(o(t,i[a-1],i[a],n,r,s))return!1;return!0}},function(t,e,i){"use strict";var n=i(42),r=i(2),o=i(9),s=i(17),a=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new s.a(t):t,i=e.type;e.target=this;var n,r=this.listeners_[i];if(r){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var a=0,h=r.length;a<h;++a)if(!1===r[a].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var c=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];c--;)this.removeEventListener(i,o.c);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){Object(r.d)(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);t in this.pendingRemovals_?(i[n]=o.c,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t])}},e}(n.a);e.a=a},function(t,e,i){"use strict";e.a={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"}},function(t,e,i){"use strict";e.a={PROPERTYCHANGE:"propertychange"}},function(t,e,i){"use strict";i.d(e,"c",function(){return r}),i.d(e,"d",function(){return o}),i.d(e,"a",function(){return s}),i.d(e,"b",function(){return a});var n=i(5);function r(t,e){return void 0!==t?0:void 0}function o(t,e){return void 0!==t?t+e:void 0}function s(t){var e=2*Math.PI/t;return function(t,i){return void 0!==t?t=Math.floor((t+i)/e+.5)*e:void 0}}function a(t){var e=t||Object(n.j)(5);return function(t,i){return void 0!==t?Math.abs(t+i)<=e?0:t+i:void 0}}},function(t,e,i){"use strict";i(5);function n(t,e){return t[0]+=e[0],t[1]+=e[1],t}function r(t,e){for(var i=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function o(t,e){var i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,o=t[1]*i+t[0]*n;return t[0]=r,t[1]=o,t}function s(t,e){return t[0]*=e,t[1]*=e,t}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o}),i.d(e,"d",function(){return s})},function(t,e,i){"use strict";function n(t,e,i,n){for(;e<i-n;){for(var r=0;r<n;++r){var o=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=o}e+=n,i-=n}}function r(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],h=t[e+1];r+=(a-o)*(h+s),o=a,s=h}return r>0}function o(t,e,i,n,o){for(var s=void 0!==o&&o,a=0,h=i.length;a<h;++a){var c=i[a],l=r(t,e,c,n);if(0===a){if(s&&l||!s&&!l)return!1}else if(s&&!l||!s&&l)return!1;e=c}return!0}function s(t,e,i,o,s){for(var a=void 0!==s&&s,h=0,c=i.length;h<c;++h){var l=i[h],u=r(t,e,l,o);(0===h?a&&u||!a&&!u:a&&!u||!a&&u)&&n(t,e,l,o),e=l}return e}i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return s})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(41),r=i(78),o=i(56),s=i(64);function a(t){return t instanceof s.default}function h(t){return t instanceof r.default}class c{constructor(){this.defaultCenterRatio=.5,this.centerChangeDone=o.debounce(()=>{document.dispatchEvent(new CustomEvent(n.CENTER_CHANGE_DONE))},300)}get center(){return this._center}set center(t){this._center===this.from&&t<this.from||this._center===this.to&&t>this.to||(t<this.from?this._center=this.from:t>this.to?this._center=this.to:this._center=t,this.centerChangeDone())}set dimensions(t){const e=getComputedStyle(t);this.viewportHeight=parseInt(e.getPropertyValue("height"),10),this.viewportOffset=t.getBoundingClientRect().top,this.viewportWidth=parseInt(e.getPropertyValue("width"),10)}init(t){null==t.rootElement&&console.error("[init] No rootElement found"),this.rootElement=t.rootElement,this.dimensions=this.rootElement;const[e,i]=t.bands.reduce((t,e)=>{if(e instanceof r.default)return t;const i=null==e.config.orderedEvents?e.config.events:e.config.orderedEvents.events;return t[0].push(i[0].date_min||i[0].date),t[1].push(i.reduce((t,e)=>Math.max(t,e.end_date||-1/0,e.end_date_max||-1/0),-1/0)),t},[[],[]]);this.from=Math.min(...e),this.to=Math.max(...i),this.time=this.to-this.from,this.center=null!=t.center?t.center:this.from+this.defaultCenterRatio*this.time,this.bands=t.bands,this.eventsBands=this.bands.filter(a),this.minimapBands=this.bands.filter(h),this.controlBand=t.controlBand;for(const t of this.bands)t.init()}resize(){this.dimensions=this.rootElement}}e.Props=c,e.default=new c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EVENT_HEIGHT=14,e.EVENT_ROW_HEIGHT=16,e.DATE_BAR_HEIGHT=e.EVENT_ROW_HEIGHT,e.RULER_LABELS_HEIGHT=60,e.CENTER_CHANGE_DONE="CENTER_CHANGE_DONE",e.ZOOM_DONE="ZOOM_DONE",e.SCROLL_DONE="SCROLL_DONE",e.PIXELS_PER_LETTER=8;e.RawSegment=class{},e.colors=["rgba(211,84,0","rgba(219,10,91","rgba(31,58,147","rgba(0,128,0"].map(t=>(e=1)=>`${t},${e})`)},function(t,e,i){"use strict";var n=i(9),r=function(){};r.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},r.prototype.disposed_=!1,r.prototype.disposeInternal=n.c,e.a=r},function(t,e,i){"use strict";var n=i(9),r=i(1),o=i(67),s=i(26),a=i(25),h=i(10),c=function(t){function e(){t.call(this),this.layout=s.a.XY,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return Object(r.n)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(Object(h.b)(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=l(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){},e.prototype.setLayout=function(t,e,i){var n;if(t)n=l(t);else{for(var r=0;r<i;++r){if(0===e.length)return this.layout=s.a.XY,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=s.a.XY:3==t?e=s.a.XYZ:4==t&&(e=s.a.XYZM);return e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();Object(a.a)(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var o=i;o||(o=Object(r.w)(this.getExtent()));var s=this.getFlatCoordinates();if(s){var h=this.getStride();Object(a.b)(s,0,s.length,h,t,n,o,s),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();Object(a.d)(i,0,i.length,n,t,e,i),this.changed()}},e}(o.a);function l(t){var e;return t==s.a.XY?e=2:t==s.a.XYZ||t==s.a.XYM?e=3:t==s.a.XYZM&&(e=4),e}c.prototype.containsXY=n.a,e.a=c},function(t,e,i){"use strict";i.r(e);var n=i(3),r=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};r.prototype.clone=function(){var t=this.getColor();return new r({color:t&&t.slice?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},r.prototype.getColor=function(){return this.color_},r.prototype.getLineCap=function(){return this.lineCap_},r.prototype.getLineDash=function(){return this.lineDash_},r.prototype.getLineDashOffset=function(){return this.lineDashOffset_},r.prototype.getLineJoin=function(){return this.lineJoin_},r.prototype.getMiterLimit=function(){return this.miterLimit_},r.prototype.getWidth=function(){return this.width_},r.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},r.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},r.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},r.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},r.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},r.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},r.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},r.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=Object(n.b)(this.color_).toString():this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_},e.default=r},function(t,e,i){"use strict";e.a={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"}},function(t,e,i){"use strict";e.a={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"}},function(t,e,i){"use strict";i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r});var n=42,r=256},function(t,e,i){"use strict";e.a={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"}},function(t,e,i){"use strict";var n=i(3),r=i(84),o=i.n(r),s=i(1),a=i(10),h=function(t){this.rbush_=o()(t,void 0),this.items_={}};h.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Object(n.b)(e)]=i},h.prototype.load=function(t,e){for(var i=new Array(e.length),r=0,o=e.length;r<o;r++){var s=t[r],a=e[r],h={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:a};i[r]=h,this.items_[Object(n.b)(a)]=h}this.rbush_.load(i)},h.prototype.remove=function(t){var e=Object(n.b)(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},h.prototype.update=function(t,e){var i=this.items_[Object(n.b)(e)],r=[i.minX,i.minY,i.maxX,i.maxY];Object(s.o)(r,t)||(this.remove(e),this.insert(t,e))},h.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},h.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},h.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},h.prototype.forEachInExtent=function(t,e,i){return this.forEach_(this.getInExtent(t),e,i)},h.prototype.forEach_=function(t,e,i){for(var n,r=0,o=t.length;r<o;r++)if(n=e.call(i,t[r]))return n;return n},h.prototype.isEmpty=function(){return Object(a.d)(this.items_)},h.prototype.clear=function(){this.rbush_.clear(),this.items_={}},h.prototype.getExtent=function(t){var e=this.rbush_.data;return Object(s.j)(e.minX,e.minY,e.maxX,e.maxY,t)},h.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[0|e]=t.items_[0|e]},e.a=h},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=function(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n};function r(t,e,i,r,o){return void 0!==o?(o.minX=t,o.maxX=e,o.minY=i,o.maxY=r,o):new n(t,e,i,r)}n.prototype.contains=function(t){return this.containsXY(t[1],t[2])},n.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},n.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},n.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},n.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},n.prototype.getHeight=function(){return this.maxY-this.minY+1},n.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},n.prototype.getWidth=function(){return this.maxX-this.minX+1},n.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},e.b=n},function(t,e,i){"use strict";i.r(e),i.d(e,"toFunction",function(){return c}),i.d(e,"createDefaultStyle",function(){return u}),i.d(e,"createEditingStyle",function(){return d});var n=i(11),r=i(7),o=i(72),s=i(61),a=i(44),h=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=p,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};function c(t){var e,i;"function"==typeof t?e=t:(Array.isArray(t)?i=t:(Object(n.a)(t instanceof h,41),i=[t]),e=function(){return i});return e}h.prototype.clone=function(){var t=this.getGeometry();return t&&t.clone&&(t=t.clone()),new h({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},h.prototype.getRenderer=function(){return this.renderer_},h.prototype.setRenderer=function(t){this.renderer_=t},h.prototype.getGeometry=function(){return this.geometry_},h.prototype.getGeometryFunction=function(){return this.geometryFunction_},h.prototype.getFill=function(){return this.fill_},h.prototype.setFill=function(t){this.fill_=t},h.prototype.getImage=function(){return this.image_},h.prototype.setImage=function(t){this.image_=t},h.prototype.getStroke=function(){return this.stroke_},h.prototype.setStroke=function(t){this.stroke_=t},h.prototype.getText=function(){return this.text_},h.prototype.setText=function(t){this.text_=t},h.prototype.getZIndex=function(){return this.zIndex_},h.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=p,this.geometry_=t},h.prototype.setZIndex=function(t){this.zIndex_=t};var l=null;function u(t,e){if(!l){var i=new s.default({color:"rgba(255,255,255,0.4)"}),n=new a.default({color:"#3399CC",width:1.25});l=[new h({image:new o.default({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return l}function d(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[r.a.POLYGON]=[new h({fill:new s.default({color:[255,255,255,.5]})})],t[r.a.MULTI_POLYGON]=t[r.a.POLYGON],t[r.a.LINE_STRING]=[new h({stroke:new a.default({color:e,width:5})}),new h({stroke:new a.default({color:i,width:3})})],t[r.a.MULTI_LINE_STRING]=t[r.a.LINE_STRING],t[r.a.CIRCLE]=t[r.a.POLYGON].concat(t[r.a.LINE_STRING]),t[r.a.POINT]=[new h({image:new o.default({radius:6,fill:new s.default({color:i}),stroke:new a.default({color:e,width:1.5})}),zIndex:1/0})],t[r.a.MULTI_POINT]=t[r.a.POINT],t[r.a.GEOMETRY_COLLECTION]=t[r.a.POLYGON].concat(t[r.a.LINE_STRING],t[r.a.POINT]),t}function p(t){return t.getGeometry()}e.default=h},function(t,e,i){"use strict";var n=i(11),r=i(34),o=i(4),s=function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(o.a.CLEAR)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var i=this.oldest_;i;)t.call(e,i.value_,i.key_,this),i=i.newer},e.prototype.get=function(t){var e=this.entries_[t];return Object(n.a)(void 0!==e,15),e===this.newest_?e.value_:(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e,e.value_)},e.prototype.remove=function(t){var e=this.entries_[t];return Object(n.a)(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){Object(n.a)(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(r.a);e.a=s},function(t,e,i){"use strict";function n(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],h=t[e+1];r+=s*a-o*h,o=a,s=h}return r/2}function r(t,e,i,r){for(var o=0,s=0,a=i.length;s<a;++s){var h=i[s];o+=n(t,e,h,r),e=h}return o}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r})},function(t,e,i){"use strict";function n(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e}function r(t,e,i,n){for(var r=0,o=i.length;r<o;++r)for(var s=i[r],a=0;a<n;++a)t[e++]=s[a];return e}function o(t,e,i,n,o){for(var s=o||[],a=0,h=0,c=i.length;h<c;++h){var l=r(t,e,i[h],n);s[a++]=l,e=l}return s.length=a,s}i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return o})},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(30);function r(t){return function(t){return"string"==typeof t||t instanceof CanvasPattern||t instanceof CanvasGradient}(t)?t:Object(n.c)(t)}},function(t,e,i){"use strict";function n(t){return Math.pow(2,-1*t)}function r(t){if(null==t)return null;const e=new Date(t);return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`}Object.defineProperty(e,"__esModule",{value:!0}),e.debounce=((t,e)=>{let i;return()=>{clearTimeout(i),i=setTimeout(t,e)}}),e.visibleRatio=n,e.createRange=function(t){return Array.apply(null,{length:t}).map(Number.call,Number)},e.selectRandom=function(t,e){const i=[];for(;i.length<e;){const n=t[Math.floor(Math.random()*t.length)];(-1===i.indexOf(n)||t.length<e)&&i.push(n)}return i},e.calcPixelsPerMillisecond=function(t,e,i){return t/n(e)/i},e.logEvent=function(t,...e){console.log(t.label,t,t.left,r(t.from),r(t.to),e)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(40),r=i(41);var o;!function(t){t[t.Backward=-1]="Backward",t[t.Stop=0]="Stop",t[t.Forward=1]="Forward"}(o||(o={}));class s{constructor(){this.elapsedTimeThreshold=2e3,this.goToDuration=300,this.zoomToDuration=300,this.multipliers=[.25,.5,1,2,4,8,16],this.multiplier=1,this.direction=o.Stop,this.elapsedTimeTotal=0,this.models=[],this.views=[],this.animate=(t=>{const e=null==this.prevTimestamp?0:t-this.prevTimestamp;if(e>0||null==this.prevTimestamp){if(null==this.centerMarker&&null==this.zoomMarker)n.default.center+=n.default.eventsBands[0].time/7.5*this.multiplier*this.direction;else if(null!=this.centerMarker){const t=this.goToDuration-this.elapsedTimeTotal,i=Math.abs(this.centerMarker-n.default.center)/(t/e);t<e?(n.default.center=this.centerMarker,this.stop()):n.default.center=n.default.center+i*this.direction}else if(null!=this.zoomMarker){const t=this.zoomToDuration-this.elapsedTimeTotal,i=(this.zoomMarker-this.activeBand.zoomLevel)/(t/e);if(t<e)this.activeBand.zoomLevel=this.zoomMarker,n.default.eventsBands.forEach(t=>{t===this.activeBand?this.activeBand.zoomLevel=this.zoomMarker:t.zoomLevel=this.zoomMarker+(t.config.zoomLevel-this.activeBand.config.zoomLevel)}),this.adjustMinimapBands(),document.dispatchEvent(new CustomEvent(r.ZOOM_DONE)),this.stop();else{for(const t of n.default.eventsBands)t.zoomLevel=t.zoomLevel+i;this.adjustMinimapBands()}}this.models.forEach(t=>t.update()),this.views.forEach(t=>t.update())}this.elapsedTimeTotal+=e,this.elapsedTimeTotal>this.elapsedTimeThreshold&&this.resetElapsedTimeTotal(),(this.isPlaying()||null!=this.zoomMarker)&&(n.default.center>=n.default.from&&n.default.center<=n.default.to||null!=this.centerMarker||null!=this.zoomMarker?(this.prevTimestamp=t,requestAnimationFrame(this.animate)):this.stop())})}registerModel(t){this.models.push(t)}registerView(t){this.views.push(t)}adjustMinimapBands(){n.default.minimapBands.forEach(t=>{this.activeBand.zoomLevel<t.config.zoomLevel&&(t.zoomLevel=this.activeBand.zoomLevel)})}resetElapsedTimeTotal(){this.elapsedTimeTotal=0,document.dispatchEvent(new CustomEvent(r.CENTER_CHANGE_DONE))}accelerate(){const t=this.multipliers.indexOf(this.multiplier);return t===this.multipliers.length-1?this.multipliers[this.multipliers.length-1]:(this.multiplier=this.multipliers[t+1],this.multiplier)}decelerate(){const t=this.multipliers.indexOf(this.multiplier);return 0===t?this.multipliers[0]:(this.multiplier=this.multipliers[t-1],this.multiplier)}goTo(t){this.centerMarker=t,t>n.default.center?this.playForward():this.playBackward()}zoomTo(t,e){null==this.zoomMarker&&(e<0&&(e=0),t!==this.activeBand&&(this.stop(),this.activeBand=t),this.activeBand.zoomLevel!==e&&(this.zoomMarker=e,this.nextFrame()))}speed(t){const e=parseFloat(t);-1!==this.multipliers.indexOf(e)&&(this.multiplier=e)}isPlaying(){return this.direction!==o.Stop}isPlayingForward(){return this.direction===o.Forward}isPlayingBackward(){return this.direction===o.Backward}nextFrame(){requestAnimationFrame(this.animate)}playForward(){this.direction=o.Forward,this.nextFrame()}playBackward(){this.direction=o.Backward,this.nextFrame()}stop(){this.direction=o.Stop,this.activeBand=null,this.centerMarker=null,this.zoomMarker=null,this.prevTimestamp=null,this.elapsedTimeTotal=0}toggle(){this.isPlaying()?this.stop():this.nextFrame()}}e.Animator=s,e.default=new s},function(t,e,i){"use strict";let n;if(Object.defineProperty(e,"__esModule",{value:!0}),e.createSvg=((t,e,i={})=>{const n=document.createElementNS("http://www.w3.org/2000/svg",t);return null!=e&&n.setAttribute("style",e.join(";").concat(";")),Object.keys(i).forEach(t=>n.setAttribute(t,i[t])),n}),"undefined"!=typeof window){const t=document.createElement("style");document.head.appendChild(t),n=t.sheet}const r={};e.default=function(t,e,i,o){if(!e)return document.createElement(t);let s;return r.hasOwnProperty(e)?s=r[e].cloneNode(!1):((s=document.createElement(t)).classList.add(e),i&&n.insertRule(`.${e} { ${i.join(";").concat(";")} }`),r[e]=s.cloneNode(!1)),o&&s.setAttribute("style",o.join(";").concat(";")),s}},function(t,e,i){"use strict";i.r(e),function(t){i.d(e,"flush",function(){return s}),i.d(e,"hydrate",function(){return a}),i.d(e,"cx",function(){return h}),i.d(e,"merge",function(){return c}),i.d(e,"getRegisteredStyles",function(){return l}),i.d(e,"injectGlobal",function(){return u}),i.d(e,"keyframes",function(){return d}),i.d(e,"css",function(){return p}),i.d(e,"sheet",function(){return f}),i.d(e,"caches",function(){return _});var n=i(87),r=void 0!==t?t:{},o=Object(n.a)(r),s=o.flush,a=o.hydrate,h=o.cx,c=o.merge,l=o.getRegisteredStyles,u=o.injectGlobal,d=o.keyframes,p=o.css,f=o.sheet,_=o.caches}.call(this,i(114))},function(t,e,i){"use strict";i.d(e,"a",function(){return o}),i.d(e,"b",function(){return s});var n=i(5),r=(i(7),6371008.8);function o(t,e,i){var o=i||r,s=Object(n.j)(t[1]),a=Object(n.j)(e[1]),h=(a-s)/2,c=Object(n.j)(e[0]-t[0])/2,l=Math.sin(h)*Math.sin(h)+Math.sin(c)*Math.sin(c)*Math.cos(s)*Math.cos(a);return 2*o*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}function s(t,e,i,o){var s=o||r,a=Object(n.j)(t[1]),h=Object(n.j)(t[0]),c=e/s,l=Math.asin(Math.sin(a)*Math.cos(c)+Math.cos(a)*Math.sin(c)*Math.cos(i)),u=h+Math.atan2(Math.sin(i)*Math.sin(c)*Math.cos(a),Math.cos(c)-Math.sin(a)*Math.sin(l));return[Object(n.i)(u),Object(n.i)(l)]}},function(t,e,i){"use strict";i.r(e);var n=i(3),r=i(30),o=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};o.prototype.clone=function(){var t=this.getColor();return new o({color:t&&t.slice?t.slice():t||void 0})},o.prototype.getColor=function(){return this.color_},o.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},o.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?this.checksum_=Object(n.b)(this.color_).toString():this.checksum_="f"+(this.color_?Object(r.b)(this.color_):"-")),this.checksum_},e.default=o},function(t,e,i){"use strict";var n=i(13),r=i(1),o=i(26),s=i(7),a=i(43),h=i(53),c=i(5);function l(t,e,i,n,r,o,s){var a,h=t[e],l=t[e+1],u=t[i]-h,d=t[i+1]-l;if(0===u&&0===d)a=e;else{var p=((r-h)*u+(o-l)*d)/(u*u+d*d);if(p>1)a=i;else{if(p>0){for(var f=0;f<n;++f)s[f]=Object(c.c)(t[e+f],t[i+f],p);return void(s.length=n)}a=e}}for(var _=0;_<n;++_)s[_]=t[a+_];s.length=n}function u(t,e,i,n,r){var o=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],h=t[e+1],l=Object(c.g)(o,s,a,h);l>r&&(r=l),o=a,s=h}return r}function d(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=u(t,e,a,n,r),e=a}return r}function p(t,e,i,n,r,o,s,a,h,u,d){if(e==i)return u;var p,f;if(0===r){if((f=Object(c.g)(s,a,t[e],t[e+1]))<u){for(p=0;p<n;++p)h[p]=t[e+p];return h.length=n,f}return u}for(var _=d||[NaN,NaN],g=e+n;g<i;)if(l(t,g-n,g,n,s,a,_),(f=Object(c.g)(s,a,_[0],_[1]))<u){for(u=f,p=0;p<n;++p)h[p]=_[p];h.length=n,g+=n}else g+=n*Math.max((Math.sqrt(f)-Math.sqrt(u))/r|0,1);if(o&&(l(t,i-n,e,n,s,a,_),(f=Object(c.g)(s,a,_[0],_[1]))<u)){for(u=f,p=0;p<n;++p)h[p]=_[p];h.length=n}return u}function f(t,e,i,n,r,o,s,a,h,c,l){for(var u=l||[NaN,NaN],d=0,f=i.length;d<f;++d){var _=i[d];c=p(t,e,_,n,r,o,s,a,h,c,u),e=_}return c}var _=i(54);function g(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=e;a<i;a+=n)o[s++]=t.slice(a,a+n);return o.length=s,o}function v(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,h=i.length;a<h;++a){var c=i[a];o[s++]=g(t,e,c,n,o[s]),e=c}return o.length=s,o}function y(t,e,i,n,r,o,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var h=new Array(a);h[0]=1,h[a-1]=1;for(var l=[e,i-n],u=0;l.length>0;){for(var d=l.pop(),p=l.pop(),f=0,_=t[p],g=t[p+1],v=t[d],y=t[d+1],m=p+n;m<d;m+=n){var b=t[m],x=t[m+1],E=Object(c.h)(b,x,_,g,v,y);E>f&&(u=m,f=E)}f>r&&(h[(u-e)/n]=1,p+n<u&&l.push(p,u),u+n<d&&l.push(u,d))}for(var C=0;C<a;++C)h[C]&&(o[s++]=t[e+C*n],o[s++]=t[e+C*n+1]);return s}function m(t,e){return e*Math.round(t/e)}function b(t,e,i,n,r,o,s){if(e==i)return s;var a,h,c=m(t[e],r),l=m(t[e+1],r);e+=n,o[s++]=c,o[s++]=l;do{if(a=m(t[e],r),h=m(t[e+1],r),(e+=n)==i)return o[s++]=a,o[s++]=h,s}while(a==c&&h==l);for(;e<i;){var u=m(t[e],r),d=m(t[e+1],r);if(e+=n,u!=a||d!=h){var p=a-c,f=h-l,_=u-c,g=d-l;p*g==f*_&&(p<0&&_<p||p==_||p>0&&_>p)&&(f<0&&g<f||f==g||f>0&&g>f)?(a=u,h=d):(o[s++]=a,o[s++]=h,c=a,l=h,a=u,h=d)}}return o[s++]=a,o[s++]=h,s}function x(t,e,i,n,r,o,s,a){for(var h=0,c=i.length;h<c;++h){var l=i[h];s=b(t,e,l,n,r,o,s),a.push(s),e=l}return s}var E=function(t){function e(e,i){t.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Object(r.e)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(u(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),p(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return Object(h.a)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return g(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=y(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,o.a.XY)},e.prototype.getType=function(){return s.a.LINEAR_RING},e.prototype.intersectsExtent=function(t){},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Object(_.b)(this.flatCoordinates,0,t,this.stride),this.changed()},e}(a.a),C=i(74),O=(i(60),i(33));function T(t,e,i,r,o,s,a){for(var h,c,l,u,d,p,f,_=o[s+1],g=[],v=0,y=i.length;v<y;++v){var m=i[v];for(u=t[m-r],p=t[m-r+1],h=e;h<m;h+=r)d=t[h],f=t[h+1],(_<=p&&f<=_||p<=_&&_<=f)&&(l=(_-p)/(f-p)*(d-u)+u,g.push(l)),u=d,p=f}var b=NaN,x=-1/0;for(g.sort(n.f),u=g[0],h=1,c=g.length;h<c;++h){d=g[h];var E=Math.abs(d-u);E>x&&(l=(u+d)/2,Object(O.c)(t,e,i,r,l,_)&&(b=l,x=E)),u=d}return isNaN(b)&&(b=o[s]),a?(a.push(b,_,x),a):[b,_,x]}function w(t,e,i,n,o){var s=Object(r.r)(Object(r.i)(),t,e,i,n);return!!Object(r.E)(o,s)&&(!!Object(r.g)(o,s)||(s[0]>=o[0]&&s[2]<=o[2]||(s[1]>=o[1]&&s[3]<=o[3]||function(t,e,i,n,r,o){for(var s,a=[t[e],t[e+1]],h=[];e+n<i;e+=n){if(h[0]=t[e+n],h[1]=t[e+n+1],s=r.call(o,a,h))return s;a[0]=h[0],a[1]=h[1]}return!1}(t,e,i,n,function(t,e){return Object(r.F)(o,t,e)}))))}function R(t,e,i,n,r){if(!function(t,e,i,n,r){return!!(w(t,e,i,n,r)||Object(O.b)(t,e,i,n,r[0],r[1])||Object(O.b)(t,e,i,n,r[0],r[3])||Object(O.b)(t,e,i,n,r[2],r[1])||Object(O.b)(t,e,i,n,r[2],r[3]))}(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(var o=1,s=i.length;o<s;++o)if(Object(O.a)(t,i[o-1],i[o],n,r))return!1;return!0}var I=i(39);i.d(e,"b",function(){return P});var S=function(t){function e(e,i,n){t.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==i&&n?(this.setFlatCoordinates(i,e),this.ends_=n):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLinearRing=function(t){this.flatCoordinates?Object(n.b)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Object(r.e)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(d(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),f(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return Object(O.c)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return Object(h.b)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Object(I.c)(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,v(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Object(r.w)(this.getExtent());this.flatInteriorPoint_=T(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new C.default(this.getFlatInteriorPoint(),o.a.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new E(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o],h=new E(e.slice(r,a),t);n.push(h),r=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Object(I.b)(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Object(I.c)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=x(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,o.a.XY,n)},e.prototype.getType=function(){return s.a.POLYGON},e.prototype.intersectsExtent=function(t){return R(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=Object(_.c)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(a.a);e.a=S;function P(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=[e,i,e,r,n,r,n,i,e,i];return new S(s,o.a.XY,[s.length])}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function o(t){return r[t.getUTCMonth()]}function s(t){const e=t.getUTCDate();return`${n[t.getUTCDay()]}, ${e}${function(t){return["st","nd","rd"][((t+90)%100-10)%10-1]||"th"}(e)}`}function a(t){return t.getUTCHours().toString().padStart(2,"0")}function h(t){return t.getUTCMinutes().toString().padStart(2,"0")}function c(t){return t.getUTCSeconds().toString().padStart(2,"0")}function l(t){return t.getUTCMilliseconds().toString().padStart(3,"0")}function u(t){return"YEAR"===t||"YEAR_5"===t||"DECADE"===t||"DECADE_5"===t||"CENTURY"===t||"CENTURY_5"===t||"MILLENIUM"===t}e.formatDate=((t,e)=>{if(null==t)return"∞";const i=new Date(t);let n=i.getUTCFullYear().toString();return u(e)?n:(n=`${o(i)} ${n}`,"MONHT"===e?n:(n=`${s(i)} ${n}`,"DAY"===e?n:(n=`${n} at ${a(i)}:`,"HOUR"===e?`${n}00`:(n=`${n}${h(i)}`,"MINUTE"===e?n:(n=`${n}:${c(i)}`,"SECOND"===e?n:`${n}.${l(i)}`)))))}),e.getGranularity=(t=>t>58?"MILLISECOND":t>12?"MILLISECOND_10":t>2.3?"MILLISECOND_50":t>1.5?"MILLISECOND_100":t>.4?"MILLISECOND_500":t>.00112?"SECOND":t>112e-6?"MINUTE":t>112e-7?"HOUR":t>8e-7?"DAY":t>2.6e-7?"WEEK":t>2.2e-8?"MONHT":t>2.2e-9?"YEAR":t>3.3e-10?"YEAR_5":t>1.6e-10?"DECADE":t>8e-11?"DECADE_5":t>1e-11?"CENTURY":t>5e-12?"CENTURY_5":"MILLENIUM"),e.getStep=(t=>{if("YEAR"===t)return 1;if("YEAR_5"===t)return 5;if("DECADE"===t)return 10;if("DECADE_5"===t)return 50;if("CENTURY"===t)return 100;if("CENTURY_5"===t)return 500;if("MILLENIUM"===t)return 1e3;if("MILLISECOND"===t)return 1;if("MILLISECOND_10"===t)return 10;if("MILLISECOND_50"===t)return 50;if("MILLISECOND_100"===t)return 100;if("MILLISECOND_500"===t)return 500;throw new RangeError("[getStep] Only steps with a granularity greater than 'year' calculated")}),e.subsequentDate=function(t){return u(t)?i=>{let n=new Date(i),r=n.getUTCFullYear()+1;if("YEAR"!==t){const i=e.getStep(t);for(;r%i!=0;)r+=1}return r>-1&&r<100?(n.setUTCFullYear(r),n.getTime()):Date.UTC(r,0,1)}:"MONHT"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth()+1,1)}:"WEEK"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()+7)}:"DAY"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()+1)}:"HOUR"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours()+1)}:"MINUTE"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes()+1)}:"SECOND"===t?t=>{const e=new Date(t);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()+1)}:"MILLISECOND"===t.slice(0,"MILLISECOND".length)?i=>{const n=e.getStep(t),r=new Date(i);let o=r.getUTCMilliseconds()+1;return n>1&&(o=o+n-o%n),Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),o)}:void 0},e.byDate=function(t,e){const i=null!=t.date_min?t.date_min:t.date,n=null!=e.date_min?e.date_min:e.date;if(i<n)return-1;if(i>n)return 1;const r=null!=t.end_date_max?t.end_date_max:t.end_date,o=null!=e.end_date_max?e.end_date_max:e.end_date;return r<o?-1:r>o?1:0};e.labelBody=((t,e)=>{const i=new Date(t);return u(e)?i.getUTCFullYear().toString():"MONHT"===e?o(i):"WEEK"===e?`${o(i)}, week ${(t=>{const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),i=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-i);const n=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e.getTime()-n.getTime())/864e5+1)/7)})(i)}`:"DAY"===e?`${s(i)} ${o(i)}`:"HOUR"===e?`${a(i)}:00`:"MINUTE"===e?`${a(i)}:${h(i)}`:"SECOND"===e?`${a(i)}:${h(i)}:${c(i)}`:"MILLISECOND"===e.slice(0,"MILLISECOND".length)?`${a(i)}:${h(i)}:${c(i)}.${l(i)}`:void 0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(79),r=i(73),o=i(57),s=i(41),a=i(40),h=i(80),c=i(63),l=i(56);e.default=class extends n.default{constructor(t){super(Object.assign({},new r.EventsBandConfig,t)),this.events=[],this.rowCount=0,this.visibleEvents=[],this._offsetY=0,null!=this.config.events&&this.config.events.sort(c.byDate)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY+=t,this._offsetY<0&&(this._offsetY=0);const e=this.height>this.availableHeight?this.height-this.availableHeight+s.EVENT_ROW_HEIGHT:0;this._offsetY>e&&(this._offsetY=e);const i=this._offsetY/s.EVENT_ROW_HEIGHT;this.lowestVisibleRow=Math.ceil(i),this.highestVisibleRow=this.lowestVisibleRow+this.visibleRowsCount}init(){super.init();const t=l.calcPixelsPerMillisecond(a.default.viewportWidth,this.config.zoomLevel||0,a.default.time),e=null==this.config.orderedEvents?h.orderEvents(this.config.events,t):this.config.orderedEvents;this.events=e.events,this.rowCount=e.row_count,this.height=s.EVENT_ROW_HEIGHT*this.rowCount,this.offsetY=0,this.updateEvents()}getColor(t,e){const i=[49,220,215];let n;if(a.default.center>e)n=a.default.center-e;else{if(!(a.default.center<t))return`rgb(${i.join(", ")})`;n=t-a.default.center}const r=n/(this.time/2),o=a.default.center>e?[253,231,37]:[204,104,232];return`rgb(${i.map((t,e)=>t+(o[e]-t)*r).join(", ")})`}updateEvents(){this.visibleEvents=this.events.filter(t=>!(t.from>this.to||t.to<this.from)&&t.row>=this.lowestVisibleRow&&t.row<=this.highestVisibleRow).map(t=>(t.left=this.positionAtTimestamp(t.from),t.width=Math.round(t.time*this.pixelsPerMillisecond),t.time&&t.width<1&&(t.width=1),t.padding=Math.round(t.space*this.pixelsPerMillisecond),t.top=this.top+this.availableHeight-(t.row+1)*s.EVENT_ROW_HEIGHT+this.offsetY,t.color=this.getColor(t.from,t.to),t))}update(){super.update(),this.updateEvents()}getEventByCoordinates(t,e){const i=this.timestampAtPosition(t),n=a.default.viewportOffset+this.top+this.availableHeight+this.offsetY,r=Math.floor((n-e)/s.EVENT_ROW_HEIGHT);return this.events.find(t=>!(!(t.from<i&&t.from+t.time+t.space>i)||t.row<this.lowestVisibleRow||t.row>this.highestVisibleRow)&&t.row===r)}zoomIn(){o.default.zoomTo(this,this.zoomLevel+1)}zoomOut(){o.default.zoomTo(this,this.zoomLevel-1)}}},function(t,e,i){"use strict";t.exports=i(97)},function(t,e,i){"use strict";var n=i(2),r=i(34),o=i(4),s=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(o.a.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),o=0;o<i;++o)r[o]=Object(n.a)(this,t[o],e);return r}return Object(n.a)(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),o=0;o<i;++o)r[o]=Object(n.b)(this,t[o],e);return r}return Object(n.b)(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,r=t.length;i<r;++i)Object(n.c)(this,t[i],e);else Object(n.c)(this,t,e)},e}(r.a);e.a=s},function(t,e,i){"use strict";var n=i(12),r=i(1),o=i(9),s=i(25),a=i(16),h=i(18),c=i(6),l=Object(c.c)(),u=function(t){function e(){t.call(this),this.extent_=Object(r.i)(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){},e.prototype.closestPointXY=function(t,e,i,n){},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),Object(r.H)(this.extent_,t)},e.prototype.rotate=function(t,e){},e.prototype.scale=function(t,e,i){},e.prototype.translate=function(t,e){},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){},e.prototype.getType=function(){},e.prototype.applyTransform=function(t){},e.prototype.intersectsExtent=function(t){},e.prototype.translate=function(t,e){},e.prototype.transform=function(t,e){var i=(t=Object(a.get)(t)).getUnits()==h.b.TILE_PIXELS?function(i,n,o){var h=t.getExtent(),u=t.getWorldExtent(),d=Object(r.z)(u)/Object(r.z)(h);return Object(c.b)(l,u[0],u[3],d,-d,0,0,0),Object(s.c)(i,0,i.length,o,l,n),Object(a.getTransform)(t,e)(i,n,o)}:Object(a.getTransform)(t,e);return this.applyTransform(i),this},e}(n.a);u.prototype.containsXY=o.a,e.a=u},function(t,e,i){"use strict";var n=i(3),r=function(t){function e(e){var i="Assertion failed. See https://openlayers.org/en/"+n.a.split("-")[0]+"/doc/errors/#"+e+" for details.";t.call(this,i),this.code=e,this.name="AssertionError",this.message=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);e.a=r},function(t,e,i){"use strict";var n=i(12),r=i(20),o=i(5),s=i(10),a=function(t){function e(e){t.call(this);var i=Object(s.a)({},e);i[r.a.OPACITY]=void 0!==e.opacity?e.opacity:1,i[r.a.VISIBLE]=void 0===e.visible||e.visible,i[r.a.Z_INDEX]=void 0!==e.zIndex?e.zIndex:0,i[r.a.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,i[r.a.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(i),this.state_={layer:this,managed:!0},this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){return this.state_.opacity=Object(o.a)(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex(),this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},e.prototype.getLayersArray=function(t){},e.prototype.getLayerStatesArray=function(t){},e.prototype.getExtent=function(){return this.get(r.a.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(r.a.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(r.a.MIN_RESOLUTION)},e.prototype.getOpacity=function(){return this.get(r.a.OPACITY)},e.prototype.getSourceState=function(){},e.prototype.getVisible=function(){return this.get(r.a.VISIBLE)},e.prototype.getZIndex=function(){return this.get(r.a.Z_INDEX)},e.prototype.setExtent=function(t){this.set(r.a.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(r.a.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(r.a.MIN_RESOLUTION,t)},e.prototype.setOpacity=function(t){this.set(r.a.OPACITY,t)},e.prototype.setVisible=function(t){this.set(r.a.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(r.a.Z_INDEX,t)},e}(n.a);e.a=a},function(t,e,i){"use strict";var n=i(9),r=i(12),o=i(16),s=i(32),a=function(t){function e(e){t.call(this),this.projection_=Object(o.get)(e.projection),this.attributions_=this.adaptAttributions_(e.attributions),this.state_=void 0!==e.state?e.state:s.a.READY,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.adaptAttributions_=function(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null},e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=this.adaptAttributions_(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(r.a);a.prototype.forEachFeatureAtCoordinate=n.c,e.a=a},function(t,e,i){"use strict";e.a=function(t){var e={};return function(i){return void 0===e[i]&&(e[i]=t(i)),e[i]}}},function(t,e,i){"use strict";i.r(e);var n=i(55),r=i(15),o=i(19),s=i(28),a=i(21),h=i(10),c=i(52),l=i(6),u=[0,0,0,1],d=[0,0,0,1],p=new c.a,f={},_=null,g={};!function(){var t,e,i=60,n=f,r="32px ",o=["monospace","serif"],s=o.length,a="wmytzilWMYTZIL@#/&?$%10";function c(t){for(var i=v(),n=!0,h=0;h<s;++h){var c=o[h];if(i.font=r+c,i.measureText(a).width,t!=c){i.font=r+t+","+c;var l=i.measureText(a).width;n&&l!=e}}return n}function l(){var e=!0;for(var r in n)n[r]<i&&(c(r)?(n[r]=i,Object(h.b)(g),null,p.clear()):(++n[r],!1));e&&(clearInterval(t),void 0)}}();function v(){return _||Object(r.a)(1,1),_}!function(){var t,e=g}();Object(l.c)();var y=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.snapToPixel_=t.snapToPixel};y.prototype.getOpacity=function(){return this.opacity_},y.prototype.getRotateWithView=function(){return this.rotateWithView_},y.prototype.getRotation=function(){return this.rotation_},y.prototype.getScale=function(){return this.scale_},y.prototype.getSnapToPixel=function(){return this.snapToPixel_},y.prototype.getAnchor=function(){},y.prototype.getImage=function(t){},y.prototype.getHitDetectionImage=function(t){},y.prototype.getImageState=function(){},y.prototype.getImageSize=function(){},y.prototype.getHitDetectionImageSize=function(){},y.prototype.getOrigin=function(){},y.prototype.getSize=function(){},y.prototype.setOpacity=function(t){this.opacity_=t},y.prototype.setRotateWithView=function(t){this.rotateWithView_=t},y.prototype.setRotation=function(t){this.rotation_=t},y.prototype.setScale=function(t){this.scale_=t},y.prototype.setSnapToPixel=function(t){this.snapToPixel_=t},y.prototype.listenImageChange=function(t,e){},y.prototype.load=function(){},y.prototype.unlistenImageChange=function(t,e){};var m=function(t){function e(e){var i=e||{};t.call(this,{points:1/0,fill:i.fill,radius:i.radius,snapToPixel:i.snapToPixel,stroke:i.stroke,atlasManager:i.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(function(t){function e(e){var i=void 0===e.snapToPixel||e.snapToPixel,n=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:1,snapToPixel:i}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return s.a.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,i,s="",a="",h=0,c=null,l=0,u=0;this.stroke_&&(null===(i=this.stroke_.getColor())&&(i=d),i=Object(n.a)(i),void 0===(u=this.stroke_.getWidth())&&(u=1),c=this.stroke_.getLineDash(),l=this.stroke_.getLineDashOffset(),o.a||(c=null,l=0),void 0===(a=this.stroke_.getLineJoin())&&(a="round"),void 0===(s=this.stroke_.getLineCap())&&(s="round"),void 0===(h=this.stroke_.getMiterLimit())&&(h=10));var p=2*(this.radius_+u)+1,f={strokeStyle:i,strokeWidth:u,size:p,lineCap:s,lineDash:c,lineDashOffset:l,lineJoin:a,miterLimit:h};if(void 0===t){var _=Object(r.a)(p,p);this.canvas_=_.canvas,e=p=this.canvas_.width,this.draw_(f,_,0,0),this.createHitDetectionCanvas_(f)}else{p=Math.round(p);var g,v=!this.fill_;v&&(g=this.drawHitDetectionCanvas_.bind(this,f));var y=this.getChecksum(),m=t.add(y,p,p,this.draw_.bind(this,f),g);this.canvas_=m.image,this.origin_=[m.offsetX,m.offsetY],e=m.image.width,v?(this.hitDetectionCanvas_=m.hitImage,this.hitDetectionImageSize_=[m.hitImage.width,m.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[p/2,p/2],this.size_=[p,p],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,i,r){var o,s,a;e.setTransform(1,0,0,1,0,0),e.translate(i,r),e.beginPath();var h=this.points_;if(h===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var c=void 0!==this.radius2_?this.radius2_:this.radius_;for(c!==this.radius_&&(h*=2),o=0;o<=h;o++)s=2*o*Math.PI/h-Math.PI/2+this.angle_,a=o%2==0?this.radius_:c,e.lineTo(t.size/2+a*Math.cos(s),t.size/2+a*Math.sin(s))}if(this.fill_){var l=this.fill_.getColor();null===l&&(l=u),e.fillStyle=Object(n.a)(l),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=Object(r.a)(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(r*=2),o=0;o<=r;o++)a=2*o*Math.PI/r-Math.PI/2+this.angle_,s=o%2==0?this.radius_:h,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=u,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var i="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[i,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(y));e.default=m},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.DomainConfig=class{};class n{constructor(){this.heightRatio=1,this.rulers=!0,this.rulerLabels=!0,this.topOffsetRatio=0,this.zoomLevel=0}}e.BandConfig=n;e.MinimapBandConfig=class extends n{constructor(){super(...arguments),this.indicatorFor=0,this.targets=[]}};e.EventsBandConfig=class extends n{};e.default=class{}},function(t,e,i){"use strict";i.r(e);var n=i(1),r=i(7),o=i(43),s=i(54),a=i(5),h=function(t){function e(e,i){t.call(this),this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=Object(a.g)(t,e,r[0],r[1]);if(o<n){for(var s=this.stride,h=0;h<s;++h)i[h]=r[h];return i.length=s,o}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Object(n.l)(this.flatCoordinates,t)},e.prototype.getType=function(){return r.a.POINT},e.prototype.intersectsExtent=function(t){return Object(n.h)(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Object(s.a)(this.flatCoordinates,0,t,this.stride),this.changed()},e}(o.a);e.default=h},function(t,e,i){"use strict";i.r(e);var n=i(47),r=i(3),o=i(9),s=i(5);function a(t){return t}var h=i(12),c=i(13);var l=i(37),u=i(14),d="center",p="resolution",f="rotation",_=i(11),g=i(38),v=i(23),y=i(1),m=i(7),b=i(62),x=i(43),E=i(10),C=i(16),O=i(18);i.d(e,"createCenterConstraint",function(){return R}),i.d(e,"createResolutionConstraint",function(){return I}),i.d(e,"createRotationConstraint",function(){return S}),i.d(e,"isNoopAnimation",function(){return P});var T=0,w=function(t){function e(e){t.call(this);var i=Object(E.a)({},e);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=Object(C.createProjection)(i.projection,"EPSG:3857"),this.applyOptions_(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.applyOptions_=function(t){var e={};e[d]=void 0!==t.center?t.center:null;var i=I(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=i.minZoom;var n=R(t),r=i.constraint,o=S(t);this.constraints_={center:n,resolution:r,rotation:o},void 0!==t.resolution?e[p]=t.resolution:void 0!==t.zoom&&(e[p]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(e[p]=Object(s.a)(Number(this.getResolution()||e[p]),this.minResolution_,this.maxResolution_))),e[f]=void 0!==t.rotation?t.rotation:0,this.setProperties(e),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=Object(E.a)({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenter(),e.rotation=this.getRotation(),Object(E.a)({},e,t)},e.prototype.animate=function(t){var e,i=arguments,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var r=arguments[n-1];return r.center&&this.setCenter(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(e&&setTimeout(function(){e(!0)},0))}for(var o=Date.now(),a=this.getCenter().slice(),h=this.getResolution(),c=this.getRotation(),l=[],d=0;d<n;++d){var p=i[d],f={start:o,complete:!1,anchor:p.anchor,duration:void 0!==p.duration?p.duration:1e3,easing:p.easing||v.c};if(p.center&&(f.sourceCenter=a,f.targetCenter=p.center,a=f.targetCenter),void 0!==p.zoom?(f.sourceResolution=h,f.targetResolution=this.constrainResolution(this.maxResolution_,p.zoom-this.minZoom_,0),h=f.targetResolution):p.resolution&&(f.sourceResolution=h,f.targetResolution=p.resolution,h=f.targetResolution),void 0!==p.rotation){f.sourceRotation=c;var _=Object(s.d)(p.rotation-c+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=c+_,c=f.targetRotation}f.callback=e,P(f)?f.complete=!0:o+=f.duration,l.push(f)}this.animations_.push(l),this.setHint(u.a.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[u.a.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[u.a.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(u.a.ANIMATING,-this.hints_[u.a.ANIMATING]);for(var t=0,e=this.animations_.length;t<e;++t){var i=this.animations_[t];i[0].callback&&i[0].callback(!1)}this.animations_.length=0},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var n=this.animations_[i],r=!0,o=0,a=n.length;o<a;++o){var h=n[o];if(!h.complete){var c=t-h.start,l=h.duration>0?c/h.duration:1;l>=1?(h.complete=!0,l=1):r=!1;var _=h.easing(l);if(h.sourceCenter){var g=h.sourceCenter[0],v=h.sourceCenter[1],y=g+_*(h.targetCenter[0]-g),m=v+_*(h.targetCenter[1]-v);this.set(d,[y,m])}if(h.sourceResolution&&h.targetResolution){var b=1===_?h.targetResolution:h.sourceResolution+_*(h.targetResolution-h.sourceResolution);h.anchor&&this.set(d,this.calculateCenterZoom(b,h.anchor)),this.set(p,b)}if(void 0!==h.sourceRotation&&void 0!==h.targetRotation){var x=1===_?Object(s.d)(h.targetRotation+Math.PI,2*Math.PI)-Math.PI:h.sourceRotation+_*(h.targetRotation-h.sourceRotation);h.anchor&&this.set(d,this.calculateCenterRotate(x,h.anchor)),this.set(f,x)}if(e=!0,!h.complete)break}}if(r){this.animations_[i]=null,this.setHint(u.a.ANIMATING,-1);var E=n[0].callback;E&&setTimeout(function(){E(!0)},0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},e.prototype.calculateCenterRotate=function(t,e){var i,n=this.getCenter();return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],Object(g.c)(i,t-this.getRotation()),Object(g.a)(i,e)),i},e.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenter(),r=this.getResolution();void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]);return i},e.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+Object(r.b)(this)+'"]',i=document.querySelector(e);if(i){var n=getComputedStyle(i);t[0]=parseInt(n.width,10),t[1]=parseInt(n.height,10)}return t},e.prototype.constrainCenter=function(t){return this.constraints_.center(t)},e.prototype.constrainResolution=function(t,e,i){var n=e||0,r=i||0;return this.constraints_.resolution(t,n,r)},e.prototype.constrainRotation=function(t,e){var i=e||0;return this.constraints_.rotation(t,i)},e.prototype.getCenter=function(){return this.get(d)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var e=t||this.getSizeFromViewport_(),i=this.getCenter();Object(_.a)(i,1);var n=this.getResolution();Object(_.a)(void 0!==n,2);var r=this.getRotation();return Object(_.a)(void 0!==r,3),Object(y.y)(i,n,r,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(p)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){var i=e||this.getSizeFromViewport_(),n=Object(y.D)(t)/i[0],r=Object(y.z)(t)/i[1];return Math.max(n,r)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*r)}},e.prototype.getRotation=function(){return this.get(f)},e.prototype.getValueForResolutionFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return Math.log(i/t)/Math.log(e)/r}},e.prototype.getState=function(){var t=this.getCenter(),e=this.getProjection(),i=this.getResolution(),n=this.getRotation();return{center:t.slice(),projection:void 0!==e?e:null,resolution:i,rotation:n,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,i,n=this.minZoom_||0;if(this.resolutions_){var r=Object(c.e)(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)},e.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},e.prototype.fit=function(t,e){var i,n=e||{},r=n.size;r||(r=this.getSizeFromViewport_()),t instanceof x.a?t.getType()===m.a.CIRCLE?(t=t.getExtent(),(i=Object(b.b)(t)).rotate(this.getRotation(),Object(y.w)(t))):i=t:(Object(_.a)(Array.isArray(t),24),Object(_.a)(!Object(y.G)(t),25),i=Object(b.b)(t));var s,a=void 0!==n.padding?n.padding:[0,0,0,0],h=void 0===n.constrainResolution||n.constrainResolution,c=void 0!==n.nearest&&n.nearest;s=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.constrainResolution(this.maxResolution_,n.maxZoom-this.minZoom_,0):0;for(var l=i.getFlatCoordinates(),u=this.getRotation(),d=Math.cos(-u),p=Math.sin(-u),f=1/0,g=1/0,v=-1/0,E=-1/0,C=i.getStride(),O=0,T=l.length;O<T;O+=C){var w=l[O]*d-l[O+1]*p,R=l[O]*p+l[O+1]*d;f=Math.min(f,w),g=Math.min(g,R),v=Math.max(v,w),E=Math.max(E,R)}var I=this.getResolutionForExtent([f,g,v,E],[r[0]-a[1]-a[3],r[1]-a[0]-a[2]]);if(I=isNaN(I)?s:Math.max(I,s),h){var S=this.constrainResolution(I,0,0);!c&&S<I&&(S=this.constrainResolution(S,-1,0)),I=S}p=-p;var P=(f+v)/2,M=(g+E)/2,j=[(P+=(a[1]-a[3])/2*I)*d-(M+=(a[0]-a[2])/2*I)*p,M*d+P*p],L=n.callback?n.callback:o.c;void 0!==n.duration?this.animate({resolution:I,center:j,duration:n.duration,easing:n.easing},L):(this.setResolution(I),this.setCenter(j),setTimeout(L.bind(void 0,!0),0))},e.prototype.centerOn=function(t,e,i){var n=this.getRotation(),r=Math.cos(-n),o=Math.sin(-n),s=t[0]*r-t[1]*o,a=t[1]*r+t[0]*o,h=this.getResolution(),c=(s+=(e[0]/2-i[0])*h)*r-(a+=(i[1]-e[1]/2)*h)*(o=-o),l=a*r+s*o;this.setCenter([c,l])},e.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},e.prototype.rotate=function(t,e){if(void 0!==e){var i=this.calculateCenterRotate(t,e);this.setCenter(i)}this.setRotation(t)},e.prototype.setCenter=function(t){this.set(d,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.set(p,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setRotation=function(t){this.set(f,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e}(h.a);function R(t){return void 0!==t.extent?function(t){return function(e){return e?[Object(s.a)(e[0],t[0],t[2]),Object(s.a)(e[1],t[1],t[3])]:void 0}}(t.extent):a}function I(t){var e,i,r,o=void 0!==t.minZoom?t.minZoom:T,a=void 0!==t.maxZoom?t.maxZoom:28,h=void 0!==t.zoomFactor?t.zoomFactor:2;if(void 0!==t.resolutions){var l=t.resolutions;i=l[o],r=void 0!==l[a]?l[a]:l[l.length-1],e=function(t){return function(e,i,n){if(void 0!==e){var r=Object(c.e)(t,e,n);r=Object(s.a)(r+i,0,t.length-1);var o=Math.floor(r);if(r!=o&&o<t.length-1){var a=t[o]/t[o+1];return t[o]/Math.pow(a,r-o)}return t[o]}}}(l)}else{var u=Object(C.createProjection)(t.projection,"EPSG:3857"),d=u.getExtent(),p=(d?Math.max(Object(y.D)(d),Object(y.z)(d)):360*O.a[O.b.DEGREES]/u.getMetersPerUnit())/n.b/Math.pow(2,T),f=p/Math.pow(2,28-T);void 0!==(i=t.maxResolution)?o=0:i=p/Math.pow(h,o),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(h,a):p/Math.pow(h,a):f),a=o+Math.floor(Math.log(i/r)/Math.log(h)),r=i/Math.pow(h,a-o),e=function(t,e,i){return function(n,r,o){if(void 0!==n){var s=-o/2+.5,a=Math.floor(Math.log(e/n)/Math.log(t)+s),h=Math.max(a+r,0);return void 0!==i&&(h=Math.min(h,i)),e/Math.pow(t,h)}}}(h,i,a-o)}return{constraint:e,maxResolution:i,minResolution:r,minZoom:o,zoomFactor:h}}function S(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?Object(l.b)():!1===e?l.d:"number"==typeof e?Object(l.a)(e):l.d}return l.c}function P(t){return!(t.sourceCenter&&t.targetCenter&&!Object(g.b)(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}e.default=w},function(t,e,i){"use strict";i.r(e),i.d(e,"__extends",function(){return r}),i.d(e,"__assign",function(){return o}),i.d(e,"__rest",function(){return s}),i.d(e,"__decorate",function(){return a}),i.d(e,"__param",function(){return h}),i.d(e,"__metadata",function(){return c}),i.d(e,"__awaiter",function(){return l}),i.d(e,"__generator",function(){return u}),i.d(e,"__exportStar",function(){return d}),i.d(e,"__values",function(){return p}),i.d(e,"__read",function(){return f}),i.d(e,"__spread",function(){return _}),i.d(e,"__await",function(){return g}),i.d(e,"__asyncGenerator",function(){return v}),i.d(e,"__asyncDelegator",function(){return y}),i.d(e,"__asyncValues",function(){return m}),i.d(e,"__makeTemplateObject",function(){return b}),i.d(e,"__importStar",function(){return x}),i.d(e,"__importDefault",function(){return E});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function r(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var o=function(){return(o=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function s(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&(i[n[r]]=t[n[r]])}return i}function a(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s}function h(t,e){return function(i,n){e(i,n,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,i,n){return new(i||(i=Promise))(function(r,o){function s(t){try{h(n.next(t))}catch(t){o(t)}}function a(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(s,a)}h((n=n.apply(t,e||[])).next())})}function u(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function d(t,e){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}function p(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}function f(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function _(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t}function g(t){return this instanceof g?(this.v=t,this):new g(t)}function v(t,e,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(t,e||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(t){r[t]&&(n[t]=function(e){return new Promise(function(i,n){o.push([t,e,i,n])>1||a(t,e)})})}function a(t,e){try{!function(t){t.value instanceof g?Promise.resolve(t.value.v).then(h,c):l(o[0][2],t)}(r[t](e))}catch(t){l(o[0][3],t)}}function h(t){a("next",t)}function c(t){a("throw",t)}function l(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}function y(t){var e,i;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,r){e[n]=t[n]?function(e){return(i=!i)?{value:g(t[n](e)),done:"return"===n}:r?r(e):e}:r}}function m(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t=p(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(i){e[i]=t[i]&&function(e){return new Promise(function(n,r){(function(t,e,i,n){Promise.resolve(n).then(function(e){t({value:e,done:i})},e)})(n,r,(e=t[i](e)).done,e.value)})}}}function b(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function E(t){return t&&t.__esModule?t:{default:t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(40);e.TimelineProps=n.Props;const r=i(73);e.TimelineConfig=r.default;const o=i(81),s=i(58),a=i(56);e.calcPixelsPerMillisecond=a.calcPixelsPerMillisecond;const h=i(80);e.OrderedEvents=h.OrderedEvents,e.orderEvents=h.orderEvents;const c=i(107),l=i(108),u=i(109),d=i(111),p=i(78);e.MinimapBand=p.default;const f=i(64);e.EventsBand=f.default;const _=i(63);e.formatDate=_.formatDate;const g=i(112);e.RawEv3nt=g.RawEv3nt;e.default=class extends c.default{constructor(t,e,i){super(e),this.config=t,this.onSelect=i,this.appendToWrapper=(t=>{let e=t.render();Array.isArray(e)||(e=[e]),e.forEach(t=>this.wrapper.appendChild(t))}),n.default.init(t),t.rootElement.appendChild(this.render());const r=a.debounce(this.resize,600);window.addEventListener("resize",r)}render(){this.wrapper=s.default("div","wrapper",["box-sizing: border-box","height: 100%","overflow: hidden","position: relative","user-select: none","width: 100%"]),this.views=n.default.bands.map(t=>t instanceof f.default?new l.default(t,this.onSelect):new o.default(t)),this.views.push(new u.default),this.views.forEach(this.appendToWrapper),this.renderLabels();const t=s.default("div","red-line",["background-color: rgb(126, 0, 0)","bottom: 0","left: calc(50% - 1px)","position: absolute","top: 0","width: 2px","z-index: 4"]);return this.wrapper.appendChild(t),this.wrapper}renderLabels(){n.default.bands.filter(t=>t instanceof f.default&&null!=t.config.label).map(t=>new d.default(t)).forEach(this.appendToWrapper)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(79),r=i(73),o=i(40),s=i(58);e.default=class extends n.default{constructor(t){super(function(t){const e=Object.assign({},new r.MinimapBandConfig,t);return e.targets.length||e.targets.push(0),e}(t)),this.isDrawn=!1,this.canvas=s.default("canvas"),this.ctx=this.canvas.getContext("2d"),this.nextCanvas=s.default("canvas"),this.nextCtx=this.nextCanvas.getContext("2d")}init(){super.init(),this.maxRowCount=this.config.targets.reduce((t,e)=>{const{rowCount:i}=o.default.eventsBands[e];return Math.max(t,i)},0);const t=this.availableHeight/this.maxRowCount;this.eventHeight=t<1?1:Math.round(t),this.canvas.width=o.default.viewportWidth,this.canvas.height=this.maxRowCount*this.eventHeight,this.nextCanvas.width=o.default.viewportWidth,this.nextCanvas.height=this.maxRowCount*this.eventHeight}resize(){super.resize(),this.isDrawn=!1}draw(){return this.isDrawn?this.updateNextCanvas():this.drawEvents(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.nextCanvas,0,0),this.canvas}drawEvents(t=this.from,e=this.to){this.nextCtx.beginPath(),this.config.targets.forEach(i=>{const n=o.default.eventsBands[i];for(const i of n.events){if(i.from>e||i.to<t)continue;const n=Math.round(i.time*this.pixelsPerMillisecond),r=this.positionAtTimestamp(null!=i.date_min?i.date_min:i.date),o=this.maxRowCount-(i.row+1)*this.eventHeight,s=n<1?1:n;this.nextCtx.rect(r,o,s,this.eventHeight)}}),this.nextCtx.fillStyle="rgb(190, 190, 190)",this.nextCtx.fill()}updateNextCanvas(){const t=Math.round(this.offsetX-this.prevOffsetX);if(0===t)return this.canvas;let e,i;this.nextCtx.clearRect(0,0,this.nextCanvas.width,this.nextCanvas.height),this.nextCtx.drawImage(this.canvas,t,0),t<0?(e=this.timestampAtPosition(o.default.viewportWidth+t),i=this.to):(e=this.from,i=this.timestampAtPosition(t)),this.drawEvents(e,i)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(63),r=i(40),o=i(41),s=i(56),a=i(57);e.default=class{constructor(t){this.config=t,this.defaultZoomLevel=0}get offsetX(){return this._offsetX}set offsetX(t){this.prevOffsetX=this.offsetX||t,this._offsetX=t}get zoomLevel(){return this._zoomLevel}set zoomLevel(t){t<0&&(t=0),this.visibleRatio=s.visibleRatio(t),this.width=Math.round(r.default.viewportWidth/this.visibleRatio),this.pixelsPerMillisecond=this.width/r.default.time,this.time=this.visibleRatio*r.default.time,this.granularity=n.getGranularity(this.pixelsPerMillisecond),this.nextDate=n.subsequentDate(this.granularity),this.prevZoomLevel=this.zoomLevel||t,this._zoomLevel=t,this.setHorizontalProps()}setVerticalProps(){this.visibleHeight=Math.round(this.config.heightRatio*r.default.viewportHeight),this.availableHeight=this.visibleHeight-o.DATE_BAR_HEIGHT,this.visibleRowsCount=Math.floor(this.availableHeight/o.EVENT_ROW_HEIGHT),this.top=Math.round(this.config.topOffsetRatio*r.default.viewportHeight)}setHorizontalProps(){this.from=r.default.center-this.time/2,this.to=r.default.center+this.time/2,this.offsetX=(r.default.from-this.from)*this.pixelsPerMillisecond}init(){this.zoomLevel=this.config.zoomLevel,this.setVerticalProps(),a.default.registerModel(this)}resize(){this.zoomLevel=this.zoomLevel,this.setVerticalProps()}update(){this.setHorizontalProps()}updateConfig(t){Object.keys(t).forEach(e=>{this.config.hasOwnProperty(e)&&(this.config[e]=t[e])})}positionAtTimestamp(t){return Math.round((t-this.from)*this.pixelsPerMillisecond)}timestampAtProportion(t){return r.default.from+r.default.time*t}timestampAtPosition(t){return this.from+t/this.pixelsPerMillisecond}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(41);class r{constructor(){this.events=[],this.row_count=0}}e.OrderedEvents=r;const o=8;e.orderEvents=function(t,e){if(!t.length)return new r;let i=0;const s=[],a=2*n.EVENT_HEIGHT/e;return{events:t=t.map(t=>{let n;null==t.label&&(t.label="NO LABEL"),t.from=t.date_min||t.date,t.to=t.end_date_max||t.end_date,null==t.to&&(t.to=t.from),t.time=null==t.to?0:t.to-t.from,t.space=0,t.time||(null==t.label&&(t.label="NO LABEL"),t.space=t.label.length*o/e+a);let r=0;for(;null==n&&r<s.length;){let e=0,i=!0;for(;i&&e<s[r].length&&!(t.to<s[r][e][0]);)i=t.from>s[r][e][1],e++;i&&(s[r].push([t.from,t.from+t.time+t.space]),n=r),r++}return null==n&&(n=s.push([[t.from,t.from+t.time+t.space]])-1),n>i&&(i=n),t.row=n,t}),row_count:s.length}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(40),r=i(58),o=i(82),s=i(57),a=i(41),h=i(64);e.default=class{constructor(t){this.band=t,this.onMouseDown=(t=>{document.addEventListener("mouseup",this.onMouseUp),this.dragStartTime=Date.now(),this.dragStartPosition=[t.clientX,t.clientY],this.dragOffsetX=t.clientX,this.dragOffsetY=t.clientY}),this.onMouseMove=(t=>{if(null==this.dragOffsetX)return;const e=t.clientY-this.dragOffsetY,i=t.clientX-this.dragOffsetX;this.band instanceof h.default&&(0!==this.band.offsetY||Math.abs(e)>Math.abs(i))&&(this.band.offsetY=e);const r=i/this.band.pixelsPerMillisecond;n.default.center-=r,s.default.nextFrame(),this.dragOffsetX=t.clientX,this.dragOffsetY=t.clientY}),this.onMouseUp=(t=>{this.lastDragInterval=Date.now()-this.dragStartTime,this.dispatchScrollDoneEvent(t),this.dragOffsetX=null,this.dragOffsetY=null,document.removeEventListener("mouseup",this.onMouseUp)}),this.onDblClick=(t=>{const e=this.band.timestampAtPosition(t.clientX);s.default.goTo(e)})}render(){return this.rootElement=r.default("div","band-wrap",["position: absolute","z-index: 2"],[`height: ${this.band.visibleHeight}px`,`top: ${this.band.top}px`,`width: ${n.default.viewportWidth}px`]),o.default.register("mousedown",this.onMouseDown,this.rootElement),o.default.register("mousemove",this.onMouseMove,this.rootElement),o.default.register("dblclick",this.onDblClick,this.rootElement),this.rootElement}dispatchScrollDoneEvent(t){const e=[this.dragStartPosition[0]-t.clientX,this.dragStartPosition[1]-t.clientY].map(Math.abs).some(t=>t>5);(this.lastDragInterval>200||e)&&document.dispatchEvent(new CustomEvent(a.SCROLL_DONE))}resize(){this.rootElement.style.cssText=`height: ${this.band.visibleHeight}px; top: ${this.band.top}px; width: ${n.default.viewportWidth}px;`}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(){this.eventsListeners=[]}register(t,e,i=document){i.addEventListener(t,e),this.eventsListeners.push([t,e,i])}flush(){this.eventsListeners.forEach(t=>{const[e,i,n]=t;n.removeEventListener(e,i)}),this.eventsListeners=[]}}e.EventBus=n,e.default=new n},function(t,e,i){"use strict";i.r(e);var n=i(65),r=i.n(n),o=i(59),s=i(86),a=i.n(s),h=i(71),c=Object(h.a)(RegExp.prototype.test.bind(/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|accept|acceptCharset|accessKey|action|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|default|defer|dir|disabled|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|itemProp|itemScope|itemType|itemID|itemRef|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class)|(on[A-Z].*)|((data|aria)-.*))$/i));var l,u="__EMOTION_THEMING__",d=((l={})[u]=a.a.object,l);var p=c,f=function(t){return"theme"!==t&&"innerRef"!==t},_=function(){return!0},g=function(t,e){for(var i=2,n=arguments.length;i<n;i++){var r=arguments[i],o=void 0;for(o in r)t(o)&&(e[o]=r[o])}return e};var v=function(t,e){var i=function(n,r){var o,s,a,h;void 0!==r&&(o=r.e,s=r.label,a=r.target,h=n.__emotion_forwardProp&&r.shouldForwardProp?function(t){return n.__emotion_forwardProp(t)&&r.shouldForwardProp(t)}:r.shouldForwardProp);var c=n.__emotion_real===n,l=void 0===o&&c&&n.__emotion_base||n;return"function"!=typeof h&&(h="string"==typeof l&&l.charAt(0)===l.charAt(0).toLowerCase()?p:f),function(){var p=arguments,f=c&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==s&&f.push("label:"+s+";"),void 0===o)if(null==p[0]||void 0===p[0].raw)f.push.apply(f,p);else{f.push(p[0][0]);for(var v=p.length,y=1;y<v;y++)f.push(p[y],p[0][y])}var m=function(i){function n(){return i.apply(this,arguments)||this}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(n,i);var r=n.prototype;return r.componentWillMount=function(){void 0!==this.context[u]&&(this.unsubscribe=this.context[u].subscribe(function(t){this.setState({theme:t})}.bind(this)))},r.componentWillUnmount=function(){void 0!==this.unsubscribe&&this.context[u].unsubscribe(this.unsubscribe)},r.render=function(){var i=this.props,n=this.state;this.mergedProps=g(_,{},i,{theme:null!==n&&n.theme||i.theme||{}});var r="",s=[];return i.className&&(r+=void 0===o?t.getRegisteredStyles(s,i.className):i.className+" "),r+=void 0===o?t.css.apply(this,f.concat(s)):o,void 0!==a&&(r+=" "+a),e.createElement(l,g(h,{},i,{className:r,ref:i.innerRef}))},n}(e.Component);return m.displayName=void 0!==s?s:"Styled("+("string"==typeof l?l:l.displayName||l.name||"Component")+")",void 0!==n.defaultProps&&(m.defaultProps=n.defaultProps),m.contextTypes=d,m.__emotion_styles=f,m.__emotion_base=l,m.__emotion_real=m,m.__emotion_forwardProp=h,Object.defineProperty(m,"toString",{enumerable:!1,value:function(){return"."+a}}),m.withComponent=function(t,e){return i(t,void 0!==e?g(_,{},r,e):r).apply(void 0,f)},m}};return i};i.d(e,"flush",function(){return o.flush}),i.d(e,"hydrate",function(){return o.hydrate}),i.d(e,"cx",function(){return o.cx}),i.d(e,"merge",function(){return o.merge}),i.d(e,"getRegisteredStyles",function(){return o.getRegisteredStyles}),i.d(e,"injectGlobal",function(){return o.injectGlobal}),i.d(e,"keyframes",function(){return o.keyframes}),i.d(e,"css",function(){return o.css}),i.d(e,"sheet",function(){return o.sheet}),i.d(e,"caches",function(){return o.caches});var y=v(o,r.a);e.default=y},function(t,e,i){"use strict";t.exports=r,t.exports.default=r;var n=i(104);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,r){r||(r=v(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],h(r,t.leaf?n(o):o);return r}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function f(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,o-n)}function _(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function g(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function v(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(t,e,i,r,o){for(var s,a=[e,i];a.length;)(i=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,n(t,s,e,i,o),a.push(e,s,s,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!g(t,e))return i;for(var r,o,s,a,h=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],g(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):_(t,a)?this._all(s,i):h.push(s));e=h.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!g(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],g(t,s=e.leaf?i(o):o)){if(e.leaf||_(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=v([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,s,a=this.data,h=this.toBBox(t),c=[],l=[];a||c.length;){if(a||(a=c.pop(),n=c[c.length-1],i=l.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),c.push(a),this._condense(c),this;s||a.leaf||!_(a,h)?n?(i++,a=n.children[i],s=!1):a=null:(c.push(a),l.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:c,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=v(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=v([])).leaf=!1,r.height=n;var h,c,l,u,d=Math.ceil(o/a),p=d*Math.ceil(Math.sqrt(a));for(y(t,e,i,p,this.compareMinX),h=e;h<=i;h+=p)for(y(t,h,l=Math.min(h+p-1,i),d,this.compareMinY),c=h;c<=l;c+=d)u=Math.min(c+d-1,l),r.children.push(this._build(t,c,u,n-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,h,c,l,d;n.push(e),!e.leaf&&n.length-1!==i;){for(l=d=1/0,r=0,o=e.children.length;r<o;r++)h=u(s=e.children[r]),(c=p(t,s)-h)<d?(d=c,l=h<l?h:l,a=s):c===d&&h<l&&(l=h,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),h(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=v(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=v([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,h,c,l,d;for(c=l=1/0,n=e;n<=i-e;n++)s=f(r=a(t,0,n,this.toBBox),o=a(t,n,i,this.toBBox)),h=u(r)+u(o),s<c?(c=s,d=n,l=h<l?h:l):s===c&&h<l&&(l=h,d=n);return d},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:c,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,c=a(t,0,e,s),l=a(t,i-e,i,s),u=d(c)+d(l);for(r=e;r<i-e;r++)o=t.children[r],h(c,t.leaf?s(o):o),u+=d(c);for(r=i-e-1;r>=e;r--)o=t.children[r],h(l,t.leaf?s(o):o),u+=d(l);return u},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)h(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():s(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,i){t.exports=function(){"use strict";return function(t){function e(e){if(e)try{t(e+"}")}catch(t){}}return function(i,n,r,o,s,a,h,c,l,u){switch(i){case 1:if(0===l&&64===n.charCodeAt(0))return t(n+";"),"";break;case 2:if(0===c)return n+"/*|*/";break;case 3:switch(c){case 102:case 112:return t(r[0]+n),"";default:return n+(0===u?"/*|*/":"")}case-2:n.split("/*|*/}").forEach(e)}}}}()},function(t,e,i){t.exports=i(115)()},function(t,e,i){"use strict";var n=i(71),r={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var o=function(t){for(var e,i=t.length,n=i^i,r=0;i>=4;)e=1540483477*(65535&(e=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24))+((1540483477*(e>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(e=1540483477*(65535&(e^=e>>>24))+((1540483477*(e>>>16)&65535)<<16)),i-=4,++r;switch(i){case 3:n^=(255&t.charCodeAt(r+2))<<16;case 2:n^=(255&t.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(r)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),((n^=n>>>15)>>>0).toString(36)},s=function t(e){function i(t,e,i){var r=e.trim().split(_);e=r;var o=r.length,s=t.length;switch(s){case 0:case 1:var a=0;for(t=0===s?"":t[0]+" ";a<o;++a)e[a]=n(t,e[a],i).trim();break;default:var h=a=0;for(e=[];a<o;++a)for(var c=0;c<s;++c)e[h++]=n(t[c]+" ",r[a],i).trim()}return e}function n(t,e,i){var n=e.charCodeAt(0);switch(33>n&&(n=(e=e.trim()).charCodeAt(0)),n){case 38:return e.replace(g,"$1"+t.trim());case 58:return t.trim()+e.replace(g,"$1"+t.trim());default:if(0<1*i&&0<e.indexOf("\f"))return e.replace(g,(58===t.charCodeAt(0)?"":"$1")+t.trim())}return t+e}function r(t,e,i,n){var s=t+";",a=2*e+3*i+4*n;if(944===a){t=s.indexOf(":",9)+1;var h=s.substring(t,s.length-1).trim();return h=s.substring(0,t).trim()+h+";",1===P||2===P&&o(h,1)?"-webkit-"+h+h:h}if(0===P||2===P&&!o(s,1))return s;switch(a){case 1015:return 97===s.charCodeAt(10)?"-webkit-"+s+s:s;case 951:return 116===s.charCodeAt(3)?"-webkit-"+s+s:s;case 963:return 110===s.charCodeAt(5)?"-webkit-"+s+s:s;case 1009:if(100!==s.charCodeAt(4))break;case 969:case 942:return"-webkit-"+s+s;case 978:return"-webkit-"+s+"-moz-"+s+s;case 1019:case 983:return"-webkit-"+s+"-moz-"+s+"-ms-"+s+s;case 883:if(45===s.charCodeAt(8))return"-webkit-"+s+s;if(0<s.indexOf("image-set(",11))return s.replace(w,"$1-webkit-$2")+s;break;case 932:if(45===s.charCodeAt(4))switch(s.charCodeAt(5)){case 103:return"-webkit-box-"+s.replace("-grow","")+"-webkit-"+s+"-ms-"+s.replace("grow","positive")+s;case 115:return"-webkit-"+s+"-ms-"+s.replace("shrink","negative")+s;case 98:return"-webkit-"+s+"-ms-"+s.replace("basis","preferred-size")+s}return"-webkit-"+s+"-ms-"+s+s;case 964:return"-webkit-"+s+"-ms-flex-"+s+s;case 1023:if(99!==s.charCodeAt(8))break;return"-webkit-box-pack"+(h=s.substring(s.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+s+"-ms-flex-pack"+h+s;case 1005:return p.test(s)?s.replace(d,":-webkit-")+s.replace(d,":-moz-")+s:s;case 1e3:switch(e=(h=s.substring(13).trim()).indexOf("-")+1,h.charCodeAt(0)+h.charCodeAt(e)){case 226:h=s.replace(b,"tb");break;case 232:h=s.replace(b,"tb-rl");break;case 220:h=s.replace(b,"lr");break;default:return s}return"-webkit-"+s+"-ms-"+h+s;case 1017:if(-1===s.indexOf("sticky",9))break;case 975:switch(e=(s=t).length-10,a=(h=(33===s.charCodeAt(e)?s.substring(0,e):s).substring(t.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|h.charCodeAt(7))){case 203:if(111>h.charCodeAt(8))break;case 115:s=s.replace(h,"-webkit-"+h)+";"+s;break;case 207:case 102:s=s.replace(h,"-webkit-"+(102<a?"inline-":"")+"box")+";"+s.replace(h,"-webkit-"+h)+";"+s.replace(h,"-ms-"+h+"box")+";"+s}return s+";";case 938:if(45===s.charCodeAt(5))switch(s.charCodeAt(6)){case 105:return"-webkit-"+s+"-webkit-box-"+(h=s.replace("-items",""))+"-ms-flex-"+h+s;case 115:return"-webkit-"+s+"-ms-flex-item-"+s.replace(C,"")+s;default:return"-webkit-"+s+"-ms-flex-line-pack"+s.replace("align-content","").replace(C,"")+s}break;case 973:case 989:if(45!==s.charCodeAt(3)||122===s.charCodeAt(4))break;case 931:case 953:if(!0===T.test(t))return 115===(h=t.substring(t.indexOf(":")+1)).charCodeAt(0)?r(t.replace("stretch","fill-available"),e,i,n).replace(":fill-available",":stretch"):s.replace(h,"-webkit-"+h)+s.replace(h,"-moz-"+h.replace("fill-",""))+s;break;case 962:if(s="-webkit-"+s+(102===s.charCodeAt(5)?"-ms-"+s:"")+s,211===i+n&&105===s.charCodeAt(13)&&0<s.indexOf("transform",10))return s.substring(0,s.indexOf(";",27)+1).replace(f,"$1-webkit-$2")+s}return s}function o(t,e){var i=t.indexOf(1===e?":":"{"),n=t.substring(0,3!==e?i:10);return i=t.substring(i+1,t.length-1),A(2!==e?n:n.replace(O,"$1"),i,e)}function s(t,e){var i=r(e,e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2));return i!==e+";"?i.replace(E," or ($1)").substring(4):"("+e+")"}function a(t,e,i,n,r,o,s,a,h,l){for(var u,d=0,p=e;d<L;++d)switch(u=j[d].call(c,t,p,i,n,r,o,s,a,h,l)){case void 0:case!1:case!0:case null:break;default:p=u}if(p!==e)return p}function h(t){return void 0!==(t=t.prefix)&&(A=null,t?"function"!=typeof t?P=1:(P=2,A=t):P=0),h}function c(e,n){if(void 0!==this&&this.constructor===c)return t(e);var h=e;if(33>h.charCodeAt(0)&&(h=h.trim()),h=[h],0<L){var d=a(-1,n,h,h,I,R,0,0,0,0);void 0!==d&&"string"==typeof d&&(n=d)}var p=function t(e,n,h,c,d){for(var p,f,_,g,b,E=0,C=0,O=0,T=0,w=0,j=0,A=_=p=0,D=0,k=0,N=0,G=0,z=h.length,U=z-1,B="",Y="",W="",H="";D<z;){if(f=h.charCodeAt(D),D===U&&0!==C+T+O+E&&(0!==C&&(f=47===C?10:47),T=O=E=0,z++,U++),0===C+T+O+E){if(D===U&&(0<k&&(B=B.replace(u,"")),0<B.trim().length)){switch(f){case 32:case 9:case 59:case 13:case 10:break;default:B+=h.charAt(D)}f=59}switch(f){case 123:for(p=(B=B.trim()).charCodeAt(0),_=1,G=++D;D<z;){switch(f=h.charCodeAt(D)){case 123:_++;break;case 125:_--;break;case 47:switch(f=h.charCodeAt(D+1)){case 42:case 47:t:{for(A=D+1;A<U;++A)switch(h.charCodeAt(A)){case 47:if(42===f&&42===h.charCodeAt(A-1)&&D+2!==A){D=A+1;break t}break;case 10:if(47===f){D=A+1;break t}}D=A}}break;case 91:f++;case 40:f++;case 34:case 39:for(;D++<U&&h.charCodeAt(D)!==f;);}if(0===_)break;D++}switch(_=h.substring(G,D),0===p&&(p=(B=B.replace(l,"").trim()).charCodeAt(0)),p){case 64:switch(0<k&&(B=B.replace(u,"")),f=B.charCodeAt(1)){case 100:case 109:case 115:case 45:k=n;break;default:k=M}if(G=(_=t(n,k,_,f,d+1)).length,0<L&&(b=a(3,_,k=i(M,B,N),n,I,R,G,f,d,c),B=k.join(""),void 0!==b&&0===(G=(_=b.trim()).length)&&(f=0,_="")),0<G)switch(f){case 115:B=B.replace(x,s);case 100:case 109:case 45:_=B+"{"+_+"}";break;case 107:_=(B=B.replace(v,"$1 $2"))+"{"+_+"}",_=1===P||2===P&&o("@"+_,3)?"@-webkit-"+_+"@"+_:"@"+_;break;default:_=B+_,112===c&&(Y+=_,_="")}else _="";break;default:_=t(n,i(n,B,N),_,c,d+1)}W+=_,_=N=k=A=p=0,B="",f=h.charCodeAt(++D);break;case 125:case 59:if(1<(G=(B=(0<k?B.replace(u,""):B).trim()).length))switch(0===A&&(p=B.charCodeAt(0),45===p||96<p&&123>p)&&(G=(B=B.replace(" ",":")).length),0<L&&void 0!==(b=a(1,B,n,e,I,R,Y.length,c,d,c))&&0===(G=(B=b.trim()).length)&&(B="\0\0"),p=B.charCodeAt(0),f=B.charCodeAt(1),p){case 0:break;case 64:if(105===f||99===f){H+=B+h.charAt(D);break}default:58!==B.charCodeAt(G-1)&&(Y+=r(B,p,f,B.charCodeAt(2)))}N=k=A=p=0,B="",f=h.charCodeAt(++D)}}switch(f){case 13:case 10:47===C?C=0:0===1+p&&107!==c&&0<B.length&&(k=1,B+="\0"),0<L*F&&a(0,B,n,e,I,R,Y.length,c,d,c),R=1,I++;break;case 59:case 125:if(0===C+T+O+E){R++;break}default:switch(R++,g=h.charAt(D),f){case 9:case 32:if(0===T+E+C)switch(w){case 44:case 58:case 9:case 32:g="";break;default:32!==f&&(g=" ")}break;case 0:g="\\0";break;case 12:g="\\f";break;case 11:g="\\v";break;case 38:0===T+C+E&&(k=N=1,g="\f"+g);break;case 108:if(0===T+C+E+S&&0<A)switch(D-A){case 2:112===w&&58===h.charCodeAt(D-3)&&(S=w);case 8:111===j&&(S=j)}break;case 58:0===T+C+E&&(A=D);break;case 44:0===C+O+T+E&&(k=1,g+="\r");break;case 34:case 39:0===C&&(T=T===f?0:0===T?f:T);break;case 91:0===T+C+O&&E++;break;case 93:0===T+C+O&&E--;break;case 41:0===T+C+E&&O--;break;case 40:if(0===T+C+E){if(0===p)switch(2*w+3*j){case 533:break;default:p=1}O++}break;case 64:0===C+O+T+E+A+_&&(_=1);break;case 42:case 47:if(!(0<T+E+O))switch(C){case 0:switch(2*f+3*h.charCodeAt(D+1)){case 235:C=47;break;case 220:G=D,C=42}break;case 42:47===f&&42===w&&G+2!==D&&(33===h.charCodeAt(G+2)&&(Y+=h.substring(G,D+1)),g="",C=0)}}0===C&&(B+=g)}j=w,w=f,D++}if(0<(G=Y.length)){if(k=n,0<L&&void 0!==(b=a(2,Y,k,e,I,R,G,c,d,c))&&0===(Y=b).length)return H+Y+W;if(Y=k.join(",")+"{"+Y+"}",0!=P*S){switch(2!==P||o(Y,2)||(S=0),S){case 111:Y=Y.replace(m,":-moz-$1")+Y;break;case 112:Y=Y.replace(y,"::-webkit-input-$1")+Y.replace(y,"::-moz-$1")+Y.replace(y,":-ms-input-$1")+Y}S=0}}return H+Y+W}(M,h,n,0,0);return 0<L&&void 0!==(d=a(-2,p,h,h,I,R,p.length,0,0,0))&&(p=d),S=0,R=I=1,p}var l=/^\0+/g,u=/[\0\r\f]/g,d=/: */g,p=/zoo|gra/,f=/([,: ])(transform)/g,_=/,\r+?/g,g=/([\t\r\n ])*\f?&/g,v=/@(k\w+)\s*(\S*)\s*/,y=/::(place)/g,m=/:(read-only)/g,b=/[svh]\w+-[tblr]{2}/,x=/\(\s*(.*)\s*\)/g,E=/([\s\S]*?);/g,C=/-self|flex-/g,O=/[^]*?(:[rp][el]a[\w-]+)[^]*/,T=/stretch|:\s*\w+\-(?:conte|avail)/,w=/([^-])(image-set\()/,R=1,I=1,S=0,P=1,M=[],j=[],L=0,A=null,F=0;return c.use=function t(e){switch(e){case void 0:case null:L=j.length=0;break;default:switch(e.constructor){case Array:for(var i=0,n=e.length;i<n;++i)t(e[i]);break;case Function:j[L++]=e;break;case Boolean:F=0|!!e}}return t},c.set=h,void 0!==e&&h(e),c},a=i(85),h=i.n(a),c=/[A-Z]|^ms/g,l=Object(n.a)(function(t){return t.replace(c,"-$&").toLowerCase()}),u=function(t,e){return null==e||"boolean"==typeof e?"":1===r[t]||45===t.charCodeAt(1)||isNaN(e)||0===e?e:e+"px"},d=function t(e){for(var i=e.length,n=0,r="";n<i;n++){var o=e[n];if(null!=o){var s=void 0;switch(typeof o){case"boolean":break;case"function":0,s=t([o()]);break;case"object":if(Array.isArray(o))s=t(o);else for(var a in s="",o)o[a]&&a&&(s&&(s+=" "),s+=a);break;default:s=o}s&&(r&&(r+=" "),r+=s)}}return r},p="undefined"!=typeof document;function f(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key||""),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),(void 0!==t.container?t.container:document.head).appendChild(e),e}var _=function(){function t(t){this.isSpeedy=!0,this.tags=[],this.ctr=0,this.opts=t}var e=t.prototype;return e.inject=function(){if(this.injected)throw new Error("already injected!");this.tags[0]=f(this.opts),this.injected=!0},e.speedy=function(t){if(0!==this.ctr)throw new Error("cannot change speedy now");this.isSpeedy=!!t},e.insert=function(t,e){if(this.isSpeedy){var i=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(this.tags[this.tags.length-1]);try{i.insertRule(t,i.cssRules.length)}catch(t){0}}else{var n=f(this.opts);this.tags.push(n),n.appendChild(document.createTextNode(t+(e||"")))}this.ctr++,this.ctr%65e3==0&&this.tags.push(f(this.opts))},e.flush=function(){this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.ctr=0,this.injected=!1},t}();e.a=function(t,e){if(void 0!==t.__SECRET_EMOTION__)return t.__SECRET_EMOTION__;void 0===e&&(e={});var i,n,r=e.key||"css",a=h()(function(t){i+=t,p&&f.insert(t,v)});void 0!==e.prefix&&(n={prefix:e.prefix});var c={registered:{},inserted:{},nonce:e.nonce,key:r},f=new _(e);p&&f.inject();var g=new s(n);g.use(e.stylisPlugins)(a);var v="";function y(t,e){if(null==t)return"";switch(typeof t){case"boolean":return"";case"function":if(void 0!==t.__emotion_styles){var i=t.toString();return i}return y.call(this,void 0===this?t():t(this.mergedProps,this.context),e);case"object":return function(t){if(x.has(t))return x.get(t);var e="";return Array.isArray(t)?t.forEach(function(t){e+=y.call(this,t,!1)},this):Object.keys(t).forEach(function(i){"object"!=typeof t[i]?void 0!==c.registered[t[i]]?e+=i+"{"+c.registered[t[i]]+"}":e+=l(i)+":"+u(i,t[i])+";":Array.isArray(t[i])&&"string"==typeof t[i][0]&&void 0===c.registered[t[i][0]]?t[i].forEach(function(t){e+=l(i)+":"+u(i,t)+";"}):e+=i+"{"+y.call(this,t[i],!1)+"}"},this),x.set(t,e),e}.call(this,t);default:var n=c.registered[t];return!1===e&&void 0!==n?n:t}}var m,b,x=new WeakMap,E=/label:\s*([^\s;\n{]+)\s*;/g,C=function(t){var e=!0,i="",n="";null==t||void 0===t.raw?(e=!1,i+=y.call(this,t,!1)):i+=t[0];for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.forEach(function(n,r){i+=y.call(this,n,46===i.charCodeAt(i.length-1)),!0===e&&void 0!==t[r+1]&&(i+=t[r+1])},this),b=i,i=i.replace(E,function(t,e){return n+="-"+e,""}),m=function(t,e){return o(t+e)+e}(i,n),i};function O(t,e){void 0===c.inserted[m]&&(i="",g(t,e),c.inserted[m]=i)}var T=function(){var t=C.apply(this,arguments),e=r+"-"+m;return void 0===c.registered[e]&&(c.registered[e]=b),O("."+e,t),e};function w(t,e){var i="";return e.split(" ").forEach(function(e){void 0!==c.registered[e]?t.push(e):i+=e+" "}),i}function R(t,e){var i=[],n=w(i,t);return i.length<2?t:n+T(i,e)}function I(t){c.inserted[t]=!0}if(p){var S=document.querySelectorAll("[data-emotion-"+r+"]");Array.prototype.forEach.call(S,function(t){f.tags[0].parentNode.insertBefore(t,f.tags[0]),t.getAttribute("data-emotion-"+r).split(" ").forEach(I)})}var P={flush:function(){p&&(f.flush(),f.inject()),c.inserted={},c.registered={}},hydrate:function(t){t.forEach(I)},cx:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return R(d(e))},merge:R,getRegisteredStyles:w,injectGlobal:function(){O("",C.apply(this,arguments))},keyframes:function(){var t=C.apply(this,arguments),e="animation-"+m;return O("","@keyframes "+e+"{"+t+"}"),e},css:T,sheet:f,caches:c};return t.__SECRET_EMOTION__=P,P}},,,,,,,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(76),r=i(65),o=i(102),s=i(113),a=i(77),h=i(59),c=t=>{return h.css`
		display: grid;
		grid-template-rows: ${t===l.Map?"90% 5% 5%":t===l.Timeline?"0 5% 95%":"47.5% 5% 47.5%"};
		height: 100%;
		width: 100%;
		transition: all 1s;
	`};var l;!function(t){t[t.Both=0]="Both",t[t.Map=1]="Map",t[t.Timeline=2]="Timeline"}(l=e.VisibleComponents||(e.VisibleComponents={}));e.default=class extends r.PureComponent{constructor(t){super(t),this.timelineConfig=new a.TimelineConfig,this.timelineRef=r.createRef(),this.state={map:null,timeline:null,visibleComponents:l.Both,zoomLevel:null}}componentDidMount(){return n.__awaiter(this,void 0,void 0,function*(){this.timelineConfig=yield this.props.loadConfig(this.timelineRef.current);const t=new o.default({handleEvent:(t,e)=>console.log(t,e),target:"map"}),e=new a.default(this.timelineConfig,e=>{const i=this.timelineConfig.controlBand;this.state.zoomLevel!==i.zoomLevel&&this.setState({zoomLevel:i.zoomLevel}),t.setVisibleEvents(i.visibleEvents,e)},e=>t.onSelect(e));this.setState({map:t,timeline:e,zoomLevel:this.timelineConfig.controlBand.zoomLevel})})}componentDidUpdate(t,e){e.visibleComponents!==this.state.visibleComponents&&(this.state.map.updateSize(),this.state.timeline.reload())}render(){return r.createElement("div",{className:c(this.state.visibleComponents)},r.createElement("div",{id:"map"}),r.createElement(s.default,{controlBand:this.timelineConfig.controlBand,map:this.state.map,timeline:this.state.timeline,showBoth:()=>this.setState({visibleComponents:l.Both}),showMap:()=>{this.state.visibleComponents===l.Map?this.setState({visibleComponents:l.Both}):this.setState({visibleComponents:l.Map})},showTimeline:()=>{this.state.visibleComponents===l.Timeline?this.setState({visibleComponents:l.Both}):this.setState({visibleComponents:l.Timeline})},zoomIn:()=>this.timelineConfig.controlBand.zoomIn(),zoomLevel:this.state.zoomLevel,zoomOut:()=>this.timelineConfig.controlBand.zoomOut()}),r.createElement("div",{ref:this.timelineRef}))}}},function(t,e,i){"use strict";
/** @license React v16.4.2
 * react.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=i(98),r=i(99),o=i(100),s=i(101),a="function"==typeof Symbol&&Symbol.for,h=a?Symbol.for("react.element"):60103,c=a?Symbol.for("react.portal"):60106,l=a?Symbol.for("react.fragment"):60107,u=a?Symbol.for("react.strict_mode"):60108,d=a?Symbol.for("react.profiler"):60114,p=a?Symbol.for("react.provider"):60109,f=a?Symbol.for("react.context"):60110,_=a?Symbol.for("react.async_mode"):60111,g=a?Symbol.for("react.forward_ref"):60112;a&&Symbol.for("react.timeout");var v="function"==typeof Symbol&&Symbol.iterator;function y(t){for(var e=arguments.length-1,i="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=0;n<e;n++)i+="&args[]="+encodeURIComponent(arguments[n+1]);r(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",i)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function b(t,e,i){this.props=t,this.context=e,this.refs=o,this.updater=i||m}function x(){}function E(t,e,i){this.props=t,this.context=e,this.refs=o,this.updater=i||m}b.prototype.isReactComponent={},b.prototype.setState=function(t,e){"object"!=typeof t&&"function"!=typeof t&&null!=t&&y("85"),this.updater.enqueueSetState(this,t,e,"setState")},b.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},x.prototype=b.prototype;var C=E.prototype=new x;C.constructor=E,n(C,b.prototype),C.isPureReactComponent=!0;var O={current:null},T=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function R(t,e,i){var n=void 0,r={},o=null,s=null;if(null!=e)for(n in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)T.call(e,n)&&!w.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(1===a)r.children=i;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];r.children=c}if(t&&t.defaultProps)for(n in a=t.defaultProps)void 0===r[n]&&(r[n]=a[n]);return{$$typeof:h,type:t,key:o,ref:s,props:r,_owner:O.current}}function I(t){return"object"==typeof t&&null!==t&&t.$$typeof===h}var S=/\/+/g,P=[];function M(t,e,i,n){if(P.length){var r=P.pop();return r.result=t,r.keyPrefix=e,r.func=i,r.context=n,r.count=0,r}return{result:t,keyPrefix:e,func:i,context:n,count:0}}function j(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>P.length&&P.push(t)}function L(t,e,i,n){var r=typeof t;"undefined"!==r&&"boolean"!==r||(t=null);var o=!1;if(null===t)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case h:case c:o=!0}}if(o)return i(n,t,""===e?"."+A(t,0):e),1;if(o=0,e=""===e?".":e+":",Array.isArray(t))for(var s=0;s<t.length;s++){var a=e+A(r=t[s],s);o+=L(r,a,i,n)}else if(null===t||void 0===t?a=null:a="function"==typeof(a=v&&t[v]||t["@@iterator"])?a:null,"function"==typeof a)for(t=a.call(t),s=0;!(r=t.next()).done;)o+=L(r=r.value,a=e+A(r,s++),i,n);else"object"===r&&y("31","[object Object]"===(i=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":i,"");return o}function A(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})}(t.key):e.toString(36)}function F(t,e){t.func.call(t.context,e,t.count++)}function D(t,e,i){var n=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?k(t,n,i,s.thatReturnsArgument):null!=t&&(I(t)&&(e=r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(S,"$&/")+"/")+i,t={$$typeof:h,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}),n.push(t))}function k(t,e,i,n,r){var o="";null!=i&&(o=(""+i).replace(S,"$&/")+"/"),e=M(e,o,n,r),null==t||L(t,"",D,e),j(e)}var N={Children:{map:function(t,e,i){if(null==t)return t;var n=[];return k(t,n,null,e,i),n},forEach:function(t,e,i){if(null==t)return t;e=M(null,null,e,i),null==t||L(t,"",F,e),j(e)},count:function(t){return null==t?0:L(t,"",s.thatReturnsNull,null)},toArray:function(t){var e=[];return k(t,e,null,s.thatReturnsArgument),e},only:function(t){return I(t)||y("143"),t}},createRef:function(){return{current:null}},Component:b,PureComponent:E,createContext:function(t,e){return void 0===e&&(e=null),(t={$$typeof:f,_calculateChangedBits:e,_defaultValue:t,_currentValue:t,_currentValue2:t,_changedBits:0,_changedBits2:0,Provider:null,Consumer:null}).Provider={$$typeof:p,_context:t},t.Consumer=t},forwardRef:function(t){return{$$typeof:g,render:t}},Fragment:l,StrictMode:u,unstable_AsyncMode:_,unstable_Profiler:d,createElement:R,cloneElement:function(t,e,i){(null===t||void 0===t)&&y("267",t);var r=void 0,o=n({},t.props),s=t.key,a=t.ref,c=t._owner;if(null!=e){void 0!==e.ref&&(a=e.ref,c=O.current),void 0!==e.key&&(s=""+e.key);var l=void 0;for(r in t.type&&t.type.defaultProps&&(l=t.type.defaultProps),e)T.call(e,r)&&!w.hasOwnProperty(r)&&(o[r]=void 0===e[r]&&void 0!==l?l[r]:e[r])}if(1===(r=arguments.length-2))o.children=i;else if(1<r){l=Array(r);for(var u=0;u<r;u++)l[u]=arguments[u+2];o.children=l}return{$$typeof:h,type:t.type,key:s,ref:a,props:o,_owner:c}},createFactory:function(t){var e=R.bind(null,t);return e.type=t,e},isValidElement:I,version:"16.4.2",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:O,assign:n}},G={default:N},z=G&&N||G;t.exports=z.default?z.default:z},function(t,e,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,s,a=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),h=1;h<arguments.length;h++){for(var c in i=Object(arguments[h]))r.call(i,c)&&(a[c]=i[c]);if(n){s=n(i);for(var l=0;l<s.length;l++)o.call(i,s[l])&&(a[s[l]]=i[s[l]])}}return a}},function(t,e,i){"use strict";var n=function(t){};t.exports=function(t,e,i,r,o,s,a,h){if(n(e),!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[i,r,o,s,a,h],u=0;(c=new Error(e.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(t,e,i){"use strict";t.exports={}},function(t,e,i){"use strict";function n(t){return function(){return t}}var r=function(){};r.thatReturns=n,r.thatReturnsFalse=n(!1),r.thatReturnsTrue=n(!0),r.thatReturnsNull=n(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(t){return t},t.exports=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(103),r=i(118),o=i(74),s=i(16),a=i(119),h=i(121),c=i(122),l=i(123),u=i(120),d=i(75),p=i(105),f=i(51),_=i(72),g=i(61),v=i(44),y=new u.default({}),m=new c.default({source:y}),b=[new h.default({source:new a.default({layer:"toner-background"})}),m],x=new d.default({center:s.fromLonLat([0,50]),zoom:4});e.default=class{constructor(t){this.features={},this.handleClick=(t=>{var e=this.map.getFeaturesAtPixel(t.pixel);null!=e&&this.popup.show(e)});const e=new l.default({autoPan:!0,autoPanAnimation:{duration:250,source:null}});this.popup=new p.default(e),e.setElement(this.popup.el);const i=[e];this.map=new r.default({target:t.target,layers:b,overlays:i,view:x}),this.map.on("click",this.handleClick)}createImageStyle(t){return new _.default({radius:6,stroke:new v.default({color:"black"}),fill:new g.default({color:t})})}createFeature(t,e,i){const r=JSON.parse(e.f1),a=new n.default({geometry:new o.default(s.transform(r.coordinates,"EPSG:4326","EPSG:3857")),coordinates:r,date:e.f2,end_date:e.f3,event:t});return a.setId(i),a.setStyle(new f.default({image:this.createImageStyle(t.color)})),a}updateFeatures(t){this.popup.hide();const e=t.reduce((t,e)=>{if(null==e.locations)return t;const i=e.locations.map((t,i)=>{const n=`${e.id}-${i}`;return this.features.hasOwnProperty(n)?this.features[n].getStyle().setImage(this.createImageStyle(e.color)):this.features[n]=this.createFeature(e,t,n),this.features[n]});return t.concat(...i)},[]);y.clear(),y.addFeatures(e)}onSelect(t){const e=y.getFeatures().find(e=>e.getProperties().event.id===t.id);e&&this.popup.show([e])}setVisibleEvents(t,e){this.updateFeatures(t)}updateSize(){this.map.updateSize()}}},function(t,e,i){"use strict";i.r(e),i.d(e,"createStyleFunction",function(){return l});var n=i(11),r=i(2),o=i(4),s=i(12),a=i(67),h=i(51),c=function(t){function e(e){if(t.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,Object(r.a)(this,Object(s.b)(this.geometryName_),this.handleGeometryChanged_,this),void 0!==e)if(e instanceof a.a||!e){var i=e;this.setGeometry(i)}else{var n=e;this.setProperties(n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Object(r.e)(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Object(r.a)(t,o.a.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?l(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){Object(r.c)(this,Object(s.b)(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,Object(r.a)(this,Object(s.b)(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},e}(s.a);function l(t){return"function"==typeof t?t:(Array.isArray(t)?e=t:(Object(n.a)(t instanceof h.default,41),e=[t]),function(){return e});var e}e.default=c},function(t,e,i){t.exports=function(){"use strict";function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}return function(i,n,r,o,s){!function e(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,h=n-r+1,c=Math.log(a),l=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*l*(a-l)/a)*(h-a/2<0?-1:1),d=Math.max(r,Math.floor(n-h*l/a+u)),p=Math.min(o,Math.floor(n+(a-h)*l/a+u));e(i,n,d,p,s)}var f=i[n],_=r,g=o;for(t(i,r,n),s(i[o],f)>0&&t(i,r,o);_<g;){for(t(i,_,g),_++,g--;s(i[_],f)<0;)_++;for(;s(i[g],f)>0;)g--}0===s(i[r],f)?t(i,r,g):t(i,++g,o),g<=n&&(r=g+1),n<=g&&(o=g-1)}}(i,n,r||0,o||i.length-1,s||e)}}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(76),r=i(106),o=i(77);e.default=class{constructor(t){this.overlay=t,this.syncing=!1,this.handleClick=(t=>n.__awaiter(this,void 0,void 0,function*(){if(this.syncing)return;const e=t.target;if(e.matches("[data-id] *")){const t=e.closest("[data-id]"),i=this.currentFeatures.find(e=>e.getId()===t.dataset.id);null!=i&&this.show([i])}else if(e.matches(".sync")){this.syncing=!0;const t=yield(yield fetch(`/api/events/${e.dataset.wikidataId}`,{method:"POST"})).json();if(this.currentFeatures.length>1)return void console.error("Sync can only occur when there is one current feature");this.currentFeatures[0].setProperties({event:t}),this.show(this.currentFeatures),this.syncing=!1}})),this.featureListItem=(t=>{const{event:e}=t.getProperties();return`<li data-id="${t.getId()}">\n\t\t\t<div>${e.label}</div>\n\t\t\t<div>${this.formatFrom(e)}</div>\n\t\t\t<div>${this.formatTo(e)}</div>\n\t\t</li>`}),this.el=document.createElement("div"),this.el.classList.add(`${r.CLASS_PREFIX}popup`),this.closeButton=document.createElement("a"),this.closeButton.textContent="✖",this.closeButton.addEventListener("click",()=>{null!=this.overlay&&this.overlay.setPosition(void 0)}),this.el.appendChild(this.closeButton),this.content=document.createElement("div"),this.content.addEventListener("click",this.handleClick),this.el.appendChild(this.content)}hide(){this.currentFeatures=null,this.overlay.setPosition(void 0)}show(t){if(this.currentFeatures=t,null==this.overlay)return console.error("[Popup.show] No overlay");1===t.length?this.content.innerHTML=this.singleFeatureTemplate(t[0]):this.content.innerHTML=this.multipleFeaturesTemplate(t),this.overlay.setPosition(t[0].getGeometry().getCoordinates())}multipleFeaturesTemplate(t){return`<h3 style="font-size: 1.5em">Multiple events</h3>\n\t\t\t<ul>\n\t\t\t\t${t.map(this.featureListItem).join("")}\n\t\t\t</ul>\n\t\t\t`.replace(/\>(\\n|\s+)\</g,"><")}formatFrom(t){const e=o.formatDate(t.date,t.date_granularity);return null!=t.date_min?`${o.formatDate(t.date_min,t.date_min_granularity)} ~ ${e}`:e}formatTo(t){return null!=t.end_date_max?`${o.formatDate(t.end_date,t.end_date_granularity)} ~ ${o.formatDate(t.end_date_max,t.end_date_max_granularity)}`:null!=t.end_date?o.formatDate(t.end_date,t.end_date_granularity):""}singleFeatureTemplate(t){const e=t.getProperties(),{event:i}=e,n=null!=i.description?`<div class="description">${i.description}</div>`:"",r=this.formatFrom(i),o=this.formatTo(i);return`<h3 style="font-size: 1.5em">${i.label}</h3>\n\t\t\t${n}\n\t\t\t<h4 style="margin-bottom: 0">${""===o?"Date":"From"}</h4>\n\t\t\t${r}\n\t\t\t${""!==o?'<h4 style="margin-bottom: 0">To</h4>':""}\n\t\t\t${o}\n\t\t\t<div class="wikidata-id">\n\t\t\t\t<a href="https://www.wikidata.org/wiki/${i.wikidata_identifier}">\n\t\t\t\t\tEdit on Wikidata\n\t\t\t\t</a>\n\t\t\t\t&nbsp;&nbsp;\n\t\t\t\t<span style="text-decoration: underline; cursor: pointer;" class="sync" data-wikidata-id="${i.wikidata_identifier}">\n\t\t\t\t\tSync with Wikidata\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t`.replace(/\>(\\n|\s+)\</g,"><")}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CLASS_PREFIX="clm-"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(57),r=i(41),o=i(40);e.default=class{constructor(t){this.onChange=t,this.animator=n.default,this.handleChange=(()=>{this.onChange(o.default)}),this.resize=(()=>{o.default.resize();for(const t of o.default.bands)t.resize();for(const t of this.views)t.resize();this.animator.nextFrame()}),document.addEventListener("keydown",t=>{189===t.keyCode&&o.default.eventsBands[0].zoomOut(),187===t.keyCode&&o.default.eventsBands[0].zoomIn()}),null!=this.onChange&&"function"==typeof this.onChange&&(document.addEventListener(r.CENTER_CHANGE_DONE,this.handleChange),document.addEventListener(r.ZOOM_DONE,this.handleChange))}reload(){this.resize()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(81),r=i(82),o=i(56);e.default=class extends n.default{constructor(t,e){super(t),this.band=t,this.select=e,this.onWheel=(t=>{0===Math.abs(t.deltaX)&&0!==t.deltaY&&(t.deltaY<0&&this.zoomOut(),t.deltaY>0&&this.zoomIn())}),this.onClick=(t=>{if(this.lastDragInterval>175)return;const e=this.band.getEventByCoordinates(t.clientX,t.clientY);e&&this.select&&(this.select(e),o.logEvent(e))})}render(){const t=super.render();return r.default.register("click",this.onClick,this.rootElement),r.default.register("wheel",this.onWheel,this.rootElement),t}zoomIn(){this.band.zoomIn()}zoomOut(){this.band.zoomOut()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(58),r=i(40),o=i(41),s=i(57),a=i(64),h=i(110);e.default=class{constructor(){this.indicatorsDrawn=!1,this.update=(()=>{r.default.bands.forEach(t=>{t instanceof a.default?this.drawEventsBand(t):this.drawMinimapBand(t)}),this.drawIndicators()}),s.default.registerView(this)}render(){return this.canvas=n.default("canvas","main",["position: absolute"]),this.canvas.width=r.default.viewportWidth,this.canvas.height=r.default.viewportHeight,this.ctx=this.canvas.getContext("2d"),this.indicatorsCanvas=n.default("canvas","indicators",["position: absolute"],["z-index: 1"]),this.indicatorsCanvas.width=r.default.viewportWidth,this.indicatorsCanvas.height=r.default.viewportHeight,this.indicatorsCtx=this.indicatorsCanvas.getContext("2d"),this.update(),[this.canvas,this.indicatorsCanvas]}resize(){this.indicatorsCanvas.width=r.default.viewportWidth,this.indicatorsCanvas.height=r.default.viewportHeight,this.canvas.width=r.default.viewportWidth,this.canvas.height=r.default.viewportHeight,this.indicatorsDrawn=!1}clear(t){this.ctx.clearRect(0,t.top,this.canvas.width,t.visibleHeight)}drawEventsBand(t){this.clear(t),h.default(this.ctx,t);for(const e of t.visibleEvents)e.time?(this.ctx.fillStyle=e.color,this.ctx.fillRect(e.left,e.top,e.width,o.EVENT_HEIGHT)):(this.ctx.moveTo(e.left,e.top+o.EVENT_HEIGHT/2),this.ctx.beginPath(),this.ctx.arc(e.left,e.top+o.EVENT_HEIGHT/2,o.EVENT_HEIGHT/3,0,2*Math.PI),this.ctx.fillStyle=e.color,this.ctx.fill());this.drawEventsText(t)}drawEventsText(t){this.ctx.font="11px sans-serif",this.ctx.fillStyle="rgb(40, 40, 40)";for(const e of t.visibleEvents){let t=0===e.time?e.padding:e.width,i=e.left;if(e.left<0&&0!==e.time&&(t=e.width+e.left,i=0),e.label.length*o.PIXELS_PER_LETTER<=t){const t=e.time?3:8;this.ctx.fillText(e.label,i+t,e.top+o.EVENT_HEIGHT-3)}}}drawMinimapBand(t){if(t.isDrawn&&t.prevOffsetX===t.offsetX&&t.prevZoomLevel===t.zoomLevel)return;this.clear(t),h.default(this.ctx,t);const e=t.draw();this.ctx.drawImage(e,0,t.top,r.default.viewportWidth,t.availableHeight),t.isDrawn=!0}drawIndicators(){if(!this.indicatorsDrawn||!r.default.eventsBands.every(t=>t.prevZoomLevel===t.zoomLevel)){this.indicatorsCtx.clearRect(0,0,r.default.viewportWidth,r.default.viewportHeight),this.indicatorsCtx.beginPath();for(const t of r.default.minimapBands){const e=r.default.eventsBands[t.config.indicatorFor],i=Math.round(t.config.topOffsetRatio*r.default.viewportHeight),n=t.positionAtTimestamp(e.from);this.indicatorsCtx.rect(0,i,n,t.visibleHeight);const s=t.positionAtTimestamp(e.to);this.indicatorsCtx.rect(s,i,r.default.viewportWidth,t.visibleHeight),this.indicatorsCtx.rect(n,i+t.visibleHeight-o.DATE_BAR_HEIGHT,s-n,o.DATE_BAR_HEIGHT)}this.indicatorsCtx.fillStyle="rgba(0, 0, 0, .04)",this.indicatorsCtx.fill(),this.indicatorsCtx.closePath(),this.indicatorsDrawn=!0}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(40),r=i(63),o="11px sans-serif",s="13px sans-serif";function a(t,e){return"CENTURY"===e.granularity&&new Date(t).getUTCFullYear()%1e3==0||("YEAR_5"===e.granularity&&new Date(t).getUTCFullYear()%50==0||"YEAR"===e.granularity&&new Date(t).getUTCFullYear()%5==0)}function h(t,e,i,n,o){const s=e.positionAtTimestamp(i);t.moveTo(s,n),t.lineTo(s,o),e.config.rulerLabels&&t.fillText(r.labelBody(i,e.granularity),s+3,o-3)}e.default=function(t,e){if(!e.config.rulers)return;let i=e.nextDate(e.from);const r=e.config.topOffsetRatio*n.default.viewportHeight,c=e.config.heightRatio*n.default.viewportHeight,l=[],u=[];for(;i<e.to;)a(i,e)?u.push(i):l.push(i),i=e.nextDate(i);t.beginPath(),t.font=o,t.fillStyle="rgb(205, 205, 205)";for(const i of l)h(t,e,i,r,r+c);t.strokeStyle="rgb(235, 235, 235)",t.stroke(),t.beginPath(),t.font=s,t.fillStyle="rgb(120, 120, 120)";for(const i of u)h(t,e,i,r,r+c);t.strokeStyle="rgb(150, 150, 150)",t.stroke()}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(58);e.default=class{constructor(t){this.band=t}render(){const t=n.default("div","events-label-wrapper",["border-top: 1px solid #CCC","pointer-events: none","position: absolute","width: 100%","z-index: 3"],[`top: ${100*this.band.config.topOffsetRatio}%`]),e=n.default("div","events-label",["background: white","border-bottom-right-radius: 4px","box-shadow: 1px 2px 4px #AAA","color: #444","display: inline-block","font-family: sans-serif","font-size: .8em","padding: 4px 8px"]);return e.innerText=this.band.config.label,t.appendChild(e),t}resize(){}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.RawEv3nt=class{constructor(){this.date_granularity="DAY"}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(65),r=i(83),o=i(117),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],a=r.default("div")`
	background: rgb(0, 0, 0);
	border-bottom: 2px solid ${o.gray(.25)};
	border-top: 2px solid ${o.gray(.25)};
	display: grid;
	grid-template-columns: 30% 40% 30%;
`,h=r.default("select")`
	background: none;
	border-radius: 4px;
	border: 2px solid ${o.gray(.25)};
	color: white;
	height: 24px;
	outline: none;

	& option {
		color: #444;
	}
`,c=r.default("div")`
	align-items: center;
	display: grid;
	grid-gap: 1em;
	padding: 0 1em;
`,l=r.default(c)`
	grid-template-columns: 24px 24px 24px 72px;
`,u=r.default(c)`
	justify-content: center;
	grid-template-columns: 24px 24px 72px;
`,d=r.default(c)`
	justify-content: right;
	grid-template-columns: auto auto auto;
`;e.default=class extends n.PureComponent{constructor(){super(...arguments),this.playBackward=(()=>{this.props.timeline.animator.playBackward()}),this.playForward=(()=>{this.props.timeline.animator.playForward()})}render(){return null==this.props.timeline?n.createElement(a,null):n.createElement(a,null,n.createElement(l,null,n.createElement(o.default,{onClick:this.playBackward},"◂"),n.createElement(o.default,{onClick:()=>this.props.timeline.animator.stop()},"II"),n.createElement(o.default,{onClick:this.playForward},"▸"),n.createElement(h,{defaultValue:"1",onChange:t=>this.props.timeline.animator.speed(t.target.value)},this.props.timeline.animator.multipliers.map(t=>n.createElement("option",{key:t,value:t},`${t}x`)))),n.createElement(u,null,n.createElement(o.default,{onClick:this.props.zoomIn},"+"),n.createElement(o.default,{onClick:this.props.zoomOut},"-"),n.createElement(h,{onChange:t=>this.props.timeline.animator.zoomTo(this.props.controlBand,parseInt(t.target.value,10)),value:this.props.zoomLevel.toString()},s.map(t=>n.createElement("option",{key:t,value:t},`lvl ${t}`)))),n.createElement(d,null,n.createElement(o.default,{onClick:this.props.showBoth},"m/t"),n.createElement(o.default,{onClick:this.props.showMap},"M"),n.createElement(o.default,{onClick:this.props.showTimeline},"T")))}}},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";var n=i(116);function r(){}t.exports=function(){function t(t,e,i,r,o,s){if(s!==n){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var i={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return i.checkPropTypes=r,i.PropTypes=i,i}},function(t,e,i){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(83);function r(t){const e=255*t;return`rgb(${e}, ${e}, ${e})`}e.gray=r,e.default=n.default("button")`
	background: none;
	border-radius: 4px;
	border: 2px solid ${r(.25)};
	color: white;
	cursor: pointer;
	height: 24px; 
	outline: none;
`},function(t,e,i){"use strict";i.r(e);var n=i(3),r=i(22),o=i(24),s=i(17),a=function(t){function e(e,i,n){t.call(this,e),this.map=i,this.frameState=void 0!==n?n:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(s.a),h=function(t){function e(e,i,n,r,o){t.call(this,e,i,o),this.originalEvent=n,this.pixel=i.getEventPixel(n),this.coordinate=i.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(a),c=i(19),l=i(4),u={SINGLECLICK:"singleclick",CLICK:l.a.CLICK,DBLCLICK:l.a.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},d=function(t){function e(e,i,n,r,o){t.call(this,e,i,n.originalEvent,r,o),this.pointerEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(h),p=i(2),f=i(34),_={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},g=function(t,e){this.dispatcher=t,this.mapping_=e};g.prototype.getEvents=function(){return Object.keys(this.mapping_)},g.prototype.getHandlerForEvent=function(t){return this.mapping_[t]};var v=g,y=1,m="mouse";function b(t){if(!this.isEventSimulatedFromTouch_(t)){y.toString()in this.pointerMap&&this.cancel(t);var e=T(t,this.dispatcher);this.pointerMap[y.toString()]=t,this.dispatcher.down(e,t)}}function x(t){if(!this.isEventSimulatedFromTouch_(t)){var e=T(t,this.dispatcher);this.dispatcher.move(e,t)}}function E(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[y.toString()];if(e&&e.button===t.button){var i=T(t,this.dispatcher);this.dispatcher.up(i,t),this.cleanupMouse()}}}function C(t){if(!this.isEventSimulatedFromTouch_(t)){var e=T(t,this.dispatcher);this.dispatcher.enterOver(e,t)}}function O(t){if(!this.isEventSimulatedFromTouch_(t)){var e=T(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}}function T(t,e){var i=e.cloneEvent(t,t),n=i.preventDefault;return i.preventDefault=function(){t.preventDefault(),n()},i.pointerId=y,i.isPrimary=!0,i.pointerType=m,i}var w=function(t){function e(e){var i={mousedown:b,mousemove:x,mouseup:E,mouseover:C,mouseout:O};t.call(this,e,i),this.pointerMap=e.pointerMap,this.lastTouches=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isEventSimulatedFromTouch_=function(t){for(var e=this.lastTouches,i=t.clientX,n=t.clientY,r=0,o=e.length,s=void 0;r<o&&(s=e[r]);r++){var a=Math.abs(i-s[0]),h=Math.abs(n-s[1]);if(a<=25&&h<=25)return!0}return!1},e.prototype.cancel=function(t){var e=T(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},e.prototype.cleanupMouse=function(){delete this.pointerMap[y.toString()]},e}(v),R=["","unavailable","touch","pen","mouse"];function I(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)}function S(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)}function P(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)}function M(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)}function j(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)}function L(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)}function A(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)}function F(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)}var D=function(t){function e(e){var i={MSPointerDown:I,MSPointerMove:S,MSPointerUp:P,MSPointerOut:M,MSPointerOver:j,MSPointerCancel:L,MSGotPointerCapture:F,MSLostPointerCapture:A};t.call(this,e,i),this.pointerMap=e.pointerMap}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=R[t.pointerType]),e},e.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},e}(v);function k(t){this.dispatcher.fireNativeEvent(t)}function N(t){this.dispatcher.fireNativeEvent(t)}function G(t){this.dispatcher.fireNativeEvent(t)}function z(t){this.dispatcher.fireNativeEvent(t)}function U(t){this.dispatcher.fireNativeEvent(t)}function B(t){this.dispatcher.fireNativeEvent(t)}function Y(t){this.dispatcher.fireNativeEvent(t)}function W(t){this.dispatcher.fireNativeEvent(t)}var H=function(t){function e(e){var i={pointerdown:k,pointermove:N,pointerup:G,pointerout:z,pointerover:U,pointercancel:B,gotpointercapture:W,lostpointercapture:Y};t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(v),V=!1,X=function(t){function e(e,i,n){t.call(this,e),this.originalEvent=i;var r=n||{};this.buttons=this.getButtons_(r),this.pressure=this.getPressure_(r,this.buttons),this.bubbles="bubbles"in r&&r.bubbles,this.cancelable="cancelable"in r&&r.cancelable,this.view="view"in r?r.view:null,this.detail="detail"in r?r.detail:null,this.screenX="screenX"in r?r.screenX:0,this.screenY="screenY"in r?r.screenY:0,this.clientX="clientX"in r?r.clientX:0,this.clientY="clientY"in r?r.clientY:0,this.ctrlKey="ctrlKey"in r&&r.ctrlKey,this.altKey="altKey"in r&&r.altKey,this.shiftKey="shiftKey"in r&&r.shiftKey,this.metaKey="metaKey"in r&&r.metaKey,this.button="button"in r?r.button:0,this.relatedTarget="relatedTarget"in r?r.relatedTarget:null,this.pointerId="pointerId"in r?r.pointerId:0,this.width="width"in r?r.width:0,this.height="height"in r?r.height:0,this.tiltX="tiltX"in r?r.tiltX:0,this.tiltY="tiltY"in r?r.tiltY:0,this.pointerType="pointerType"in r?r.pointerType:"",this.hwTimestamp="hwTimestamp"in r?r.hwTimestamp:0,this.isPrimary="isPrimary"in r&&r.isPrimary,i.preventDefault&&(this.preventDefault=function(){i.preventDefault()})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getButtons_=function(t){var e;if(t.buttons||V)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e},e.prototype.getPressure_=function(t,e){return t.pressure?t.pressure:e?.5:0},e}(s.a);!function(){try{var t=new MouseEvent("click",{buttons:1});V=1===t.buttons}catch(t){}}();var K=X,Z=i(13);function q(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)}function $(t){t.preventDefault(),this.processTouches_(t,this.moveOverOut_)}function J(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)}function Q(t){this.processTouches_(t,this.cancelOut_)}var tt=function(t){function e(e,i){var n={touchstart:q,touchmove:$,touchend:J,touchcancel:Q};t.call(this,e,n),this.pointerMap=e.pointerMap,this.mouseSource=i,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0,this.dedupTimeout_=2500}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},e.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&y.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},e.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},e.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},e.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},e.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},e.prototype.touchToPointer_=function(t,e){var i=this.dispatcher.cloneEvent(t,e);return i.pointerId=e.identifier+2,i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount_,i.button=0,i.buttons=1,i.width=e.webkitRadiusX||e.radiusX||0,i.height=e.webkitRadiusY||e.radiusY||0,i.pressure=e.webkitForce||e.force||.5,i.isPrimary=this.isPrimaryTouch_(e),i.pointerType="touch",i.clientX=e.clientX,i.clientY=e.clientY,i.screenX=e.screenX,i.screenY=e.screenY,i},e.prototype.processTouches_=function(t,e){var i=Array.prototype.slice.call(t.changedTouches),n=i.length;function r(){t.preventDefault()}for(var o=0;o<n;++o){var s=this.touchToPointer_(t,i[o]);s.preventDefault=r,e.call(this,t,s)}},e.prototype.findTouch_=function(t,e){for(var i=t.length,n=0;n<i;n++){if(t[n].identifier===e)return!0}return!1},e.prototype.vacuumTouches_=function(t){var e=t.touches,i=Object.keys(this.pointerMap),n=i.length;if(n>=e.length){for(var r=[],o=0;o<n;++o){var s=i[o],a=this.pointerMap[s];s==y||this.findTouch_(e,s-2)||r.push(a.out)}for(var h=0;h<r.length;++h)this.cancelOut_(t,r[h])}},e.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},e.prototype.moveOverOut_=function(t,e){var i=e,n=this.pointerMap[i.pointerId];if(n){var r=n.out,o=n.outTarget;this.dispatcher.move(i,t),r&&o!==i.target&&(r.relatedTarget=i.target,i.relatedTarget=o,r.target=o,i.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(i,t)):(i.target=o,i.relatedTarget=null,this.cancelOut_(t,i))),n.out=i,n.outTarget=i.target}},e.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},e.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){var n=[i.clientX,i.clientY];e.push(n),setTimeout(function(){Object(Z.g)(e,n)},this.dedupTimeout_)}},e}(v),et=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]],it=function(t){function e(e){t.call(this),this.element_=e,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.registerSources=function(){if(c.f)this.registerSource("native",new H(this));else if(c.e)this.registerSource("ms",new D(this));else{var t=new w(this);this.registerSource("mouse",t),c.h&&this.registerSource("touch",new tt(this,t))}this.register_()},e.prototype.registerSource=function(t,e){var i=e,n=i.getEvents();n&&(n.forEach(function(t){var e=i.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(i))}.bind(this)),this.eventSourceList_.push(i))},e.prototype.register_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.addEvents_(i.getEvents())}},e.prototype.unregister_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.removeEvents_(i.getEvents())}},e.prototype.eventHandler_=function(t){var e=t.type,i=this.eventMap_[e];i&&i(t)},e.prototype.addEvents_=function(t){t.forEach(function(t){Object(p.a)(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.removeEvents_=function(t){t.forEach(function(t){Object(p.c)(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.cloneEvent=function(t,e){for(var i={},n=0,r=et.length;n<r;n++){var o=et[n][0];i[o]=t[o]||e[o]||et[n][1]}return i},e.prototype.down=function(t,e){this.fireEvent(_.POINTERDOWN,t,e)},e.prototype.move=function(t,e){this.fireEvent(_.POINTERMOVE,t,e)},e.prototype.up=function(t,e){this.fireEvent(_.POINTERUP,t,e)},e.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(_.POINTERENTER,t,e)},e.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(_.POINTERLEAVE,t,e)},e.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(_.POINTEROVER,t,e)},e.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(_.POINTEROUT,t,e)},e.prototype.cancel=function(t,e){this.fireEvent(_.POINTERCANCEL,t,e)},e.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},e.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},e.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},e.prototype.makeEvent=function(t,e,i){return new K(t,i,e)},e.prototype.fireEvent=function(t,e,i){var n=this.makeEvent(t,e,i);this.dispatchEvent(n)},e.prototype.fireNativeEvent=function(t){var e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},e.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,w.prepareEvent(e,this),e)},e.prototype.disposeInternal=function(){this.unregister_(),t.prototype.disposeInternal.call(this)},e}(f.a),nt=function(t){function e(e,i){t.call(this),this.map_=e,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*c.b:c.b,this.down_=null;var n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new it(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=Object(p.a)(this.pointerEventHandler_,_.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=Object(p.a)(this.pointerEventHandler_,_.POINTERMOVE,this.relayEvent_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emulateClick_=function(t){var e=new d(u.CLICK,this.map_,t);this.dispatchEvent(e),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,e=new d(u.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var e=new d(u.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==u.POINTERUP||e.type==u.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==u.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new d(u.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(p.e),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new d(u.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new it(document),this.dragListenerKeys_.push(Object(p.a)(this.documentPointerEventHandler_,u.POINTERMOVE,this.handlePointerMove_,this),Object(p.a)(this.documentPointerEventHandler_,u.POINTERUP,this.handlePointerUp_,this),Object(p.a)(this.pointerEventHandler_,u.POINTERCANCEL,this.handlePointerUp_,this)))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new d(u.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},e.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new d(t.type,this.map_,t,e))},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Object(p.e)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(Object(p.e)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(p.e),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),t.prototype.disposeInternal.call(this)},e}(f.a),rt=i(45),ot={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},st=i(12),at=i(36),ht=i(8),ct=i(11),lt=i(10),ut=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}};ut.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Object(lt.b)(this.queuedElements_)},ut.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},ut.prototype.enqueue=function(t){Object(ct.a)(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},ut.prototype.getCount=function(){return this.elements_.length},ut.prototype.getLeftChildIndex_=function(t){return 2*t+1},ut.prototype.getRightChildIndex_=function(t){return 2*t+2},ut.prototype.getParentIndex_=function(t){return t-1>>1},ut.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},ut.prototype.isEmpty=function(){return 0===this.elements_.length},ut.prototype.isKeyQueued=function(t){return t in this.queuedElements_},ut.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},ut.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),c=h<n&&i[h]<i[a]?h:a;e[t]=e[c],i[t]=i[c],t=c}e[t]=r,i[t]=o,this.siftDown_(s,t)},ut.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],o=n[e];e>t;){var s=this.getParentIndex_(e);if(!(n[s]>o))break;i[e]=i[s],n[e]=n[s],e=s}i[e]=r,n[e]=o},ut.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,r=this.elements_,o=this.priorities_,s=0,a=r.length;for(e=0;e<a;++e)(i=n(t=r[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(o[s]=i,r[s++]=t);r.length=s,o.length=s,this.heapify_()};var dt=ut,pt=function(t){function e(e,i){t.call(this,function(t){return e.apply(null,t)},function(t){return t[0].getKey()}),this.tileChangeCallback_=i,this.tilesLoading_=0,this.tilesLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);if(i){var n=e[0];Object(p.a)(n,l.a.CHANGE,this.handleTileChange,this)}return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(i===ht.a.LOADED||i===ht.a.ERROR||i===ht.a.EMPTY||i===ht.a.ABORT){Object(p.c)(e,l.a.CHANGE,this.handleTileChange,this);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,n,r,o=0,s=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)r=(n=this.dequeue()[0]).getKey(),(i=n.getState())===ht.a.ABORT?s=!0:i!==ht.a.IDLE||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,n.load());0===o&&s&&this.tileChangeCallback_()},e}(dt),ft=i(75),_t=i(14),gt=i(15),vt=i(1),yt=i(9),mt=i(69),bt=i(32),xt={LAYERS:"layers"},Et=function(t){function e(e){var i=e||{},n=Object(lt.a)({},i);delete n.layers;var o=i.layers;t.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},Object(p.a)(this,Object(st.b)(xt.LAYERS),this.handleLayersChanged_,this),o?Array.isArray(o)?o=new r.a(o.slice(),{unique:!0}):(Object(ct.a)(o instanceof r.a,43),o=o):o=new r.a(void 0,{unique:!0}),this.setLayers(o)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(p.e),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(Object(p.a)(t,o.a.ADD,this.handleLayersAdd_,this),Object(p.a)(t,o.a.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(p.e);Object(lt.b)(this.listenerKeys_);for(var i=t.getArray(),r=0,s=i.length;r<s;r++){var a=i[r];this.listenerKeys_[Object(n.b)(a).toString()]=[Object(p.a)(a,at.a.PROPERTYCHANGE,this.handleLayerChange_,this),Object(p.a)(a,l.a.CHANGE,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element,i=Object(n.b)(e).toString();this.listenerKeys_[i]=[Object(p.a)(e,at.a.PROPERTYCHANGE,this.handleLayerChange_,this),Object(p.a)(e,l.a.CHANGE,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=t.element,i=Object(n.b)(e).toString();this.listenerKeys_[i].forEach(p.e),delete this.listenerKeys_[i],this.changed()},e.prototype.getLayers=function(){return this.get(xt.LAYERS)},e.prototype.setLayers=function(t){this.set(xt.LAYERS,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(e)}),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});for(var n=this.getLayerState(),r=i,o=e.length;r<o;r++){var s=e[r];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==s.extent?s.extent=Object(vt.A)(s.extent,n.extent):s.extent=n.extent)}return e},e.prototype.getSourceState=function(){return bt.a.READY},e}(mt.a),Ct=i(27),Ot=i(6);var Tt=function(t){function e(e){t.call(this);var i=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,o,s={},a=t.layers instanceof Et?t.layers:new Et({layers:t.layers});s[ot.LAYERGROUP]=a,s[ot.TARGET]=t.target,s[ot.VIEW]=void 0!==t.view?t.view:new ft.default,void 0!==t.controls&&(Array.isArray(t.controls)?i=new r.a(t.controls.slice()):(Object(ct.a)(t.controls instanceof r.a,47),i=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new r.a(t.interactions.slice()):(Object(ct.a)(t.interactions instanceof r.a,48),n=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?o=new r.a(t.overlays.slice()):(Object(ct.a)(t.overlays instanceof r.a,49),o=t.overlays):o=new r.a;return{controls:i,interactions:n,keyboardEventTarget:e,overlays:o,values:s}}(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:c.b,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=Object(Ot.c)(),this.pixelToCoordinateTransform_=Object(Ot.c)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("DIV"),this.viewport_.className="ol-viewport"+(c.h?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("DIV"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("DIV"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var n=[l.a.CLICK,l.a.DBLCLICK,l.a.MOUSEDOWN,l.a.TOUCHSTART,l.a.MSPOINTERDOWN,u.POINTERDOWN,l.a.MOUSEWHEEL,l.a.WHEEL],a=0,h=n.length;a<h;++a)Object(p.a)(this.overlayContainerStopEvent_,n[a],s.b);for(var d in this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new nt(this,e.moveTolerance),u)Object(p.a)(this.mapBrowserEventHandler_,u[d],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=i.keyboardEventTarget,this.keyHandlerKeys_=null,Object(p.a)(this.viewport_,l.a.CONTEXTMENU,this.handleBrowserEvent,this),Object(p.a)(this.viewport_,l.a.WHEEL,this.handleBrowserEvent,this),Object(p.a)(this.viewport_,l.a.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=i.controls||new r.a,this.interactions=i.interactions||new r.a,this.overlays_=i.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new pt(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},Object(p.a)(this,Object(st.b)(ot.LAYERGROUP),this.handleLayerGroupChanged_,this),Object(p.a)(this,Object(st.b)(ot.VIEW),this.handleViewChanged_,this),Object(p.a)(this,Object(st.b)(ot.SIZE),this.handleSizeChanged_,this),Object(p.a)(this,Object(st.b)(ot.TARGET),this.handleTargetChanged_,this),this.setProperties(i.values),this.controls.forEach(function(t){t.setMap(this)}.bind(this)),Object(p.a)(this.controls,o.a.ADD,function(t){t.element.setMap(this)},this),Object(p.a)(this.controls,o.a.REMOVE,function(t){t.element.setMap(null)},this),this.interactions.forEach(function(t){t.setMap(this)}.bind(this)),Object(p.a)(this.interactions,o.a.ADD,function(t){t.element.setMap(this)},this),Object(p.a)(this.interactions,o.a.REMOVE,function(t){t.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),Object(p.a)(this.overlays_,o.a.ADD,function(t){this.addOverlayInternal_(t.element)},this),Object(p.a)(this.overlays_,o.a.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)},this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),Object(p.c)(this.viewport_,l.a.CONTEXTMENU,this.handleBrowserEvent,this),Object(p.c)(this.viewport_,l.a.WHEEL,this.handleBrowserEvent,this),Object(p.c)(this.viewport_,l.a.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(l.a.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var n=this.getCoordinateFromPixel(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==i.layerFilter?i.layerFilter:yt.b;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,e,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=null;return this.forEachFeatureAtPixel(t,function(t){i||(i=[]),i.push(t)},e),i},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var n=i||{},r=void 0!==n.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=n.layerFilter||yt.b;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,null,o,null)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixel(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:yt.b,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,n,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i=t.changedTouches?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(ot.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){var e=this.frameState_;return e?Object(Ot.a)(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(ot.LAYERGROUP)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getPixelFromCoordinate=function(t){var e=this.frameState_;return e?Object(Ot.a)(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(ot.SIZE)},e.prototype.getView=function(){return this.get(ot.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getTilePriority=function(t,e,i,n){var r=this.frameState_;if(!(r&&e in r.wantedTiles))return 1/0;if(!r.wantedTiles[e][t.getKey()])return 1/0;var o=i[0]-r.focus[0],s=i[1]-r.focus[1];return 65536*Math.log(n)+Math.sqrt(o*o+s*s)/n},e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,n=new h(i,this,t);this.handleMapBrowserEvent(n)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){this.focus_=t.coordinate,t.frameState=this.frameState_;var e=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.getActive())if(!n.handleEvent(t))break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,n=i;if(t){var r=t.viewHints;r[_t.a.ANIMATING]&&(i=this.loadTilesWhileAnimating_?8:0,n=2),r[_t.a.INTERACTING]&&(i=this.loadTilesWhileInteracting_?8:0,n=2)}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}for(var o=this.postRenderFunctions_,s=0,a=o.length;s<a;++s)o[s](this,t);o.length=0},e.prototype.handleSizeChanged_=function(){this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,i=this.keyHandlerKeys_.length;e<i;++e)Object(p.e)(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_);var n=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[Object(p.a)(n,l.a.KEYDOWN,this.handleBrowserEvent,this),Object(p.a)(n,l.a.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(l.a.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),Object(gt.e)(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(l.a.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Object(p.e)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Object(p.e)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",Object(n.b)(t)),this.viewPropertyListenerKey_=Object(p.a)(t,at.a.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Object(p.a)(t,l.a.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(p.e),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[Object(p.a)(t,at.a.PROPERTYCHANGE,this.render,this),Object(p.a)(t,l.a.CHANGE,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e,i=this.getSize(),r=this.getView(),o=Object(vt.i)(),s=this.frameState_,h=null;if(void 0!==i&&Object(Ct.a)(i)&&r&&r.isDef()){for(var c=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),u={},d=0,p=l.length;d<p;++d)u[Object(n.b)(l[d].layer)]=l[d];e=r.getState();var f=this.focus_;if(!f){f=e.center;var _=e.resolution/this.pixelRatio_;f[0]=Math.round(f[0]/_)*_,f[1]=Math.round(f[1]/_)*_}h={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:o,focus:f,index:this.frameIndex_++,layerStates:u,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:e,viewHints:c,wantedTiles:{}}}if(h&&(h.extent=Object(vt.y)(e.center,e.resolution,e.rotation,h.size,o)),this.frameState_=h,this.renderer_.renderFrame(h),h){if(h.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,h.postRenderFunctions),s)(!this.previousExtent_||!Object(vt.G)(this.previousExtent_)&&!Object(vt.o)(h.extent,this.previousExtent_))&&(this.dispatchEvent(new a(rt.a.MOVESTART,this,s)),this.previousExtent_=Object(vt.k)(this.previousExtent_));this.previousExtent_&&!h.viewHints[_t.a.ANIMATING]&&!h.viewHints[_t.a.INTERACTING]&&!Object(vt.o)(h.extent,this.previousExtent_)&&(this.dispatchEvent(new a(rt.a.MOVEEND,this,h)),Object(vt.d)(h.extent,this.previousExtent_))}this.dispatchEvent(new a(rt.a.POSTRENDER,this,h)),setTimeout(this.handlePostRender.bind(this),0)},e.prototype.setLayerGroup=function(t){this.set(ot.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(ot.SIZE,t)},e.prototype.setTarget=function(t){this.set(ot.TARGET,t)},e.prototype.setView=function(t){this.set(ot.VIEW,t)},e.prototype.skipFeature=function(t){var e=Object(n.b)(t).toString();this.skippedFeatureUids_[e]=!0,this.render()},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},e.prototype.unskipFeature=function(t){var e=Object(n.b)(t).toString();delete this.skippedFeatureUids_[e],this.render()},e}(st.a),wt=function(t){function e(e){t.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:yt.c,e.target&&this.setTarget(e.target)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){Object(gt.e)(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&Object(gt.e)(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)Object(p.e)(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==yt.c&&this.listenerKeys.push(Object(p.a)(t,rt.a.POSTRENDER,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(st.a),Rt=i(21),It=i(31);function St(t){this.updateElement_(t.frameState)}var Pt=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||St,target:i.target}),this.ulElement_=document.createElement("UL"),this.collapsed_=void 0===i.collapsed||i.collapsed,this.collapsible_=void 0===i.collapsible||i.collapsible,this.collapsible_||(this.collapsed_=!1);var n=void 0!==i.className?i.className:"ol-attribution",r=void 0!==i.tipLabel?i.tipLabel:"Attributions",o=void 0!==i.collapseLabel?i.collapseLabel:"»";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o):this.collapseLabel_=o;var s=void 0!==i.label?i.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,h=document.createElement("button");h.setAttribute("type","button"),h.title=r,h.appendChild(a),Object(p.a)(h,l.a.CLICK,this.handleClick_,this);var c=n+" "+Rt.e+" "+Rt.b+(this.collapsed_&&this.collapsible_?" "+Rt.a:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.ulElement_),u.appendChild(h),this.renderedAttributions_=[],this.renderedVisible_=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getSourceAttributions_=function(t){for(var e={},i=[],n=t.layerStatesArray,r=t.viewState.resolution,o=0,s=n.length;o<s;++o){var a=n[o];if(Object(It.b)(a,r)){var h=a.layer.getSource();if(h){var c=h.getAttributions();if(c){var l=c(t);if(l)if(Array.isArray(l))for(var u=0,d=l.length;u<d;++u)l[u]in e||(i.push(l[u]),e[l[u]]=!0);else l in e||(i.push(l),e[l]=!0)}}}}return i},e.prototype.updateElement_=function(t){if(t){var e=this.getSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Object(Z.a)(e,this.renderedAttributions_)){Object(gt.d)(this.ulElement_);for(var n=0,r=e.length;n<r;++n){var o=document.createElement("LI");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle(Rt.a),this.collapsed_?Object(gt.f)(this.collapseLabel_,this.label_):Object(gt.f)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e}(wt),Mt=i(23);function jt(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var r=this.element.classList.contains(Rt.c);r||0!==i?r&&0!==i&&this.element.classList.remove(Rt.c):this.element.classList.add(Rt.c)}this.label_.style.msTransform=n,this.label_.style.webkitTransform=n,this.label_.style.transform=n}this.rotation_=i}}var Lt=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||jt,target:i.target});var n=void 0!==i.className?i.className:"ol-rotate",r=void 0!==i.label?i.label:"⇧";this.label_=null,"string"==typeof r?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=r):(this.label_=r,this.label_.classList.add("ol-compass"));var o=i.tipLabel?i.tipLabel:"Reset rotation",s=document.createElement("button");s.className=n+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),Object(p.a)(s,l.a.CLICK,this.handleClick_,this);var a=n+" "+Rt.e+" "+Rt.b,h=this.element;h.className=a,h.appendChild(s),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Rt.c)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:Mt.b}):t.setRotation(0))},e}(wt),At=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target});var n=void 0!==i.className?i.className:"ol-zoom",r=void 0!==i.delta?i.delta:1,o=void 0!==i.zoomInLabel?i.zoomInLabel:"+",s=void 0!==i.zoomOutLabel?i.zoomOutLabel:"−",a=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",h=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=n+"-in",c.setAttribute("type","button"),c.title=a,c.appendChild("string"==typeof o?document.createTextNode(o):o),Object(p.a)(c,l.a.CLICK,this.handleClick_.bind(this,r));var u=document.createElement("button");u.className=n+"-out",u.setAttribute("type","button"),u.title=h,u.appendChild("string"==typeof s?document.createTextNode(s):s),Object(p.a)(u,l.a.CLICK,this.handleClick_.bind(this,-r));var d=n+" "+Rt.e+" "+Rt.b,f=this.element;f.className=d,f.appendChild(c),f.appendChild(u),this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getResolution();if(i){var n=e.constrainResolution(i,t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:n,duration:this.duration_,easing:Mt.b})):e.setResolution(n)}}},e}(wt);var Ft=function(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0};Ft.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},Ft.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},Ft.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_},Ft.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},Ft.prototype.getAngle=function(){return this.angle_};var Dt=Ft,kt="active",Nt=i(5);function Gt(t,e,i,n){zt(t,e=t.constrainRotation(e,0),i,n)}function zt(t,e,i,n){if(void 0!==e){var r=t.getRotation(),o=t.getCenter();void 0!==r&&o&&n>0?t.animate({rotation:e,anchor:i,duration:n,easing:Mt.b}):t.rotate(e,i)}}function Ut(t,e,i,n){var r=t.getResolution(),o=t.constrainResolution(r,e,0);if(void 0!==o){var s=t.getResolutions();o=Object(Nt.a)(o,t.getMinResolution()||s[s.length-1],t.getMaxResolution()||s[0])}if(i&&void 0!==o&&o!==r){var a=t.getCenter(),h=t.calculateCenterZoom(o,i);h=t.constrainCenter(h),i=[(o*a[0]-r*h[0])/(o-r),(o*a[1]-r*h[1])/(o-r)]}Bt(t,o,i,n)}function Bt(t,e,i,n){if(e){var r=t.getResolution(),o=t.getCenter();if(void 0!==r&&o&&e!==r&&n)t.animate({resolution:e,anchor:i,duration:n,easing:Mt.b});else{if(i){var s=t.calculateCenterZoom(e,i);t.setCenter(s)}t.setResolution(e)}}}var Yt=function(t){function e(e){t.call(this),this.map_=null,this.setActive(!0),this.handleEvent=e.handleEvent}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getActive=function(){return this.get(kt)},e.prototype.getMap=function(){return this.map_},e.prototype.setActive=function(t){this.set(kt,t)},e.prototype.setMap=function(t){this.map_=t},e}(st.a);function Wt(t){var e=!1,i=t.originalEvent;if(t.type==u.DBLCLICK){var n=t.map,r=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;Ut(n.getView(),o,r,this.duration_),t.preventDefault(),e=!0}return!e}var Ht=function(t){function e(e){t.call(this,{handleEvent:Wt});var i=e||{};this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yt),Vt=i(38),Xt=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Kt=yt.b,Zt=function(t){var e=t.originalEvent;return 0==e.button&&!(c.i&&c.d&&e.ctrlKey)},qt=(yt.a,function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}),$t=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Jt=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},Qt=function(t){return Object(ct.a)(t.pointerEvent,56),"mouse"==t.pointerEvent.pointerType},te=yt.c,ee=yt.a,ie=yt.a,ne=yt.c;function re(t){for(var e=t.length,i=0,n=0,r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return[i/e,n/e]}function oe(t){if(!(t instanceof d))return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==u.POINTERDRAG)this.handleDragEvent_(t);else if(t.type==u.POINTERUP){var i=this.handleUpEvent_(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==u.POINTERDOWN){var n=this.handleDownEvent_(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==u.POINTERMOVE&&this.handleMoveEvent_(t);return!e}var se=function(t){function e(e){var i=e||{};t.call(this,{handleEvent:i.handleEvent||oe}),this.handleDownEvent_=i.handleDownEvent?i.handleDownEvent:ie,this.handleDragEvent_=i.handleDragEvent?i.handleDragEvent:te,this.handleMoveEvent_=i.handleMoveEvent?i.handleMoveEvent:ne,this.handleUpEvent_=i.handleUpEvent?i.handleUpEvent:ee,this.handlingDownUpSequence=!1,this.stopDown=i.stopDown?i.stopDown:ae,this.trackedPointers_={},this.targetPointers=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===u.POINTERDOWN||e===u.POINTERDRAG||e===u.POINTERUP}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==u.POINTERUP?delete this.trackedPointers_[i]:t.type==u.POINTERDOWN?this.trackedPointers_[i]=e:i in this.trackedPointers_&&(this.trackedPointers_[i]=e),this.targetPointers=Object(lt.c)(this.trackedPointers_)}},e}(Yt);function ae(t){return t}function he(t){var e=this.targetPointers,i=re(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var n=this.lastCentroid[0]-i[0],r=i[1]-this.lastCentroid[1],o=t.map.getView(),s=[n,r];Object(Vt.d)(s,o.getResolution()),Object(Vt.c)(s,o.getRotation()),Object(Vt.a)(s,o.getCenter()),s=o.constrainCenter(s),o.setCenter(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length}function ce(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenter(),s=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([s[0]-n*Math.cos(r),s[1]-n*Math.sin(r)]);i.animate({center:i.constrainCenter(a),duration:500,easing:Mt.b})}return i.setHint(_t.a.INTERACTING,-1),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}function le(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,this.handlingDownUpSequence||e.setHint(_t.a.INTERACTING,1),e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}var ue=function(t){function e(e){t.call(this,{handleDownEvent:le,handleDragEvent:he,handleUpEvent:ce,stopDown:yt.a});var i=e||{};this.kinetic_=i.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.condition_=i.condition?i.condition:qt,this.noKinetic_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(se),de=i(37);function pe(t){if(Qt(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==de.c){var n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){var s=o-this.lastAngle_;zt(i,i.getRotation()-s)}this.lastAngle_=o}}}function fe(t){if(!Qt(t))return!0;var e=t.map.getView();return e.setHint(_t.a.INTERACTING,-1),Gt(e,e.getRotation(),void 0,this.duration_),!1}function _e(t){return!!Qt(t)&&(!(!Zt(t)||!this.condition_(t))&&(t.map.getView().setHint(_t.a.INTERACTING,1),this.lastAngle_=void 0,!0))}var ge=function(t){function e(e){var i=e||{};t.call(this,{handleDownEvent:_e,handleDragEvent:pe,handleUpEvent:fe,stopDown:yt.a}),this.condition_=i.condition?i.condition:Xt,this.lastAngle_=void 0,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(se),ve=i(42),ye=i(62),me=function(t){function e(e){t.call(this),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i=this.element_.style;i.left=Math.min(t[0],e[0])+"px",i.top=Math.min(t[1],e[1])+"px",i.width=Math.abs(e[0]-t[0])+"px",i.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new ye.a([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(ve.a),be={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},xe=function(t){function e(e,i,n){t.call(this,e),this.coordinate=i,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(s.a);function Ee(t,e,i){var n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}function Ce(t){Qt(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new xe(be.BOXDRAG,t.coordinate,t)))}function Oe(t){return!Qt(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new xe(be.BOXEND,t.coordinate,t))),!1)}function Te(t){return!!Qt(t)&&(!(!Zt(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new xe(be.BOXSTART,t.coordinate,t)),!0))}function we(){var t=this.getMap(),e=t.getView(),i=t.getSize(),n=this.getGeometry().getExtent();if(this.out_){var r=e.calculateExtent(i),o=Object(vt.m)([t.getPixelFromCoordinate(Object(vt.u)(n)),t.getPixelFromCoordinate(Object(vt.C)(n))]),s=e.getResolutionForExtent(o,i);Object(vt.I)(r,1/s),n=r}var a=e.constrainResolution(e.getResolutionForExtent(n,i)),h=Object(vt.w)(n);h=e.constrainCenter(h),e.animate({resolution:a,center:h,duration:this.duration_,easing:Mt.b})}var Re=function(t){function e(e){var i=e||{},n=i.condition?i.condition:$t;t.call(this,{condition:n,className:i.className||"ol-dragzoom",onBoxEnd:we}),this.duration_=void 0!==i.duration?i.duration:200,this.out_=void 0!==i.out&&i.out}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(function(t){function e(e){t.call(this,{handleDownEvent:Te,handleDragEvent:Ce,handleUpEvent:Oe});var i=e||{};this.box_=new me(i.className||"ol-dragbox"),this.minArea_=void 0!==i.minArea?i.minArea:64,this.onBoxEnd_=i.onBoxEnd?i.onBoxEnd:yt.c,this.startPixel_=null,this.condition_=i.condition?i.condition:Kt,this.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:Ee}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getGeometry=function(){return this.box_.getGeometry()},e}(se)),Ie={LEFT:37,UP:38,RIGHT:39,DOWN:40};function Se(t){var e=!1;if(t.type==l.a.KEYDOWN){var i=t.originalEvent.keyCode;if(this.condition_(t)&&(i==Ie.DOWN||i==Ie.LEFT||i==Ie.RIGHT||i==Ie.UP)){var n=t.map.getView(),r=n.getResolution()*this.pixelDelta_,o=0,s=0;i==Ie.DOWN?s=-r:i==Ie.LEFT?o=-r:i==Ie.RIGHT?o=r:s=r;var a=[o,s];Object(Vt.c)(a,n.getRotation()),function(t,e,i){var n=t.getCenter();if(n){var r=t.constrainCenter([n[0]+e[0],n[1]+e[1]]);i?t.animate({duration:i,easing:Mt.d,center:r}):t.setCenter(r)}}(n,a,this.duration_),t.preventDefault(),e=!0}}return!e}var Pe=function(t){function e(e){t.call(this,{handleEvent:Se});var i=e||{};this.defaultCondition_=function(t){return qt(t)&&Jt(t)},this.condition_=void 0!==i.condition?i.condition:this.defaultCondition_,this.duration_=void 0!==i.duration?i.duration:100,this.pixelDelta_=void 0!==i.pixelDelta?i.pixelDelta:128}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yt);function Me(t){var e=!1;if(t.type==l.a.KEYDOWN||t.type==l.a.KEYPRESS){var i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var n=t.map,r=i=="+".charCodeAt(0)?this.delta_:-this.delta_;Ut(n.getView(),r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var je=function(t){function e(e){t.call(this,{handleEvent:Me});var i=e||{};this.condition_=i.condition?i.condition:Jt,this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:100}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Yt),Le={TRACKPAD:"trackpad",WHEEL:"wheel"};function Ae(t){if(!this.condition_(t))return!0;var e=t.type;if(e!==l.a.WHEEL&&e!==l.a.MOUSEWHEEL)return!0;t.preventDefault();var i,n=t.map,r=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==l.a.WHEEL?(i=r.deltaY,c.c&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=c.b),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)):t.type==l.a.MOUSEWHEEL&&(i=-r.wheelDeltaY,c.g&&(i/=3)),0===i)return!1;var o=Date.now();if(void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?Le.TRACKPAD:Le.WHEEL),this.mode_===Le.TRACKPAD){var s=n.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):s.setHint(_t.a.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var a=s.getResolution()*Math.pow(2,i/this.trackpadDeltaPerZoom_),h=s.getMinResolution(),u=s.getMaxResolution(),d=0;if(a<h?(a=Math.max(a,h/this.trackpadZoomBuffer_),d=1):a>u&&(a=Math.min(a,u*this.trackpadZoomBuffer_),d=-1),this.lastAnchor_){var p=s.calculateCenterZoom(a,this.lastAnchor_);s.setCenter(s.constrainCenter(p))}return s.setResolution(a),0===d&&this.constrainResolution_&&s.animate({resolution:s.constrainResolution(a,i>0?-1:1),easing:Mt.b,anchor:this.lastAnchor_,duration:this.duration_}),d>0?s.animate({resolution:h,easing:Mt.b,anchor:this.lastAnchor_,duration:500}):d<0&&s.animate({resolution:u,easing:Mt.b,anchor:this.lastAnchor_,duration:500}),this.startTime_=o,!1}this.delta_+=i;var f=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),f),!1}var Fe=function(t){function e(e){t.call(this,{handleEvent:Ae});var i=e||{};this.delta_=0,this.duration_=void 0!==i.duration?i.duration:250,this.timeout_=void 0!==i.timeout?i.timeout:80,this.useAnchor_=void 0===i.useAnchor||i.useAnchor,this.constrainResolution_=i.constrainResolution||!1,this.condition_=i.condition?i.condition:Kt,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(_t.a.INTERACTING,-1)},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();Ut(e,-Object(Nt.a)(this.delta_,-1,1),this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Yt);function De(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var o=r-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=r;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==de.c){var h=s.getViewport().getBoundingClientRect(),c=re(this.targetPointers);if(c[0]-=h.left,c[1]-=h.top,this.anchor_=s.getCoordinateFromPixel(c),this.rotating_){var l=a.getRotation();s.render(),zt(a,l+e,this.anchor_)}}}function ke(t){if(this.targetPointers.length<2){var e=t.map.getView();if(e.setHint(_t.a.INTERACTING,-1),this.rotating_)Gt(e,e.getRotation(),this.anchor_,this.duration_);return!1}return!0}function Ne(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().setHint(_t.a.INTERACTING,1),!0}return!1}var Ge=function(t){function e(e){t.call(this,{handleDownEvent:Ne,handleDragEvent:De,handleUpEvent:ke,stopDown:yt.a});var i=e||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(se);function ze(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,s=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,h=a.getView(),c=h.getResolution(),l=h.getMaxResolution(),u=h.getMinResolution(),d=c*e;d>l?(e=l/c,d=l):d<u&&(e=u/c,d=u),1!=e&&(this.lastScaleDelta_=e);var p=a.getViewport().getBoundingClientRect(),f=re(this.targetPointers);f[0]-=p.left,f[1]-=p.top,this.anchor_=a.getCoordinateFromPixel(f),a.render(),Bt(h,d,this.anchor_)}function Ue(t){if(this.targetPointers.length<2){var e=t.map.getView();e.setHint(_t.a.INTERACTING,-1);var i=e.getResolution();if(this.constrainResolution_||i<e.getMinResolution()||i>e.getMaxResolution()){var n=this.lastScaleDelta_-1;!function(t,e,i,n,r){Bt(t,e=t.constrainResolution(e,0,r),i,n)}(e,i,this.anchor_,this.duration_,n)}return!1}return!0}function Be(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(_t.a.INTERACTING,1),!0}return!1}var Ye=function(t){function e(e){t.call(this,{handleDownEvent:Be,handleDragEvent:ze,handleUpEvent:Ue,stopDown:yt.a});var i=e||{};this.constrainResolution_=i.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==i.duration?i.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(se);var We=i(29),He=i(35),Ve=function(t){function e(e,i,n,r,o){t.call(this,e),this.vectorContext=i,this.frameState=n,this.context=r,this.glContext=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(s.a),Xe=i(46),Ke=i(7),Ze={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"},qe=function(){};qe.prototype.drawCustom=function(t,e,i){},qe.prototype.drawGeometry=function(t){},qe.prototype.setStyle=function(t){},qe.prototype.drawCircle=function(t,e){},qe.prototype.drawFeature=function(t,e){},qe.prototype.drawGeometryCollection=function(t,e){},qe.prototype.drawLineString=function(t,e){},qe.prototype.drawMultiLineString=function(t,e){},qe.prototype.drawMultiPoint=function(t,e){},qe.prototype.drawMultiPolygon=function(t,e){},qe.prototype.drawPoint=function(t,e){},qe.prototype.drawPolygon=function(t,e){},qe.prototype.drawText=function(t,e){},qe.prototype.setFillStrokeStyle=function(t,e){},qe.prototype.setImageStyle=function(t,e){},qe.prototype.setTextStyle=function(t,e){};var $e=qe,Je=[Ze.POLYGON,Ze.CIRCLE,Ze.LINE_STRING,Ze.IMAGE,Ze.TEXT,Ze.DEFAULT],Qe={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},ti=function(){};ti.prototype.getReplay=function(t,e){},ti.prototype.isEmpty=function(){};var ei=ti,ii=i(30),ni=i(25),ri=i(0),oi=function(t){this.source_=t};oi.prototype.getType=function(){},oi.prototype.getSource=function(){return this.source_},oi.prototype.isAnimated=yt.a;var si=oi,ai=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return ri.m},e}(si),hi=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return ri.J},e}(si),ci=new ai(ri.g?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}"),li=new hi(ri.g?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;if(f==0.0){offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}"),ui=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ri.g?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ri.g?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ri.g?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(e,ri.g?"u_lineWidth":"k"),this.u_pixelRatio=t.getUniformLocation(e,ri.g?"u_pixelRatio":"l"),this.u_opacity=t.getUniformLocation(e,ri.g?"u_opacity":"m"),this.u_fillColor=t.getUniformLocation(e,ri.g?"u_fillColor":"n"),this.u_strokeColor=t.getUniformLocation(e,ri.g?"u_strokeColor":"o"),this.u_size=t.getUniformLocation(e,ri.g?"u_size":"p"),this.a_position=t.getAttribLocation(e,ri.g?"a_position":"e"),this.a_instruction=t.getAttribLocation(e,ri.g?"a_instruction":"f"),this.a_radius=t.getAttribLocation(e,ri.g?"a_radius":"g")};function di(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}var pi=function(t){function e(e,i){t.call(this),this.tolerance=e,this.maxExtent=i,this.origin=Object(vt.w)(i),this.projectionMatrix_=Object(Ot.c)(),this.offsetRotateMatrix_=Object(Ot.c)(),this.offsetScaleMatrix_=Object(Ot.c)(),this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeleteResourcesFunction=function(t){},e.prototype.finish=function(t){},e.prototype.setUpProgram=function(t,e,i,n){},e.prototype.shutDownProgram=function(t,e){},e.prototype.drawReplay=function(t,e,i,n){},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,n,r){},e.prototype.drawHitDetectionReplay=function(t,e,i,n,r,o){return r?this.drawHitDetectionReplayOneByOne(t,e,i,n,o):this.drawHitDetectionReplayAll(t,e,i,n)},e.prototype.drawHitDetectionReplayAll=function(t,e,i,n){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawReplay(t,e,i,!0);var r=n(null);return r||void 0},e.prototype.replay=function(t,e,i,n,r,o,s,a,h,c,l){var u,d,p,f,_,g,v,y,m=t.getGL();this.lineStringReplay&&(u=m.isEnabled(m.STENCIL_TEST),d=m.getParameter(m.STENCIL_FUNC),p=m.getParameter(m.STENCIL_VALUE_MASK),f=m.getParameter(m.STENCIL_REF),_=m.getParameter(m.STENCIL_WRITEMASK),g=m.getParameter(m.STENCIL_FAIL),v=m.getParameter(m.STENCIL_PASS_DEPTH_PASS),y=m.getParameter(m.STENCIL_PASS_DEPTH_FAIL),m.enable(m.STENCIL_TEST),m.clear(m.STENCIL_BUFFER_BIT),m.stencilMask(255),m.stencilFunc(m.ALWAYS,1,255),m.stencilOp(m.KEEP,m.KEEP,m.REPLACE),this.lineStringReplay.replay(t,e,i,n,r,o,s,a,h,c,l),m.stencilMask(0),m.stencilFunc(m.NOTEQUAL,1,255)),t.bindBuffer(ri.a,this.verticesBuffer),t.bindBuffer(ri.j,this.indicesBuffer);var b=this.setUpProgram(m,t,r,o),x=Object(Ot.f)(this.projectionMatrix_);Object(Ot.h)(x,2/(i*r[0]),2/(i*r[1])),Object(Ot.g)(x,-n),Object(Ot.j)(x,-(e[0]-this.origin[0]),-(e[1]-this.origin[1]));var E=Object(Ot.f)(this.offsetScaleMatrix_);Object(Ot.h)(E,2/r[0],2/r[1]);var C,O=Object(Ot.f)(this.offsetRotateMatrix_);return 0!==n&&Object(Ot.g)(O,-n),m.uniformMatrix4fv(b.u_projectionMatrix,!1,di(this.tmpMat4_,x)),m.uniformMatrix4fv(b.u_offsetScaleMatrix,!1,di(this.tmpMat4_,E)),m.uniformMatrix4fv(b.u_offsetRotateMatrix,!1,di(this.tmpMat4_,O)),m.uniform1f(b.u_opacity,s),void 0===h?this.drawReplay(m,t,a,!1):C=this.drawHitDetectionReplay(m,t,a,h,c,l),this.shutDownProgram(m,b),this.lineStringReplay&&(u||m.disable(m.STENCIL_TEST),m.clear(m.STENCIL_BUFFER_BIT),m.stencilFunc(d,f,p),m.stencilMask(_),m.stencilOp(g,y,v)),C},e.prototype.drawElements=function(t,e,i,n){var r=e.hasOESElementIndexUint?ri.H:ri.I,o=n-i,s=i*(e.hasOESElementIndexUint?4:2);t.drawElements(ri.E,o,r,s)},e}($e),fi=[0,0,0,1],_i=[],gi=[0,0,0,1],vi=Number.EPSILON||2.220446049250313e-16,yi=function(t,e,i,n,r,o){var s=(i-t)*(o-e)-(r-t)*(n-e);return s<=vi&&s>=-vi?void 0:s>0},mi={STATIC_DRAW:ri.v,STREAM_DRAW:ri.x,DYNAMIC_DRAW:ri.i},bi=function(t,e){this.arr_=void 0!==t?t:[],this.usage_=void 0!==e?e:mi.STATIC_DRAW};bi.prototype.getArray=function(){return this.arr_},bi.prototype.getUsage=function(){return this.usage_};var xi=bi,Ei=function(t){function e(e,i){t.call(this,e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,n){var r,o,s=this.vertices.length,a=this.indices.length,h=s/4;for(r=e,o=i;r<o;r+=n)this.vertices[s++]=t[r],this.vertices[s++]=t[r+1],this.vertices[s++]=0,this.vertices[s++]=this.radius_,this.vertices[s++]=t[r],this.vertices[s++]=t[r+1],this.vertices[s++]=1,this.vertices[s++]=this.radius_,this.vertices[s++]=t[r],this.vertices[s++]=t[r+1],this.vertices[s++]=2,this.vertices[s++]=this.radius_,this.vertices[s++]=t[r],this.vertices[s++]=t[r+1],this.vertices[s++]=3,this.vertices[s++]=this.radius_,this.indices[a++]=h,this.indices[a++]=h+1,this.indices[a++]=h+2,this.indices[a++]=h+2,this.indices[a++]=h+3,this.indices[a++]=h,h+=4},e.prototype.drawCircle=function(t,e){var i=t.getRadius(),n=t.getStride();if(i){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=i;var r=t.getFlatCoordinates();r=Object(ni.d)(r,0,2,n,-this.origin[0],-this.origin[1]),this.drawCoordinates_(r,0,2,n)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){var o=this.styles_[this.styles_.length-1];this.state_.fillColor=o[0],this.state_.strokeColor=o[1],this.state_.lineWidth=o[2],this.state_.changed=!1}},e.prototype.finish=function(t){this.verticesBuffer=new xi(this.vertices),this.indicesBuffer=new xi(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.setUpProgram=function(t,e,i,n){var r,o=e.getProgram(ci,li);return this.defaultLocations_?r=this.defaultLocations_:(r=new ui(t,o),this.defaultLocations_=r),e.useProgram(o),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,ri.l,!1,16,0),t.enableVertexAttribArray(r.a_instruction),t.vertexAttribPointer(r.a_instruction,1,ri.l,!1,16,8),t.enableVertexAttribArray(r.a_radius),t.vertexAttribPointer(r.a_radius,1,ri.l,!1,16,12),t.uniform2fv(r.u_size,i),t.uniform1f(r.u_pixelRatio,n),r},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_instruction),t.disableVertexAttribArray(e.a_radius)},e.prototype.drawReplay=function(t,e,i,n){var r,o,s,a;if(Object(lt.d)(i))for(s=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)o=this.styleIndices_[r],a=this.styles_[r],this.setFillStyle_(t,a[0]),this.setStrokeStyle_(t,a[1],a[2]),this.drawElements(t,e,o,s),s=o;else this.drawReplaySkipping_(t,e,i)},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,o){var s,a,h,c,l,u,d;for(d=this.startIndices.length-2,h=this.startIndices[d+1],s=this.styleIndices_.length-1;s>=0;--s)for(c=this.styles_[s],this.setFillStyle_(t,c[0]),this.setStrokeStyle_(t,c[1],c[2]),l=this.styleIndices_[s];d>=0&&this.startIndices[d]>=l;){if(a=this.startIndices[d],u=this.startIndicesFeature[d],void 0===i[Object(n.b)(u).toString()]&&u.getGeometry()&&(void 0===o||Object(vt.E)(o,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,h);var p=r(u);if(p)return p}d--,h=a}},e.prototype.drawReplaySkipping_=function(t,e,i){var r,o,s,a,h,c,l,u;for(l=this.startIndices.length-2,s=o=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setFillStyle_(t,a[0]),this.setStrokeStyle_(t,a[1],a[2]),h=this.styleIndices_[r];l>=0&&this.startIndices[l]>=h;)u=this.startIndices[l],c=this.startIndicesFeature[l],i[Object(n.b)(c).toString()]&&(o!==s&&this.drawElements(t,e,o,s),s=u),l--,o=u;o!==s&&this.drawElements(t,e,o,s),o=s=h}},e.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_fillColor,e)},e.prototype.setStrokeStyle_=function(t,e,i){t.uniform4fv(this.defaultLocations_.u_strokeColor,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i)},e.prototype.setFillStrokeStyle=function(t,e){var i,n;if(e){var r=e.getLineDash();this.state_.lineDash=r||_i;var o=e.getLineDashOffset();this.state_.lineDashOffset=o||0,i=(i=e.getColor())instanceof CanvasGradient||i instanceof CanvasPattern?gi:Object(ii.a)(i).map(function(t,e){return 3!=e?t/255:t})||gi,n=void 0!==(n=e.getWidth())?n:1}else i=[0,0,0,0],n=0;var s=t?t.getColor():[0,0,0,0];s=s instanceof CanvasGradient||s instanceof CanvasPattern?fi:Object(ii.a)(s).map(function(t,e){return 3!=e?t/255:t})||fi,this.state_.strokeColor&&Object(Z.a)(this.state_.strokeColor,i)&&this.state_.fillColor&&Object(Z.a)(this.state_.fillColor,s)&&this.state_.lineWidth===n||(this.state_.changed=!0,this.state_.fillColor=s,this.state_.strokeColor=i,this.state_.lineWidth=n,this.styles_.push([s,i,n]))},e}(pi),Ci=new ai(ri.g?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),Oi=new hi(ri.g?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}"),Ti=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ri.g?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ri.g?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ri.g?"u_offsetRotateMatrix":"j"),this.u_opacity=t.getUniformLocation(e,ri.g?"u_opacity":"k"),this.u_image=t.getUniformLocation(e,ri.g?"u_image":"l"),this.a_position=t.getAttribLocation(e,ri.g?"a_position":"c"),this.a_texCoord=t.getAttribLocation(e,ri.g?"a_texCoord":"d"),this.a_offsets=t.getAttribLocation(e,ri.g?"a_offsets":"e"),this.a_opacity=t.getAttribLocation(e,ri.g?"a_opacity":"f"),this.a_rotateWithView=t.getAttribLocation(e,ri.g?"a_rotateWithView":"g")},wi={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};function Ri(t,e,i){var n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),void 0!==e&&t.texParameteri(ri.z,ri.C,e),void 0!==i&&t.texParameteri(ri.z,ri.D,i),n}function Ii(t,e,i,n,r){var o=Ri(t,n,r);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),o}function Si(t,e,i,n){var r=Ri(t,i,n);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),r}var Pi=function(t){function e(e,i){t.call(this),this.canvas_=e,this.gl_=i,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=Object(Z.c)(ri.k,"OES_element_index_uint"),this.hasOESElementIndexUint&&i.getExtension("OES_element_index_uint"),Object(p.a)(this.canvas_,wi.LOST,this.handleWebGLContextLost,this),Object(p.a)(this.canvas_,wi.RESTORED,this.handleWebGLContextRestored,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindBuffer=function(t,e){var i=this.getGL(),r=e.getArray(),o=String(Object(n.b)(e));if(o in this.bufferCache_){var s=this.bufferCache_[o];i.bindBuffer(t,s.buffer)}else{var a,h=i.createBuffer();i.bindBuffer(t,h),t==ri.a?a=new Float32Array(r):t==ri.j&&(a=this.hasOESElementIndexUint?new Uint32Array(r):new Uint16Array(r)),i.bufferData(t,a,e.getUsage()),this.bufferCache_[o]={buf:e,buffer:h}}},e.prototype.deleteBuffer=function(t){var e=this.getGL(),i=String(Object(n.b)(t)),r=this.bufferCache_[i];e.isContextLost()||e.deleteBuffer(r.buffer),delete this.bufferCache_[i]},e.prototype.disposeInternal=function(){Object(p.d)(this.canvas_);var t=this.getGL();if(!t.isContextLost()){for(var e in this.bufferCache_)t.deleteBuffer(this.bufferCache_[e].buffer);for(var i in this.programCache_)t.deleteProgram(this.programCache_[i]);for(var n in this.shaderCache_)t.deleteShader(this.shaderCache_[n]);t.deleteFramebuffer(this.hitDetectionFramebuffer_),t.deleteRenderbuffer(this.hitDetectionRenderbuffer_),t.deleteTexture(this.hitDetectionTexture_)}},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},e.prototype.getShader=function(t){var e=String(Object(n.b)(t));if(e in this.shaderCache_)return this.shaderCache_[e];var i=this.getGL(),r=i.createShader(t.getType());return i.shaderSource(r,t.getSource()),i.compileShader(r),this.shaderCache_[e]=r,r},e.prototype.getProgram=function(t,e){var i=Object(n.b)(t)+"/"+Object(n.b)(e);if(i in this.programCache_)return this.programCache_[i];var r=this.getGL(),o=r.createProgram();return r.attachShader(o,this.getShader(t)),r.attachShader(o,this.getShader(e)),r.linkProgram(o),this.programCache_[i]=o,o},e.prototype.handleWebGLContextLost=function(){Object(lt.b)(this.bufferCache_),Object(lt.b)(this.shaderCache_),Object(lt.b)(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.initHitDetectionFramebuffer_=function(){var t=this.gl_,e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var i=Ii(t,1,1),n=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,n),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,1,1),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,n),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=e,this.hitDetectionTexture_=i,this.hitDetectionRenderbuffer_=n},e.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,!0)},e}(ve.a),Mi=function(t){function e(e,i){t.call(this,e,i),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,n=this.getTextures(!0),r=t.getGL();return function(){var o,s;if(!r.isContextLost())for(o=0,s=n.length;o<s;++o)r.deleteTexture(n[o]);t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.drawCoordinates=function(t,e,i,n){var r,o,s,a,h,c,l=this.anchorX,u=this.anchorY,d=this.height,p=this.imageHeight,f=this.imageWidth,_=this.opacity,g=this.originX,v=this.originY,y=this.rotateWithView?1:0,m=-this.rotation,b=this.scale,x=this.width,E=Math.cos(m),C=Math.sin(m),O=this.indices.length,T=this.vertices.length;for(r=e;r<i;r+=n)h=t[r]-this.origin[0],c=t[r+1]-this.origin[1],o=T/8,s=-b*l,a=-b*(d-u),this.vertices[T++]=h,this.vertices[T++]=c,this.vertices[T++]=s*E-a*C,this.vertices[T++]=s*C+a*E,this.vertices[T++]=g/f,this.vertices[T++]=(v+d)/p,this.vertices[T++]=_,this.vertices[T++]=y,s=b*(x-l),a=-b*(d-u),this.vertices[T++]=h,this.vertices[T++]=c,this.vertices[T++]=s*E-a*C,this.vertices[T++]=s*C+a*E,this.vertices[T++]=(g+x)/f,this.vertices[T++]=(v+d)/p,this.vertices[T++]=_,this.vertices[T++]=y,s=b*(x-l),a=b*u,this.vertices[T++]=h,this.vertices[T++]=c,this.vertices[T++]=s*E-a*C,this.vertices[T++]=s*C+a*E,this.vertices[T++]=(g+x)/f,this.vertices[T++]=v/p,this.vertices[T++]=_,this.vertices[T++]=y,s=-b*l,a=b*u,this.vertices[T++]=h,this.vertices[T++]=c,this.vertices[T++]=s*E-a*C,this.vertices[T++]=s*C+a*E,this.vertices[T++]=g/f,this.vertices[T++]=v/p,this.vertices[T++]=_,this.vertices[T++]=y,this.indices[O++]=o,this.indices[O++]=o+1,this.indices[O++]=o+2,this.indices[O++]=o,this.indices[O++]=o+2,this.indices[O++]=o+3;return T},e.prototype.createTextures=function(t,e,i,r){var o,s,a,h,c=e.length;for(h=0;h<c;++h)s=e[h],(a=Object(n.b)(s).toString())in i?o=i[a]:(o=Si(r,s,ri.c,ri.c),i[a]=o),t[h]=o},e.prototype.setUpProgram=function(t,e,i,n){var r,o=e.getProgram(Ci,Oi);return this.defaultLocations?r=this.defaultLocations:(r=new Ti(t,o),this.defaultLocations=r),e.useProgram(o),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,ri.l,!1,32,0),t.enableVertexAttribArray(r.a_offsets),t.vertexAttribPointer(r.a_offsets,2,ri.l,!1,32,8),t.enableVertexAttribArray(r.a_texCoord),t.vertexAttribPointer(r.a_texCoord,2,ri.l,!1,32,16),t.enableVertexAttribArray(r.a_opacity),t.vertexAttribPointer(r.a_opacity,1,ri.l,!1,32,24),t.enableVertexAttribArray(r.a_rotateWithView),t.vertexAttribPointer(r.a_rotateWithView,1,ri.l,!1,32,28),r},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_offsets),t.disableVertexAttribArray(e.a_texCoord),t.disableVertexAttribArray(e.a_opacity),t.disableVertexAttribArray(e.a_rotateWithView)},e.prototype.drawReplay=function(t,e,i,n){var r,o,s,a=n?this.getHitDetectionTextures():this.getTextures(),h=n?this.hitDetectionGroupIndices:this.groupIndices;if(Object(lt.d)(i))for(r=0,o=a.length,s=0;r<o;++r){t.bindTexture(ri.z,a[r]);var c=h[r];this.drawElements(t,e,s,c),s=c}else this.drawReplaySkipping(t,e,i,a,h)},e.prototype.drawReplaySkipping=function(t,e,i,r,o){var s,a,h=0;for(s=0,a=r.length;s<a;++s){t.bindTexture(ri.z,r[s]);for(var c=s>0?o[s-1]:0,l=o[s],u=c,d=c;h<this.startIndices.length&&this.startIndices[h]<=l;){var p=this.startIndicesFeature[h];void 0!==i[Object(n.b)(p).toString()]?(u!==d&&this.drawElements(t,e,u,d),d=u=h===this.startIndices.length-1?l:this.startIndices[h+1]):d=h===this.startIndices.length-1?l:this.startIndices[h+1],h++}u!==d&&this.drawElements(t,e,u,d)}},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,o){var s,a,h,c,l,u=this.startIndices.length-1,d=this.getHitDetectionTextures();for(s=d.length-1;s>=0;--s)for(t.bindTexture(ri.z,d[s]),a=s>0?this.hitDetectionGroupIndices[s-1]:0,c=this.hitDetectionGroupIndices[s];u>=0&&this.startIndices[u]>=a;){if(h=this.startIndices[u],l=this.startIndicesFeature[u],void 0===i[Object(n.b)(l).toString()]&&l.getGeometry()&&(void 0===o||Object(vt.E)(o,l.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,h,c);var p=r(l);if(p)return p}c=h,u--}},e.prototype.finish=function(t){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},e.prototype.getTextures=function(t){},e.prototype.getHitDetectionTextures=function(){},e}(pi),ji=function(t){function e(e,i){t.call(this,e,i),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawMultiPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),n=t.getStride();this.drawCoordinates(i,0,i.length,n)},e.prototype.drawPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),n=t.getStride();this.drawCoordinates(i,0,i.length,n)},e.prototype.finish=function(e){var i=e.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new xi(this.vertices);var n=this.indices;this.indicesBuffer=new xi(n);var r={};this.createTextures(this.textures_,this.images_,r,i),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,r,i),this.images_=null,this.hitDetectionImages_=null,t.prototype.finish.call(this,e)},e.prototype.setImageStyle=function(t){var e,i=t.getAnchor(),r=t.getImage(1),o=t.getImageSize(),s=t.getHitDetectionImage(1),a=t.getOpacity(),h=t.getOrigin(),c=t.getRotateWithView(),l=t.getRotation(),u=t.getSize(),d=t.getScale();0===this.images_.length?this.images_.push(r):(e=this.images_[this.images_.length-1],Object(n.b)(e)!=Object(n.b)(r)&&(this.groupIndices.push(this.indices.length),this.images_.push(r))),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(s):(e=this.hitDetectionImages_[this.hitDetectionImages_.length-1],Object(n.b)(e)!=Object(n.b)(s)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(s))),this.anchorX=i[0],this.anchorY=i[1],this.height=u[1],this.imageHeight=o[1],this.imageWidth=o[0],this.opacity=a,this.originX=h[0],this.originY=h[1],this.rotation=l,this.rotateWithView=c,this.scale=d,this.width=u[0]},e.prototype.getTextures=function(t){return t?this.textures_.concat(this.hitDetectionTextures_):this.textures_},e.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_},e}(Mi),Li=i(39),Ai=i(53);function Fi(t,e,i,n){var r=i-n;return t[e]===t[r]&&t[e+1]===t[r+1]&&(i-e)/n>3&&!!Object(Ai.a)(t,e,i,n)}var Di=new ai(ri.g?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),ki=new hi(ri.g?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}"),Ni=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ri.g?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ri.g?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ri.g?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(e,ri.g?"u_lineWidth":"k"),this.u_miterLimit=t.getUniformLocation(e,ri.g?"u_miterLimit":"l"),this.u_opacity=t.getUniformLocation(e,ri.g?"u_opacity":"m"),this.u_color=t.getUniformLocation(e,ri.g?"u_color":"n"),this.u_size=t.getUniformLocation(e,ri.g?"u_size":"o"),this.u_pixelRatio=t.getUniformLocation(e,ri.g?"u_pixelRatio":"p"),this.a_lastPos=t.getAttribLocation(e,ri.g?"a_lastPos":"d"),this.a_position=t.getAttribLocation(e,ri.g?"a_position":"e"),this.a_nextPos=t.getAttribLocation(e,ri.g?"a_nextPos":"f"),this.a_direction=t.getAttribLocation(e,ri.g?"a_direction":"g")},Gi=3,zi=5,Ui=7,Bi=11,Yi=13,Wi=17,Hi=19,Vi=23,Xi=function(t){function e(e,i){t.call(this,e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,n){var r,o,s,a,h,c,l,u,d=this.vertices.length,p=this.indices.length,f="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,_="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,g=Fi(t,e,i,n),v=p,y=1;for(r=e,o=i;r<o;r+=n){if(h=d/7,c=l,l=u||[t[r],t[r+1]],r===e){if(u=[t[r+n],t[r+n+1]],i-e==2*n&&Object(Z.a)(l,u))break;if(!g){_&&(d=this.addVertices_([0,0],l,u,y*Ui*_,d),d=this.addVertices_([0,0],l,u,-y*Ui*_,d),this.indices[p++]=h+2,this.indices[p++]=h,this.indices[p++]=h+1,this.indices[p++]=h+1,this.indices[p++]=h+3,this.indices[p++]=h+2),d=this.addVertices_([0,0],l,u,y*Gi*(_||1),d),v=(d=this.addVertices_([0,0],l,u,-y*Gi*(_||1),d))/7-1;continue}c=[t[i-2*n],t[i-2*n+1]],s=u}else{if(r===i-n){if(g){u=s;break}c=c||[0,0],d=this.addVertices_(c,l,[0,0],y*zi*(_||1),d),d=this.addVertices_(c,l,[0,0],-y*zi*(_||1),d),this.indices[p++]=h,this.indices[p++]=v-1,this.indices[p++]=v,this.indices[p++]=v,this.indices[p++]=h+1,this.indices[p++]=h,_&&(d=this.addVertices_(c,l,[0,0],y*Bi*_,d),d=this.addVertices_(c,l,[0,0],-y*Bi*_,d),this.indices[p++]=h+2,this.indices[p++]=h,this.indices[p++]=h+1,this.indices[p++]=h+1,this.indices[p++]=h+3,this.indices[p++]=h+2);break}u=[t[r+n],t[r+n+1]]}a=yi(c[0],c[1],l[0],l[1],u[0],u[1])?-1:1,d=this.addVertices_(c,l,u,a*Yi*(f||1),d),d=this.addVertices_(c,l,u,a*Wi*(f||1),d),d=this.addVertices_(c,l,u,-a*Hi*(f||1),d),r>e&&(this.indices[p++]=h,this.indices[p++]=v-1,this.indices[p++]=v,this.indices[p++]=h+2,this.indices[p++]=h,this.indices[p++]=y*a>0?v:v-1),this.indices[p++]=h,this.indices[p++]=h+2,this.indices[p++]=h+1,v=h+2,y=a,f&&(d=this.addVertices_(c,l,u,a*Vi*f,d),this.indices[p++]=h+1,this.indices[p++]=h+3,this.indices[p++]=h)}g&&(h=h||d/7,a=Object(Li.a)([c[0],c[1],l[0],l[1],u[0],u[1]],0,6,2)?1:-1,d=this.addVertices_(c,l,u,a*Yi*(f||1),d),d=this.addVertices_(c,l,u,-a*Hi*(f||1),d),this.indices[p++]=h,this.indices[p++]=v-1,this.indices[p++]=v,this.indices[p++]=h+1,this.indices[p++]=h,this.indices[p++]=y*a>0?v:v-1)},e.prototype.addVertices_=function(t,e,i,n,r){return this.vertices[r++]=t[0],this.vertices[r++]=t[1],this.vertices[r++]=e[0],this.vertices[r++]=e[1],this.vertices[r++]=i[0],this.vertices[r++]=i[1],this.vertices[r++]=n,r},e.prototype.isValid_=function(t,e,i,n){var r=i-e;if(r<2*n)return!1;if(r===2*n){var o=[t[e],t[e+1]],s=[t[e+n],t[e+n+1]];return!Object(Z.a)(o,s)}return!0},e.prototype.drawLineString=function(t,e){var i=t.getFlatCoordinates(),n=t.getStride();this.isValid_(i,0,i.length,n)&&(i=Object(ni.d)(i,0,i.length,n,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.drawCoordinates_(i,0,i.length,n))},e.prototype.drawMultiLineString=function(t,e){var i=this.indices.length,n=t.getEnds();n.unshift(0);var r,o,s=t.getFlatCoordinates(),a=t.getStride();if(n.length>1)for(r=1,o=n.length;r<o;++r)if(this.isValid_(s,n[r-1],n[r],a)){var h=Object(ni.d)(s,n[r-1],n[r],a,-this.origin[0],-this.origin[1]);this.drawCoordinates_(h,0,h.length,a)}this.indices.length>i&&(this.startIndices.push(i),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1))},e.prototype.drawPolygonCoordinates=function(t,e,i){var n,r;if(Fi(t,0,t.length,i)||(t.push(t[0]),t.push(t[1])),this.drawCoordinates_(t,0,t.length,i),e.length)for(n=0,r=e.length;n<r;++n)Fi(e[n],0,e[n].length,i)||(e[n].push(e[n][0]),e[n].push(e[n][1])),this.drawCoordinates_(e[n],0,e[n].length,i)},e.prototype.setPolygonStyle=function(t,e){var i=void 0===e?this.indices.length:e;this.startIndices.push(i),this.startIndicesFeature.push(t),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1)},e.prototype.getCurrentIndex=function(){return this.indices.length},e.prototype.finish=function(t){this.verticesBuffer=new xi(this.vertices),this.indicesBuffer=new xi(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.setUpProgram=function(t,e,i,n){var r,o=e.getProgram(Di,ki);return this.defaultLocations_?r=this.defaultLocations_:(r=new Ni(t,o),this.defaultLocations_=r),e.useProgram(o),t.enableVertexAttribArray(r.a_lastPos),t.vertexAttribPointer(r.a_lastPos,2,ri.l,!1,28,0),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,ri.l,!1,28,8),t.enableVertexAttribArray(r.a_nextPos),t.vertexAttribPointer(r.a_nextPos,2,ri.l,!1,28,16),t.enableVertexAttribArray(r.a_direction),t.vertexAttribPointer(r.a_direction,1,ri.l,!1,28,24),t.uniform2fv(r.u_size,i),t.uniform1f(r.u_pixelRatio,n),r},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_lastPos),t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_nextPos),t.disableVertexAttribArray(e.a_direction)},e.prototype.drawReplay=function(t,e,i,n){var r,o,s,a,h=t.getParameter(t.DEPTH_FUNC),c=t.getParameter(t.DEPTH_WRITEMASK);if(n||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),Object(lt.d)(i))for(s=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)o=this.styleIndices_[r],a=this.styles_[r],this.setStrokeStyle_(t,a[0],a[1],a[2]),this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT),s=o;else this.drawReplaySkipping_(t,e,i);n||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(c),t.depthFunc(h))},e.prototype.drawReplaySkipping_=function(t,e,i){var r,o,s,a,h,c,l,u;for(l=this.startIndices.length-2,s=o=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setStrokeStyle_(t,a[0],a[1],a[2]),h=this.styleIndices_[r];l>=0&&this.startIndices[l]>=h;)u=this.startIndices[l],c=this.startIndicesFeature[l],i[Object(n.b)(c).toString()]&&(o!==s&&(this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT)),s=u),l--,o=u;o!==s&&(this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT)),o=s=h}},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,o){var s,a,h,c,l,u,d;for(d=this.startIndices.length-2,h=this.startIndices[d+1],s=this.styleIndices_.length-1;s>=0;--s)for(c=this.styles_[s],this.setStrokeStyle_(t,c[0],c[1],c[2]),l=this.styleIndices_[s];d>=0&&this.startIndices[d]>=l;){if(a=this.startIndices[d],u=this.startIndicesFeature[d],void 0===i[Object(n.b)(u).toString()]&&u.getGeometry()&&(void 0===o||Object(vt.E)(o,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,h);var p=r(u);if(p)return p}d--,h=a}},e.prototype.setStrokeStyle_=function(t,e,i,n){t.uniform4fv(this.defaultLocations_.u_color,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i),t.uniform1f(this.defaultLocations_.u_miterLimit,n)},e.prototype.setFillStrokeStyle=function(t,e){var i=e.getLineCap();this.state_.lineCap=void 0!==i?i:"round";var n=e.getLineDash();this.state_.lineDash=n||_i;var r=e.getLineDashOffset();this.state_.lineDashOffset=r||0;var o=e.getLineJoin();this.state_.lineJoin=void 0!==o?o:"round";var s=e.getColor();s=s instanceof CanvasGradient||s instanceof CanvasPattern?gi:Object(ii.a)(s).map(function(t,e){return 3!=e?t/255:t})||gi;var a=e.getWidth();a=void 0!==a?a:1;var h=e.getMiterLimit();h=void 0!==h?h:10,this.state_.strokeColor&&Object(Z.a)(this.state_.strokeColor,s)&&this.state_.lineWidth===a&&this.state_.miterLimit===h||(this.state_.changed=!0,this.state_.strokeColor=s,this.state_.lineWidth=a,this.state_.miterLimit=h,this.styles_.push([s,a,h]))},e}(pi),Ki=i(33),Zi=new ai(ri.g?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),qi=new hi(ri.g?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}"),$i=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ri.g?"u_projectionMatrix":"b"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ri.g?"u_offsetScaleMatrix":"c"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ri.g?"u_offsetRotateMatrix":"d"),this.u_color=t.getUniformLocation(e,ri.g?"u_color":"e"),this.u_opacity=t.getUniformLocation(e,ri.g?"u_opacity":"f"),this.a_position=t.getAttribLocation(e,ri.g?"a_position":"a")},Ji=i(44),Qi=function(t){this.first_,this.last_,this.head_,this.circular_=void 0===t||t,this.length_=0};Qi.prototype.insertItem=function(t){var e={prev:void 0,next:void 0,data:t},i=this.head_;if(i){var n=i.next;e.prev=i,e.next=n,i.next=e,n&&(n.prev=e),i===this.last_&&(this.last_=e)}else this.first_=e,this.last_=e,this.circular_&&(e.next=e,e.prev=e);this.head_=e,this.length_++},Qi.prototype.removeItem=function(){var t=this.head_;if(t){var e=t.next,i=t.prev;e&&(e.prev=i),i&&(i.next=e),this.head_=e||i,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===t?this.first_=this.head_:this.last_===t&&(this.last_=i?this.head_.prev:this.head_),this.length_--}},Qi.prototype.firstItem=function(){if(this.head_=this.first_,this.head_)return this.head_.data},Qi.prototype.lastItem=function(){if(this.head_=this.last_,this.head_)return this.head_.data},Qi.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data},Qi.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data},Qi.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data},Qi.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data},Qi.prototype.getCurrItem=function(){if(this.head_)return this.head_.data},Qi.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},Qi.prototype.concat=function(t){if(t.head_){if(this.head_){var e=this.head_.next;this.head_.next=t.first_,t.first_.prev=this.head_,e.prev=t.last_,t.last_.next=e,this.length_+=t.length_}else this.head_=t.head_,this.first_=t.first_,this.last_=t.last_,this.length_=t.length_;t.head_=void 0,t.first_=void 0,t.last_=void 0,t.length_=0}},Qi.prototype.getLength=function(){return this.length_};var tn=Qi,en=i(49),nn=function(t){function e(e,i){t.call(this,e,i),this.lineStringReplay=new Xi(e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i){var n=new tn,r=new en.a;this.processFlatCoordinates_(t,i,n,r,!0);var o=this.getMaxCoords_(n);if(e.length){var s,a,h=[];for(s=0,a=e.length;s<a;++s){var c={list:new tn,maxCoords:void 0,rtree:new en.a};h.push(c),this.processFlatCoordinates_(e[s],i,c.list,c.rtree,!1),this.classifyPoints_(c.list,c.rtree,!0),c.maxCoords=this.getMaxCoords_(c.list)}for(h.sort(function(t,e){return e.maxCoords[0]===t.maxCoords[0]?t.maxCoords[1]-e.maxCoords[1]:e.maxCoords[0]-t.maxCoords[0]}),s=0;s<h.length;++s){var l=h[s].list,u=l.firstItem(),d=u,p=void 0;do{if(this.getIntersections_(d,r).length){p=!0;break}d=l.nextItem()}while(u!==d);p||this.bridgeHole_(l,h[s].maxCoords[0],n,o[0],r)&&(r.concat(h[s].rtree),this.classifyPoints_(n,r,!1))}}else this.classifyPoints_(n,r,!1);this.triangulate_(n,r)},e.prototype.processFlatCoordinates_=function(t,e,i,n,r){var o,s,a,h,c,l=Object(Li.a)(t,0,t.length,e),u=this.vertices.length/2,d=[],p=[];if(r===l){for(h=a=this.createPoint_(t[0],t[1],u++),o=e,s=t.length;o<s;o+=e)c=this.createPoint_(t[o],t[o+1],u++),p.push(this.insertItem_(h,c,i)),d.push([Math.min(h.x,c.x),Math.min(h.y,c.y),Math.max(h.x,c.x),Math.max(h.y,c.y)]),h=c;p.push(this.insertItem_(c,a,i)),d.push([Math.min(h.x,c.x),Math.min(h.y,c.y),Math.max(h.x,c.x),Math.max(h.y,c.y)])}else{var f=t.length-e;for(h=a=this.createPoint_(t[f],t[f+1],u++),o=f-e,s=0;o>=s;o-=e)c=this.createPoint_(t[o],t[o+1],u++),p.push(this.insertItem_(h,c,i)),d.push([Math.min(h.x,c.x),Math.min(h.y,c.y),Math.max(h.x,c.x),Math.max(h.y,c.y)]),h=c;p.push(this.insertItem_(c,a,i)),d.push([Math.min(h.x,c.x),Math.min(h.y,c.y),Math.max(h.x,c.x),Math.max(h.y,c.y)])}n.load(d,p)},e.prototype.getMaxCoords_=function(t){var e=t.firstItem(),i=e,n=[i.p0.x,i.p0.y];do{(i=t.nextItem()).p0.x>n[0]&&(n=[i.p0.x,i.p0.y])}while(i!==e);return n},e.prototype.classifyPoints_=function(t,e,i){var n=t.firstItem(),r=n,o=t.nextItem(),s=!1;do{var a=i?yi(o.p1.x,o.p1.y,r.p1.x,r.p1.y,r.p0.x,r.p0.y):yi(r.p0.x,r.p0.y,r.p1.x,r.p1.y,o.p1.x,o.p1.y);void 0===a?(this.removeItem_(r,o,t,e),s=!0,o===n&&(n=t.getNextItem()),o=r,t.prevItem()):r.p1.reflex!==a&&(r.p1.reflex=a,s=!0),r=o,o=t.nextItem()}while(r!==n);return s},e.prototype.bridgeHole_=function(t,e,i,n,r){for(var o=t.firstItem();o.p1.x!==e;)o=t.nextItem();var s,a,h,c,l=o.p1,u={x:n,y:l.y,i:-1},d=1/0,p=this.getIntersections_({p0:l,p1:u},r,!0);for(s=0,a=p.length;s<a;++s){var f=p[s],_=this.calculateIntersection_(l,u,f.p0,f.p1,!0),g=Math.abs(l.x-_[0]);g<d&&void 0!==yi(l.x,l.y,f.p0.x,f.p0.y,f.p1.x,f.p1.y)&&(d=g,c={x:_[0],y:_[1],i:-1},o=f)}if(d===1/0)return!1;if(h=o.p1,d>0){var v=this.getPointsInTriangle_(l,c,o.p1,r);if(v.length){var y=1/0;for(s=0,a=v.length;s<a;++s){var m=v[s],b=Math.atan2(l.y-m.y,u.x-m.x);(b<y||b===y&&m.x<h.x)&&(y=b,h=m)}}}for(o=i.firstItem();o.p1.x!==h.x||o.p1.y!==h.y;)o=i.nextItem();var x={x:l.x,y:l.y,i:l.i,reflex:void 0},E={x:o.p1.x,y:o.p1.y,i:o.p1.i,reflex:void 0};return t.getNextItem().p0=x,this.insertItem_(l,o.p1,t,r),this.insertItem_(E,x,t,r),o.p1=E,t.setFirstItem(),i.concat(t),!0},e.prototype.triangulate_=function(t,e){for(var i=!1,n=this.isSimple_(t,e);t.getLength()>3;)if(n){if(!this.clipEars_(t,e,n,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e,!0))break}else if(!this.clipEars_(t,e,n,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e)){if(!(n=this.isSimple_(t,e))){this.splitPolygon_(t,e);break}i=!this.isClockwise_(t),this.classifyPoints_(t,e,i)}if(3===t.getLength()){var r=this.indices.length;this.indices[r++]=t.getPrevItem().p0.i,this.indices[r++]=t.getCurrItem().p0.i,this.indices[r++]=t.getNextItem().p0.i}},e.prototype.clipEars_=function(t,e,i,n){var r,o,s,a=this.indices.length,h=t.firstItem(),c=t.getPrevItem(),l=h,u=t.nextItem(),d=t.getNextItem(),p=!1;do{if(r=l.p0,o=l.p1,s=u.p1,!1===o.reflex){var f=void 0;f=i?0===this.getPointsInTriangle_(r,o,s,e,!0).length:n?this.diagonalIsInside_(d.p1,s,o,r,c.p0):this.diagonalIsInside_(c.p0,r,o,s,d.p1),(i||0===this.getIntersections_({p0:r,p1:s},e).length)&&f&&(i||!1===r.reflex||!1===s.reflex||Object(Li.a)([c.p0.x,c.p0.y,r.x,r.y,o.x,o.y,s.x,s.y,d.p1.x,d.p1.y],0,10,2)===!n)&&(this.indices[a++]=r.i,this.indices[a++]=o.i,this.indices[a++]=s.i,this.removeItem_(l,u,t,e),u===h&&(h=d),p=!0)}c=t.getPrevItem(),l=t.getCurrItem(),u=t.nextItem(),d=t.getNextItem()}while(l!==h&&t.getLength()>3);return p},e.prototype.resolveSelfIntersections_=function(t,e,i){var n=t.firstItem();t.nextItem();var r=n,o=t.nextItem(),s=!1;do{var a=this.calculateIntersection_(r.p0,r.p1,o.p0,o.p1,i);if(a){var h=!1,c=this.vertices.length,l=this.indices.length,u=c/2,d=t.prevItem();t.removeItem(),e.remove(d),h=d===n;var p=void 0;if(i?(a[0]===r.p0.x&&a[1]===r.p0.y?(t.prevItem(),p=r.p0,o.p0=p,e.remove(r),h=h||r===n):(p=o.p1,r.p1=p,e.remove(o),h=h||o===n),t.removeItem()):(p=this.createPoint_(a[0],a[1],u),r.p1=p,o.p0=p,e.update([Math.min(r.p0.x,r.p1.x),Math.min(r.p0.y,r.p1.y),Math.max(r.p0.x,r.p1.x),Math.max(r.p0.y,r.p1.y)],r),e.update([Math.min(o.p0.x,o.p1.x),Math.min(o.p0.y,o.p1.y),Math.max(o.p0.x,o.p1.x),Math.max(o.p0.y,o.p1.y)],o)),this.indices[l++]=d.p0.i,this.indices[l++]=d.p1.i,this.indices[l++]=p.i,s=!0,h)break}r=t.getPrevItem(),o=t.nextItem()}while(r!==n);return s},e.prototype.isSimple_=function(t,e){var i=t.firstItem(),n=i;do{if(this.getIntersections_(n,e).length)return!1;n=t.nextItem()}while(n!==i);return!0},e.prototype.isClockwise_=function(t){var e=2*t.getLength(),i=new Array(e),n=t.firstItem(),r=n,o=0;do{i[o++]=r.p0.x,i[o++]=r.p0.y,r=t.nextItem()}while(r!==n);return Object(Li.a)(i,0,e,2)},e.prototype.splitPolygon_=function(t,e){var i=t.firstItem(),n=i;do{var r=this.getIntersections_(n,e);if(r.length){var o=r[0],s=this.vertices.length/2,a=this.calculateIntersection_(n.p0,n.p1,o.p0,o.p1),h=this.createPoint_(a[0],a[1],s),c=new tn,l=new en.a;this.insertItem_(h,n.p1,c,l),n.p1=h,e.update([Math.min(n.p0.x,h.x),Math.min(n.p0.y,h.y),Math.max(n.p0.x,h.x),Math.max(n.p0.y,h.y)],n);for(var u=t.nextItem();u!==o;)this.insertItem_(u.p0,u.p1,c,l),e.remove(u),t.removeItem(),u=t.getCurrItem();this.insertItem_(o.p0,h,c,l),o.p0=h,e.update([Math.min(o.p1.x,h.x),Math.min(o.p1.y,h.y),Math.max(o.p1.x,h.x),Math.max(o.p1.y,h.y)],o),this.classifyPoints_(t,e,!1),this.triangulate_(t,e),this.classifyPoints_(c,l,!1),this.triangulate_(c,l);break}n=t.nextItem()}while(n!==i)},e.prototype.createPoint_=function(t,e,i){var n=this.vertices.length;return this.vertices[n++]=t,this.vertices[n++]=e,{x:t,y:e,i:i,reflex:void 0}},e.prototype.insertItem_=function(t,e,i,n){var r={p0:t,p1:e};return i.insertItem(r),n&&n.insert([Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.x,e.x),Math.max(t.y,e.y)],r),r},e.prototype.removeItem_=function(t,e,i,n){i.getCurrItem()===e&&(i.removeItem(),t.p1=e.p1,n.remove(e),n.update([Math.min(t.p0.x,t.p1.x),Math.min(t.p0.y,t.p1.y),Math.max(t.p0.x,t.p1.x),Math.max(t.p0.y,t.p1.y)],t))},e.prototype.getPointsInTriangle_=function(t,e,i,n,r){for(var o=[],s=n.getInExtent([Math.min(t.x,e.x,i.x),Math.min(t.y,e.y,i.y),Math.max(t.x,e.x,i.x),Math.max(t.y,e.y,i.y)]),a=0,h=s.length;a<h;++a)for(var c in s[a]){var l=s[a][c];"object"!=typeof l||r&&!l.reflex||l.x===t.x&&l.y===t.y||l.x===e.x&&l.y===e.y||l.x===i.x&&l.y===i.y||-1!==o.indexOf(l)||!Object(Ki.b)([t.x,t.y,e.x,e.y,i.x,i.y],0,6,2,l.x,l.y)||o.push(l)}return o},e.prototype.getIntersections_=function(t,e,i){for(var n=t.p0,r=t.p1,o=e.getInExtent([Math.min(n.x,r.x),Math.min(n.y,r.y),Math.max(n.x,r.x),Math.max(n.y,r.y)]),s=[],a=0,h=o.length;a<h;++a){var c=o[a];t!==c&&(i||c.p0!==r||c.p1!==n)&&this.calculateIntersection_(n,r,c.p0,c.p1,i)&&s.push(c)}return s},e.prototype.calculateIntersection_=function(t,e,i,n,r){var o=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(0!==o){var s=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/o,a=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/o;if(!r&&s>vi&&s<1-vi&&a>vi&&a<1-vi||r&&s>=0&&s<=1&&a>=0&&a<=1)return[t.x+s*(e.x-t.x),t.y+s*(e.y-t.y)]}},e.prototype.diagonalIsInside_=function(t,e,i,n,r){if(void 0===e.reflex||void 0===n.reflex)return!1;var o=(i.x-n.x)*(e.y-n.y)>(i.y-n.y)*(e.x-n.x),s=(r.x-n.x)*(e.y-n.y)<(r.y-n.y)*(e.x-n.x),a=(t.x-e.x)*(n.y-e.y)>(t.y-e.y)*(n.x-e.x),h=(i.x-e.x)*(n.y-e.y)<(i.y-e.y)*(n.x-e.x),c=n.reflex?s||o:s&&o,l=e.reflex?h||a:h&&a;return c&&l},e.prototype.drawMultiPolygon=function(t,e){var i,n,r,o,s=t.getEndss(),a=t.getStride(),h=this.indices.length,c=this.lineStringReplay.getCurrentIndex(),l=t.getFlatCoordinates(),u=0;for(i=0,n=s.length;i<n;++i){var d=s[i];if(d.length>0){var p=Object(ni.d)(l,u,d[0],a,-this.origin[0],-this.origin[1]);if(p.length){var f=[],_=void 0;for(r=1,o=d.length;r<o;++r)d[r]!==d[r-1]&&(_=Object(ni.d)(l,d[r-1],d[r],a,-this.origin[0],-this.origin[1]),f.push(_));this.lineStringReplay.drawPolygonCoordinates(p,f,a),this.drawCoordinates_(p,f,a)}}u=d[d.length-1]}this.indices.length>h&&(this.startIndices.push(h),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(h),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>c&&this.lineStringReplay.setPolygonStyle(e,c)},e.prototype.drawPolygon=function(t,e){var i=t.getEnds(),n=t.getStride();if(i.length>0){var r=t.getFlatCoordinates().map(Number),o=Object(ni.d)(r,0,i[0],n,-this.origin[0],-this.origin[1]);if(o.length){var s,a,h,c=[];for(s=1,a=i.length;s<a;++s)i[s]!==i[s-1]&&(h=Object(ni.d)(r,i[s-1],i[s],n,-this.origin[0],-this.origin[1]),c.push(h));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(e),this.lineStringReplay.drawPolygonCoordinates(o,c,n),this.drawCoordinates_(o,c,n)}}},e.prototype.finish=function(t){this.verticesBuffer=new xi(this.vertices),this.indicesBuffer=new xi(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(t),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,n=this.lineStringReplay.getDeleteResourcesFunction(t);return function(){t.deleteBuffer(e),t.deleteBuffer(i),n()}},e.prototype.setUpProgram=function(t,e,i,n){var r,o=e.getProgram(Zi,qi);return this.defaultLocations_?r=this.defaultLocations_:(r=new $i(t,o),this.defaultLocations_=r),e.useProgram(o),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,ri.l,!1,8,0),r},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position)},e.prototype.drawReplay=function(t,e,i,n){var r,o,s,a,h=t.getParameter(t.DEPTH_FUNC),c=t.getParameter(t.DEPTH_WRITEMASK);if(n||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),Object(lt.d)(i))for(s=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)o=this.styleIndices_[r],a=this.styles_[r],this.setFillStyle_(t,a),this.drawElements(t,e,o,s),s=o;else this.drawReplaySkipping_(t,e,i);n||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(c),t.depthFunc(h))},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,o){var s,a,h,c,l,u,d;for(d=this.startIndices.length-2,h=this.startIndices[d+1],s=this.styleIndices_.length-1;s>=0;--s)for(c=this.styles_[s],this.setFillStyle_(t,c),l=this.styleIndices_[s];d>=0&&this.startIndices[d]>=l;){if(a=this.startIndices[d],u=this.startIndicesFeature[d],void 0===i[Object(n.b)(u).toString()]&&u.getGeometry()&&(void 0===o||Object(vt.E)(o,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,h);var p=r(u);if(p)return p}d--,h=a}},e.prototype.drawReplaySkipping_=function(t,e,i){var r,o,s,a,h,c,l,u;for(l=this.startIndices.length-2,s=o=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setFillStyle_(t,a),h=this.styleIndices_[r];l>=0&&this.startIndices[l]>=h;)u=this.startIndices[l],c=this.startIndicesFeature[l],i[Object(n.b)(c).toString()]&&(o!==s&&(this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT)),s=u),l--,o=u;o!==s&&(this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT)),o=s=h}},e.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_color,e)},e.prototype.setFillStrokeStyle=function(t,e){var i=t?t.getColor():[0,0,0,0];if(i=i instanceof CanvasGradient||i instanceof CanvasPattern?fi:Object(ii.a)(i).map(function(t,e){return 3!=e?t/255:t})||fi,this.state_.fillColor&&Object(Z.a)(i,this.state_.fillColor)||(this.state_.fillColor=i,this.state_.changed=!0,this.styles_.push(i)),e)this.lineStringReplay.setFillStrokeStyle(null,e);else{var n=new Ji.default({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,n)}},e}(pi),rn=i(55),on=function(t,e){this.space_=e,this.emptyBlocks_=[{x:0,y:0,width:t,height:t}],this.entries_={},this.context_=Object(gt.a)(t,t),this.canvas_=this.context_.canvas};on.prototype.get=function(t){return this.entries_[t]||null},on.prototype.add=function(t,e,i,n,r){for(var o=0,s=this.emptyBlocks_.length;o<s;++o){var a=this.emptyBlocks_[o];if(a.width>=e+this.space_&&a.height>=i+this.space_){var h={offsetX:a.x+this.space_,offsetY:a.y+this.space_,image:this.canvas_};return this.entries_[t]=h,n.call(r,this.context_,a.x+this.space_,a.y+this.space_),this.split_(o,a,e+this.space_,i+this.space_),h}}return null},on.prototype.split_=function(t,e,i,n){var r,o;e.width-i>e.height-n?(r={x:e.x+i,y:e.y,width:e.width-i,height:e.height},o={x:e.x,y:e.y+n,width:i,height:e.height-n},this.updateBlocks_(t,r,o)):(r={x:e.x+i,y:e.y,width:e.width-i,height:n},o={x:e.x,y:e.y+n,width:e.width,height:e.height-n},this.updateBlocks_(t,r,o))},on.prototype.updateBlocks_=function(t,e,i){var n=[t,1];e.width>0&&e.height>0&&n.push(e),i.width>0&&i.height>0&&n.push(i),this.emptyBlocks_.splice.apply(this.emptyBlocks_,n)};var sn=on,an=function(t){var e=t||{};this.currentSize_=void 0!==e.initialSize?e.initialSize:256,this.maxSize_=void 0!==e.maxSize?e.maxSize:void 0!==ri.p?ri.p:2048,this.space_=void 0!==e.space?e.space:1,this.atlases_=[new sn(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new sn(this.currentHitSize_,this.space_)]};an.prototype.getInfo=function(t){var e=this.getInfo_(this.atlases_,t);if(!e)return null;var i=this.getInfo_(this.hitAtlases_,t);return this.mergeInfos_(e,i)},an.prototype.getInfo_=function(t,e){for(var i=0,n=t.length;i<n;++i){var r=t[i].get(e);if(r)return r}return null},an.prototype.mergeInfos_=function(t,e){return{offsetX:t.offsetX,offsetY:t.offsetY,image:t.image,hitImage:e.image}},an.prototype.add=function(t,e,i,n,r,o){if(e+this.space_>this.maxSize_||i+this.space_>this.maxSize_)return null;var s=this.add_(!1,t,e,i,n,o);if(!s)return null;var a=void 0!==r?r:yt.c,h=this.add_(!0,t,e,i,a,o);return this.mergeInfos_(s,h)},an.prototype.add_=function(t,e,i,n,r,o){var s,a,h,c,l=t?this.hitAtlases_:this.atlases_;for(h=0,c=l.length;h<c;++h){if(a=(s=l[h]).add(e,i,n,r,o))return a;if(!a&&h===c-1){var u=void 0;t?(u=Math.min(2*this.currentHitSize_,this.maxSize_),this.currentHitSize_=u):(u=Math.min(2*this.currentSize_,this.maxSize_),this.currentSize_=u),s=new sn(u,this.space_),l.push(s),++c}}return null};var hn=an,cn=function(t){function e(e,i){t.call(this,e,i),this.images_=[],this.textures_=[],this.measureCanvas_=Object(gt.a)(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText=function(t,e){if(this.text_){var i=null,r=2,o=2;switch(t.getType()){case Ke.a.POINT:case Ke.a.MULTI_POINT:r=(i=t.getFlatCoordinates()).length,o=t.getStride();break;case Ke.a.CIRCLE:i=t.getCenter();break;case Ke.a.LINE_STRING:i=t.getFlatMidpoint();break;case Ke.a.MULTI_LINE_STRING:r=(i=t.getFlatMidpoints()).length;break;case Ke.a.POLYGON:i=t.getFlatInteriorPoint();break;case Ke.a.MULTI_POLYGON:r=(i=t.getFlatInteriorPoints()).length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var s,a,h,c,l,u,d,p,f=this.currAtlas_,_=this.text_.split("\n"),g=this.getTextSize_(_),v=Math.round(g[0]*this.textAlign_-this.offsetX_),y=Math.round(g[1]*this.textBaseline_-this.offsetY_),m=this.state_.lineWidth/2*this.state_.scale;for(s=0,a=_.length;s<a;++s)for(l=0,u=f.height*s,h=0,c=(d=_[s].split("")).length;h<c;++h){if(p=f.atlas.getInfo(d[h])){var b=p.image;if(this.anchorX=v-l,this.anchorY=y-u,this.originX=0===h?p.offsetX-m:p.offsetX,this.originY=p.offsetY,this.height=f.height,this.width=0===h||h===d.length-1?f.width[d[h]]+m:f.width[d[h]],this.imageHeight=b.height,this.imageWidth=b.width,0===this.images_.length)this.images_.push(b);else{var x=this.images_[this.images_.length-1];Object(n.b)(x)!=Object(n.b)(b)&&(this.groupIndices.push(this.indices.length),this.images_.push(b))}this.drawText_(i,0,r,o)}l+=this.width}}},e.prototype.getTextSize_=function(t){var e=this,i=this.currAtlas_,n=t.length*i.height;return[t.map(function(t){for(var n=0,r=0,o=t.length;r<o;++r){var s=t[r];i.width[s]||e.addCharToAtlas_(s),n+=i.width[s]?i.width[s]:0}return n}).reduce(function(t,e){return Math.max(t,e)}),n]},e.prototype.drawText_=function(t,e,i,n){for(var r=e,o=i;r<o;r+=n)this.drawCoordinates(t,e,i,n)},e.prototype.addCharToAtlas_=function(t){if(1===t.length){var e=this.currAtlas_,i=this.state_,n=this.measureCanvas_.getContext("2d");n.font=i.font;var r=Math.ceil(n.measureText(t).width*i.scale);e.atlas.add(t,r,e.height,function(e,n,r){e.font=i.font,e.fillStyle=i.fillColor,e.strokeStyle=i.strokeColor,e.lineWidth=i.lineWidth,e.lineCap=i.lineCap,e.lineJoin=i.lineJoin,e.miterLimit=i.miterLimit,e.textAlign="left",e.textBaseline="top",c.a&&i.lineDash&&(e.setLineDash(i.lineDash),e.lineDashOffset=i.lineDashOffset),1!==i.scale&&e.setTransform(i.scale,0,0,i.scale,0,0),i.strokeColor&&e.strokeText(t,n,r),i.fillColor&&e.fillText(t,n,r)})&&(e.width[t]=r)}},e.prototype.finish=function(e){var i=e.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new xi(this.vertices),this.indicesBuffer=new xi(this.indices);this.createTextures(this.textures_,this.images_,{},i),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,t.prototype.finish.call(this,e)},e.prototype.setTextStyle=function(t){var e=this.state_,i=t.getFill(),n=t.getStroke();if(t&&t.getText()&&(i||n)){if(i){var r=i.getColor();e.fillColor=Object(rn.a)(r||fi)}else e.fillColor=null;if(n){var o=n.getColor();e.strokeColor=Object(rn.a)(o||gi),e.lineWidth=n.getWidth()||1,e.lineCap=n.getLineCap()||"round",e.lineDashOffset=n.getLineDashOffset()||0,e.lineJoin=n.getLineJoin()||"round",e.miterLimit=n.getMiterLimit()||10;var s=n.getLineDash();e.lineDash=s?s.slice():_i}else e.strokeColor=null,e.lineWidth=0;e.font=t.getFont()||"10px sans-serif",e.scale=t.getScale()||1,this.text_=t.getText();var a=Qe[t.getTextAlign()],h=Qe[t.getTextBaseline()];this.textAlign_=void 0===a?.5:a,this.textBaseline_=void 0===h?.5:h,this.offsetX_=t.getOffsetX()||0,this.offsetY_=t.getOffsetY()||0,this.rotateWithView=!!t.getRotateWithView(),this.rotation=t.getRotation()||0,this.currAtlas_=this.getAtlas_(e)}else this.text_=""},e.prototype.getAtlas_=function(t){var e=[];for(var i in t)(t[i]||0===t[i])&&(Array.isArray(t[i])?e=e.concat(t[i]):e.push(t[i]));var n=this.calculateHash_(e);if(!this.atlases_[n]){var r=this.measureCanvas_.getContext("2d");r.font=t.font;var o=Math.ceil((1.5*r.measureText("M").width+t.lineWidth/2)*t.scale);this.atlases_[n]={atlas:new hn({space:t.lineWidth+1}),width:{},height:o}}return this.atlases_[n]},e.prototype.calculateHash_=function(t){for(var e="",i=0,n=t.length;i<n;++i)e+=t[i];return e},e.prototype.getTextures=function(t){return this.textures_},e.prototype.getHitDetectionTextures=function(){return this.textures_},e}(Mi),ln=[1,1],un={Circle:Ei,Image:ji,LineString:Xi,Polygon:nn,Text:cn},dn=function(t){function e(e,i,n){t.call(this),this.maxExtent_=i,this.tolerance_=e,this.renderBuffer_=n,this.replaysByZIndex_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addDeclutter=function(t,e){},e.prototype.getDeleteResourcesFunction=function(t){var e,i=[];for(e in this.replaysByZIndex_){var n=this.replaysByZIndex_[e];for(var r in n)i.push(n[r].getDeleteResourcesFunction(t))}return function(){for(var t,e=arguments,n=i.length,r=0;r<n;r++)t=i[r].apply(this,e);return t}},e.prototype.finish=function(t){var e;for(e in this.replaysByZIndex_){var i=this.replaysByZIndex_[e];for(var n in i)i[n].finish(t)}},e.prototype.getReplay=function(t,e){var i=void 0!==t?t.toString():"0",n=this.replaysByZIndex_[i];void 0===n&&(n={},this.replaysByZIndex_[i]=n);var r=n[e];void 0===r&&(r=new(0,un[e])(this.tolerance_,this.maxExtent_),n[e]=r);return r},e.prototype.isEmpty=function(){return Object(lt.d)(this.replaysByZIndex_)},e.prototype.replay=function(t,e,i,n,r,o,s,a){var h,c,l,u,d,p,f=Object.keys(this.replaysByZIndex_).map(Number);for(f.sort(Z.f),h=0,c=f.length;h<c;++h)for(d=this.replaysByZIndex_[f[h].toString()],l=0,u=Je.length;l<u;++l)p=d[Je[l]],void 0!==p&&p.replay(t,e,i,n,r,o,s,a,void 0,!1)},e.prototype.replayHitDetection_=function(t,e,i,n,r,o,s,a,h,c,l){var u,d,p,f,_,g,v=Object.keys(this.replaysByZIndex_).map(Number);for(v.sort(function(t,e){return e-t}),u=0,d=v.length;u<d;++u)for(f=this.replaysByZIndex_[v[u].toString()],p=Je.length-1;p>=0;--p)if(void 0!==(_=f[Je[p]])&&(g=_.replay(t,e,i,n,r,o,s,a,h,c,l)))return g},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s,a,h,c){var l,u=e.getGL();return u.bindFramebuffer(u.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.renderBuffer_&&(l=Object(vt.c)(Object(vt.l)(t),n*this.renderBuffer_)),this.replayHitDetection_(e,t,n,r,ln,s,a,h,function(t){var e=new Uint8Array(4);if(u.readPixels(0,0,1,1,u.RGBA,u.UNSIGNED_BYTE,e),e[3]>0){var i=c(t);if(i)return i}},!0,l)},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r,o,s,a,h){var c=e.getGL();return c.bindFramebuffer(c.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.replayHitDetection_(e,t,n,r,ln,s,a,h,function(t){var e=new Uint8Array(4);return c.readPixels(0,0,1,1,c.RGBA,c.UNSIGNED_BYTE,e),e[3]>0},!1)},e}(ei),pn=function(t){function e(e,i,n,r,o,s,a){t.call(this),this.context_=e,this.center_=i,this.extent_=s,this.pixelRatio_=a,this.size_=o,this.rotation_=r,this.resolution_=n,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText_=function(t,e){var i=this.context_,n=t.getReplay(0,Ze.TEXT);n.setTextStyle(this.textStyle_),n.drawText(e,null),n.finish(i);n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)()},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.drawGeometry=function(t){switch(t.getType()){case Ke.a.POINT:this.drawPoint(t,null);break;case Ke.a.LINE_STRING:this.drawLineString(t,null);break;case Ke.a.POLYGON:this.drawPolygon(t,null);break;case Ke.a.MULTI_POINT:this.drawMultiPoint(t,null);break;case Ke.a.MULTI_LINE_STRING:this.drawMultiLineString(t,null);break;case Ke.a.MULTI_POLYGON:this.drawMultiPolygon(t,null);break;case Ke.a.GEOMETRY_COLLECTION:this.drawGeometryCollection(t,null);break;case Ke.a.CIRCLE:this.drawCircle(t,null)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&Object(vt.E)(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t,e){var i,n,r=t.getGeometriesArray();for(i=0,n=r.length;i<n;++i)this.drawGeometry(r[i])},e.prototype.drawPoint=function(t,e){var i=this.context_,n=new dn(1,this.extent_),r=n.getReplay(0,Ze.IMAGE);r.setImageStyle(this.imageStyle_),r.drawPoint(t,e),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawMultiPoint=function(t,e){var i=this.context_,n=new dn(1,this.extent_),r=n.getReplay(0,Ze.IMAGE);r.setImageStyle(this.imageStyle_),r.drawMultiPoint(t,e),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawLineString=function(t,e){var i=this.context_,n=new dn(1,this.extent_),r=n.getReplay(0,Ze.LINE_STRING);r.setFillStrokeStyle(null,this.strokeStyle_),r.drawLineString(t,e),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawMultiLineString=function(t,e){var i=this.context_,n=new dn(1,this.extent_),r=n.getReplay(0,Ze.LINE_STRING);r.setFillStrokeStyle(null,this.strokeStyle_),r.drawMultiLineString(t,e),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawPolygon=function(t,e){var i=this.context_,n=new dn(1,this.extent_),r=n.getReplay(0,Ze.POLYGON);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawPolygon(t,e),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawMultiPolygon=function(t,e){var i=this.context_,n=new dn(1,this.extent_),r=n.getReplay(0,Ze.POLYGON);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawMultiPolygon(t,e),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.drawCircle=function(t,e){var i=this.context_,n=new dn(1,this.extent_),r=n.getReplay(0,Ze.CIRCLE);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawCircle(t,e),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(n,t)},e.prototype.setImageStyle=function(t){this.imageStyle_=t},e.prototype.setFillStrokeStyle=function(t,e){this.fillStyle_=t,this.strokeStyle_=e},e.prototype.setTextStyle=function(t){this.textStyle_=t},e}($e),fn=i(28),_n=function(t){function e(e){t.call(this),this.layer_=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,r){return t.forEachLoadedTile(e,n,r,function(t){i[n]||(i[n]={}),i[n][t.tileCoord.toString()]=t})}},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleImageChange_=function(t){t.target.getState()===fn.a.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=fn.a.LOADED&&e!=fn.a.ERROR&&Object(p.a)(t,l.a.CHANGE,this.handleImageChange_,this),e==fn.a.IDLE&&(t.load(),e=t.getState()),e==fn.a.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==bt.a.READY&&this.changed()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var r=Object(n.b)(t).toString();r in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[r])}.bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i,r){var o=Object(n.b)(e).toString(),s=i.toString();o in t?s in t[o]?t[o][s].extend(r):t[o][s]=r:(t[o]={},t[o][s]=r)},e.prototype.manageTilePyramid=function(t,e,i,r,o,s,a,h,c,l){var u=Object(n.b)(e).toString();u in t.wantedTiles||(t.wantedTiles[u]={});var d,p,f,_,g,v,y=t.wantedTiles[u],m=t.tileQueue;for(v=i.getMinZoom();v<=a;++v)for(p=i.getTileRangeForExtentAndZ(s,v,p),f=i.getResolution(v),_=p.minX;_<=p.maxX;++_)for(g=p.minY;g<=p.maxY;++g)a-v<=h?((d=e.getTile(v,_,g,r,o)).getState()==ht.a.IDLE&&(y[d.getKey()]=!0,m.isKeyQueued(d.getKey())||m.enqueue([d,u,i.getTileCoordCenter(d.tileCoord),f])),void 0!==c&&c.call(l,d)):e.useTile(v,_,g,o)},e}(i(66).a);_n.prototype.forEachFeatureAtCoordinate=yt.c,_n.prototype.hasFeatureAtCoordinate=yt.a;var gn=_n,vn=new ai(ri.g?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}"),yn=new hi(ri.g?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}"),mn=function(t,e){this.u_texCoordMatrix=t.getUniformLocation(e,ri.g?"u_texCoordMatrix":"d"),this.u_projectionMatrix=t.getUniformLocation(e,ri.g?"u_projectionMatrix":"e"),this.u_opacity=t.getUniformLocation(e,ri.g?"u_opacity":"f"),this.u_texture=t.getUniformLocation(e,ri.g?"u_texture":"g"),this.a_position=t.getAttribLocation(e,ri.g?"a_position":"b"),this.a_texCoord=t.getAttribLocation(e,ri.g?"a_texCoord":"c")},bn=function(t){function e(e,i){t.call(this,i),this.mapRenderer=e,this.arrayBuffer_=new xi([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=Object(Ot.c)(),this.projectionMatrix=Object(Ot.c)(),this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.defaultLocations_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindFramebuffer=function(t,e){var i=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=e){var n=function(t,e,i){t.isContextLost()||(t.deleteFramebuffer(e),t.deleteTexture(i))}.bind(null,i,this.framebuffer,this.texture);t.postRenderFunctions.push(n);var r=Ii(i,e,e),o=i.createFramebuffer();i.bindFramebuffer(ri.n,o),i.framebufferTexture2D(ri.n,ri.d,ri.z,r,0),this.texture=r,this.framebuffer=o,this.framebufferDimension=e}else i.bindFramebuffer(ri.n,this.framebuffer)},e.prototype.composeFrame=function(t,e,i){this.dispatchComposeEvent_(Xe.a.PRECOMPOSE,i,t),i.bindBuffer(ri.a,this.arrayBuffer_);var n,r=i.getGL(),o=i.getProgram(vn,yn);this.defaultLocations_?n=this.defaultLocations_:(n=new mn(r,o),this.defaultLocations_=n),i.useProgram(o)&&(r.enableVertexAttribArray(n.a_position),r.vertexAttribPointer(n.a_position,2,ri.l,!1,16,0),r.enableVertexAttribArray(n.a_texCoord),r.vertexAttribPointer(n.a_texCoord,2,ri.l,!1,16,8),r.uniform1i(n.u_texture,0)),r.uniformMatrix4fv(n.u_texCoordMatrix,!1,di(this.tmpMat4_,this.getTexCoordMatrix())),r.uniformMatrix4fv(n.u_projectionMatrix,!1,di(this.tmpMat4_,this.getProjectionMatrix())),r.uniform1f(n.u_opacity,e.opacity),r.bindTexture(ri.z,this.getTexture()),r.drawArrays(ri.F,0,4),this.dispatchComposeEvent_(Xe.a.POSTCOMPOSE,i,t)},e.prototype.dispatchComposeEvent_=function(t,e,i){var n=this.getLayer();if(n.hasListener(t)){var r=i.viewState,o=r.resolution,s=i.pixelRatio,a=i.extent,h=r.center,c=r.rotation,l=i.size,u=new pn(e,h,o,c,l,a,s),d=new Ve(t,u,i,null,e);n.dispatchEvent(d)}},e.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},e.prototype.getTexture=function(){return this.texture},e.prototype.getProjectionMatrix=function(){return this.projectionMatrix},e.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},e.prototype.prepareFrame=function(t,e,i){},e.prototype.forEachLayerAtPixel=function(t,e,i,n){},e}(gn),xn=function(t){function e(e,i){t.call(this,e,i),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createTexture_=function(t){var e=t.getImage();return Si(this.mapRenderer.getGL(),e,ri.c,ri.c)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){var o=this.getLayer(),s=o.getSource(),a=e.viewState.resolution,h=e.viewState.rotation,c=e.skippedFeatureUids;return s.forEachFeatureAtCoordinate(t,a,h,i,c,function(t){return n.call(r,t,o)})},e.prototype.prepareFrame=function(t,e,i){var n=this.mapRenderer.getGL(),r=t.pixelRatio,o=t.viewState,s=o.center,a=o.resolution,h=o.rotation,c=this.image_,l=this.texture,u=this.getLayer().getSource(),d=t.viewHints,p=t.extent;if(void 0!==e.extent&&(p=Object(vt.A)(p,e.extent)),!d[_t.a.ANIMATING]&&!d[_t.a.INTERACTING]&&!Object(vt.G)(p)){var f=o.projection;if(!We.a){var _=u.getProjection();_&&(f=_)}var g=u.getImage(p,a,r,f);if(g)if(this.loadImage(g)&&(c=g,l=this.createTexture_(g),this.texture)){var v=function(t,e){t.isContextLost()||t.deleteTexture(e)}.bind(null,n,this.texture);t.postRenderFunctions.push(v)}}if(c){var y=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(y.width,y.height,r,s,a,h,c.getExtent()),this.hitTransformationMatrix_=null;var m=this.texCoordMatrix;Object(Ot.f)(m),Object(Ot.h)(m,1,-1),Object(Ot.j)(m,0,-1),this.image_=c,this.texture=l}return!!c},e.prototype.updateProjectionMatrix_=function(t,e,i,n,r,o,s){var a=t*r,h=e*r,c=this.projectionMatrix;Object(Ot.f)(c),Object(Ot.h)(c,2*i/a,2*i/h),Object(Ot.g)(c,-o),Object(Ot.j)(c,s[0]-n[0],s[1]-n[1]),Object(Ot.h)(c,(s[2]-s[0])/2,(s[3]-s[1])/2),Object(Ot.j)(c,1,1)},e.prototype.hasFeatureAtCoordinate=function(t,e){return void 0!==this.forEachFeatureAtCoordinate(t,e,0,yt.b,this)},e.prototype.forEachLayerAtPixel=function(t,e,i,n){if(this.image_&&this.image_.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==yt.c){var r=Object(Ot.a)(e.pixelToCoordinateTransform,t.slice());return this.forEachFeatureAtCoordinate(r,e,0,yt.b,this)?i.call(n,this.getLayer(),null):void 0}var o=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(e.size,o));var s=Object(Ot.a)(this.hitTransformationMatrix_,t.slice());if(!(s[0]<0||s[0]>o[0]||s[1]<0||s[1]>o[1])){this.hitCanvasContext_||(this.hitCanvasContext_=Object(gt.a)(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),s[0],s[1],1,1,0,0,1,1);var a=this.hitCanvasContext_.getImageData(0,0,1,1).data;return a[3]>0?i.call(n,this.getLayer(),a):void 0}}},e.prototype.getHitTransformationMatrix_=function(t,e){var i=Object(Ot.c)();Object(Ot.j)(i,-1,-1),Object(Ot.h)(i,2/t[0],2/t[1]),Object(Ot.j)(i,0,t[1]),Object(Ot.h)(i,1,-1);var n=Object(Ot.d)(this.projectionMatrix.slice()),r=Object(Ot.c)();return Object(Ot.j)(r,0,e[1]),Object(Ot.h)(r,1,-1),Object(Ot.h)(r,e[0]/2,e[1]/2),Object(Ot.j)(r,1,1),Object(Ot.e)(r,n),Object(Ot.e)(r,i),r},e}(bn);xn.handles=function(t){return t.getType()===He.a.IMAGE},xn.create=function(t,e){return new xn(t,e)};var En=xn,Cn=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function On(t,e,i){return e+":"+t+":"+(i?Object(ii.b)(i):"null")}Cn.prototype.clear=function(){this.cache_={},this.cacheSize_=0},Cn.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},Cn.prototype.get=function(t,e,i){var n=On(t,e,i);return n in this.cache_?this.cache_[n]:null},Cn.prototype.set=function(t,e,i,n){var r=On(t,e,i);this.cache_[r]=n,++this.cacheSize_},Cn.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var Tn=new Cn,wn=function(t){function e(e){t.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.registerLayerRenderers=function(t){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,t)},e.prototype.getLayerRendererConstructors=function(){return this.layerRendererConstructors_},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;Object(Ot.b)(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Object(Ot.d)(Object(Ot.i)(n,i))},e.prototype.removeLayerRenderers=function(){for(var t in this.layerRenderers_)this.removeLayerRendererByKey_(t).dispose()},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,o,s,a){var h,c=e.viewState,l=c.resolution;function u(t,i){var s=Object(n.b)(t).toString(),a=e.layerStates[Object(n.b)(i)].managed;if(!(s in e.skippedFeatureUids)||a)return r.call(o,t,a?i:null)}var d=c.projection,p=t;if(d.canWrapX()){var f=d.getExtent(),_=Object(vt.D)(f),g=t[0];if(g<f[0]||g>f[2])p=[g+_*Math.ceil((f[0]-g)/_),t[1]]}var v,y=e.layerStatesArray;for(v=y.length-1;v>=0;--v){var m=y[v],b=m.layer;if(Object(It.b)(m,l)&&s.call(a,b)){var x=this.getLayerRenderer(b);if(b.getSource()&&(h=x.forEachFeatureAtCoordinate(b.getSource().getWrapX()?p:t,e,i,u,o)),h)return h}}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,yt.b,this,n,r)},e.prototype.getLayerRenderer=function(t){var e=Object(n.b)(t).toString();if(e in this.layerRenderers_)return this.layerRenderers_[e];for(var i,r=0,o=this.layerRendererConstructors_.length;r<o;++r){var s=this.layerRendererConstructors_[r];if(s.handles(t)){i=s.create(this,t);break}}if(!i)throw new Error("Unable to create renderer for layer: "+t.getType());return this.layerRenderers_[e]=i,this.layerRendererListeners_[e]=Object(p.a)(i,l.a.CHANGE,this.handleLayerRendererChange_,this),i},e.prototype.getLayerRendererByKey=function(t){return this.layerRenderers_[t]},e.prototype.getLayerRenderers=function(){return this.layerRenderers_},e.prototype.getMap=function(){return this.map_},e.prototype.handleLayerRendererChange_=function(){this.map_.render()},e.prototype.removeLayerRendererByKey_=function(t){var e=this.layerRenderers_[t];return delete this.layerRenderers_[t],Object(p.e)(this.layerRendererListeners_[t]),delete this.layerRendererListeners_[t],e},e.prototype.removeUnusedLayerRenderers_=function(t,e){for(var i in this.layerRenderers_)e&&i in e.layerStates||this.removeLayerRendererByKey_(i).dispose()},e.prototype.scheduleExpireIconCache=function(t){t.postRenderFunctions.push(Rn)},e.prototype.scheduleRemoveUnusedLayerRenderers=function(t){for(var e in this.layerRenderers_)if(!(e in t.layerStates))return void t.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},e}(ve.a);function Rn(t,e){Tn.expire()}function In(t,e){return t.zIndex-e.zIndex}wn.prototype.renderFrame=yt.c;var Sn=wn,Pn=i(52),Mn=function(t){function e(e){t.call(this,e);var i=e.getViewport();this.canvas_=document.createElement("CANVAS"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=Rt.e,i.insertBefore(this.canvas_,i.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=Object(gt.a)(),this.renderedVisible_=!0,this.gl_=Object(ri.K)(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new Pi(this.canvas_,this.gl_),Object(p.a)(this.canvas_,wi.LOST,this.handleWebGLContextLost,this),Object(p.a)(this.canvas_,wi.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new Pn.a,this.focus_=null,this.tileTextureQueue_=new dt(function(t){var e=t[1],i=t[2],n=e[0]-this.focus_[0],r=e[1]-this.focus_[1];return 65536*Math.log(i)+Math.sqrt(n*n+r*r)/i}.bind(this),function(t){return t[0].getKey()}),this.loadNextTileTexture_=function(t,e){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var i=this.tileTextureQueue_.dequeue(),n=i[0],r=i[3],o=i[4];this.bindTileTexture(n,r,o,ri.o,ri.o)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindTileTexture=function(t,e,i,n,r){var o=this.getGL(),s=t.getKey();if(this.textureCache_.containsKey(s)){var a=this.textureCache_.get(s);o.bindTexture(ri.z,a.texture),a.magFilter!=n&&(o.texParameteri(ri.z,ri.A,n),a.magFilter=n),a.minFilter!=r&&(o.texParameteri(ri.z,ri.B,r),a.minFilter=r)}else{var h=o.createTexture();if(o.bindTexture(ri.z,h),i>0){var c=this.clipTileContext_.canvas,l=this.clipTileContext_;this.clipTileCanvasWidth_!==e[0]||this.clipTileCanvasHeight_!==e[1]?(c.width=e[0],c.height=e[1],this.clipTileCanvasWidth_=e[0],this.clipTileCanvasHeight_=e[1]):l.clearRect(0,0,e[0],e[1]),l.drawImage(t.getImage(),i,i,e[0],e[1],0,0,e[0],e[1]),o.texImage2D(ri.z,0,ri.s,ri.s,ri.G,c)}else o.texImage2D(ri.z,0,ri.s,ri.s,ri.G,t.getImage());o.texParameteri(ri.z,ri.A,n),o.texParameteri(ri.z,ri.B,r),o.texParameteri(ri.z,ri.C,ri.c),o.texParameteri(ri.z,ri.D,ri.c),this.textureCache_.set(s,{texture:h,magFilter:n,minFilter:r})}},e.prototype.dispatchComposeEvent_=function(t,e){var i=this.getMap();if(i.hasListener(t)){var n=this.context_,r=e.extent,o=e.size,s=e.viewState,a=e.pixelRatio,h=s.resolution,c=s.center,l=s.rotation,u=new pn(n,c,h,l,o,r,a),d=new Ve(t,u,e,null,n);i.dispatchEvent(d)}},e.prototype.disposeInternal=function(){var e=this.getGL();e.isContextLost()||this.textureCache_.forEach(function(t){t&&e.deleteTexture(t.texture)}),this.context_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.expireCache_=function(t,e){for(var i,n=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>1024;){if(i=this.textureCache_.peekLast())n.deleteTexture(i.texture);else{if(+this.textureCache_.peekLastKey()==e.index)break;--this.textureCacheFrameMarkerCount_}this.textureCache_.pop()}},e.prototype.getContext=function(){return this.context_},e.prototype.getGL=function(){return this.gl_},e.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},e.prototype.handleWebGLContextLost=function(t){t.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;var e=this.getLayerRenderers();for(var i in e){e[i].handleWebGLContextLost()}},e.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},e.prototype.initializeGL_=function(){var t=this.gl_;t.activeTexture(ri.y),t.blendFuncSeparate(ri.u,ri.r,ri.q,ri.r),t.disable(ri.f),t.disable(ri.h),t.disable(ri.t),t.disable(ri.w)},e.prototype.isTileTextureLoaded=function(t){return this.textureCache_.containsKey(t.getKey())},e.prototype.renderFrame=function(t){var e=this.getContext(),i=this.getGL();if(i.isContextLost())return!1;if(!t)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=t.focus,this.textureCache_.set((-t.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchComposeEvent_(Xe.a.PRECOMPOSE,t);var n=[],r=t.layerStatesArray;Object(Z.h)(r,In);var o,s,a,h=t.viewState.resolution;for(o=0,s=r.length;o<s;++o)a=r[o],Object(It.b)(a,h)&&a.sourceState==bt.a.READY&&this.getLayerRenderer(a.layer).prepareFrame(t,a,e)&&n.push(a);var c=t.size[0]*t.pixelRatio,l=t.size[1]*t.pixelRatio;for(this.canvas_.width==c&&this.canvas_.height==l||(this.canvas_.width=c,this.canvas_.height=l),i.bindFramebuffer(ri.n,null),i.clearColor(0,0,0,0),i.clear(ri.e),i.enable(ri.b),i.viewport(0,0,this.canvas_.width,this.canvas_.height),o=0,s=n.length;o<s;++o)a=n[o],this.getLayerRenderer(a.layer).composeFrame(t,a,e);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(t),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>1024&&t.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(t.postRenderFunctions.push(this.loadNextTileTexture_),t.animate=!0),this.dispatchComposeEvent_(Xe.a.POSTCOMPOSE,t),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s){var a;if(this.getGL().isContextLost())return!1;var h,c=e.viewState,l=e.layerStatesArray;for(h=l.length-1;h>=0;--h){var u=l[h],d=u.layer;if(Object(It.b)(u,c.resolution)&&o.call(s,d))if(a=this.getLayerRenderer(d).forEachFeatureAtCoordinate(t,e,i,n,r))return a}},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r){var o=!1;if(this.getGL().isContextLost())return!1;var s,a=e.viewState,h=e.layerStatesArray;for(s=h.length-1;s>=0;--s){var c=h[s],l=c.layer;if(Object(It.b)(c,a.resolution)&&n.call(r,l))if(o=this.getLayerRenderer(l).hasFeatureAtCoordinate(t,e))return!0}return o},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){if(this.getGL().isContextLost())return!1;var a,h,c=e.viewState,l=e.layerStatesArray;for(h=l.length-1;h>=0;--h){var u=l[h],d=u.layer;if(Object(It.b)(u,c.resolution)&&o.call(r,d))if(a=this.getLayerRenderer(d).forEachLayerAtPixel(t,e,n,r))return a}},e}(Sn),jn=i(50),Ln=new ai(ri.g?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}"),An=new hi(ri.g?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}"),Fn=function(t,e){this.u_tileOffset=t.getUniformLocation(e,ri.g?"u_tileOffset":"d"),this.u_texture=t.getUniformLocation(e,ri.g?"u_texture":"e"),this.a_position=t.getAttribLocation(e,ri.g?"a_position":"b"),this.a_texCoord=t.getAttribLocation(e,ri.g?"a_texCoord":"c")},Dn=function(t){function e(e,i){t.call(this,e,i),this.fragmentShader_=Ln,this.vertexShader_=An,this.locations_=null,this.renderArrayBuffer_=new xi([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_),t.prototype.disposeInternal.call(this)},e.prototype.createLoadedTileFinder=function(t,e,i){var n=this.mapRenderer;return function(r,o){return t.forEachLoadedTile(e,r,o,function(t){var e=n.isTileTextureLoaded(t);return e&&(i[r]||(i[r]={}),i[r][t.tileCoord.toString()]=t),e})}},e.prototype.handleWebGLContextLost=function(){t.prototype.handleWebGLContextLost.call(this),this.locations_=null},e.prototype.prepareFrame=function(t,e,i){var n,r=this.mapRenderer,o=i.getGL(),s=t.viewState,a=s.projection,h=this.getLayer(),c=h.getSource(),l=c.getTileGridForProjection(a),u=l.getZForResolution(s.resolution),d=l.getResolution(u),p=c.getTilePixelSize(u,t.pixelRatio,a),f=p[0]/Object(Ct.c)(l.getTileSize(u),this.tmpSize_)[0],_=d/f,g=c.getTilePixelRatio(f)*c.getGutter(a),v=s.center,y=t.extent,m=l.getTileRangeForExtentAndZ(y,u);if(this.renderedTileRange_&&this.renderedTileRange_.equals(m)&&this.renderedRevision_==c.getRevision())n=this.renderedFramebufferExtent_;else{var b=m.getSize(),x=Math.max(b[0]*p[0],b[1]*p[1]),E=Object(Nt.e)(x),C=_*E,O=l.getOrigin(u),T=O[0]+m.minX*p[0]*_,w=O[1]+m.minY*p[1]*_;n=[T,w,T+C,w+C],this.bindFramebuffer(t,E),o.viewport(0,0,E,E),o.clearColor(0,0,0,0),o.clear(ri.e),o.disable(ri.b);var R=i.getProgram(this.fragmentShader_,this.vertexShader_);i.useProgram(R),this.locations_||(this.locations_=new Fn(o,R)),i.bindBuffer(ri.a,this.renderArrayBuffer_),o.enableVertexAttribArray(this.locations_.a_position),o.vertexAttribPointer(this.locations_.a_position,2,ri.l,!1,16,0),o.enableVertexAttribArray(this.locations_.a_texCoord),o.vertexAttribPointer(this.locations_.a_texCoord,2,ri.l,!1,16,8),o.uniform1i(this.locations_.u_texture,0);var I={};I[u]={};var S,P,M,j,L,A,F=this.createLoadedTileFinder(c,a,I),D=h.getUseInterimTilesOnError(),k=!0,N=Object(vt.i)(),G=new jn.b(0,0,0,0);for(j=m.minX;j<=m.maxX;++j)for(L=m.minY;L<=m.maxY;++L)if(P=c.getTile(u,j,L,f,a),void 0===e.extent||(A=l.getTileCoordExtent(P.tileCoord,N),Object(vt.E)(A,e.extent))){if((M=P.getState())==ht.a.LOADED||M==ht.a.EMPTY||M==ht.a.ERROR&&!D||(P=P.getInterimTile()),(M=P.getState())==ht.a.LOADED){if(r.isTileTextureLoaded(P)){I[u][P.tileCoord.toString()]=P;continue}}else if(M==ht.a.EMPTY||M==ht.a.ERROR&&!D)continue;k=!1,l.forEachTileCoordParentTileRange(P.tileCoord,F,null,G,N)||(S=l.getTileCoordChildTileRange(P.tileCoord,G,N))&&F(u+1,S)}var z=Object.keys(I).map(Number);z.sort(Z.f);for(var U=new Float32Array(4),B=0,Y=z.length;B<Y;++B){var W=I[z[B]];for(var H in W)P=W[H],A=l.getTileCoordExtent(P.tileCoord,N),U[0]=2*(A[2]-A[0])/C,U[1]=2*(A[3]-A[1])/C,U[2]=2*(A[0]-n[0])/C-1,U[3]=2*(A[1]-n[1])/C-1,o.uniform4fv(this.locations_.u_tileOffset,U),r.bindTileTexture(P,p,g*f,ri.o,ri.o),o.drawArrays(ri.F,0,4)}k?(this.renderedTileRange_=m,this.renderedFramebufferExtent_=n,this.renderedRevision_=c.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,t.animate=!0)}this.updateUsedTiles(t.usedTiles,c,u,m);var V=r.getTileTextureQueue();this.manageTilePyramid(t,c,l,f,a,y,u,h.getPreload(),function(t){t.getState()!=ht.a.LOADED||r.isTileTextureLoaded(t)||V.isKeyQueued(t.getKey())||V.enqueue([t,l.getTileCoordCenter(t.tileCoord),l.getResolution(t.tileCoord[0]),p,g*f])},this),this.scheduleExpireCache(t,c);var X=this.texCoordMatrix;return Object(Ot.f)(X),Object(Ot.j)(X,(Math.round(v[0]/d)*d-n[0])/(n[2]-n[0]),(Math.round(v[1]/d)*d-n[1])/(n[3]-n[1])),0!==s.rotation&&Object(Ot.g)(X,s.rotation),Object(Ot.h)(X,t.size[0]*s.resolution/(n[2]-n[0]),t.size[1]*s.resolution/(n[3]-n[1])),Object(Ot.j)(X,-.5,-.5),!0},e.prototype.forEachLayerAtPixel=function(t,e,i,n){if(this.framebuffer){var r=[t[0]/e.size[0],(e.size[1]-t[1])/e.size[1]],o=Object(Ot.a)(this.texCoordMatrix,r.slice()),s=[o[0]*this.framebufferDimension,o[1]*this.framebufferDimension],a=this.mapRenderer.getContext().getGL();a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer);var h=new Uint8Array(4);return a.readPixels(s[0],s[1],1,1,a.RGBA,a.UNSIGNED_BYTE,h),h[3]>0?i.call(n,this.getLayer(),h):void 0}},e}(bn);Dn.handles=function(t){return t.getType()===He.a.TILE},Dn.create=function(t,e){return new Dn(t,e)};var kn=Dn,Nn=.5,Gn={Point:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=fn.a.LOADED)return;var o=t.getReplay(i.getZIndex(),Ze.IMAGE);o.setImageStyle(r,t.addDeclutter(!1)),o.drawPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),Ze.TEXT);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},LineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),Ze.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),Ze.TEXT);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},Polygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),Ze.POLYGON);s.setFillStrokeStyle(r,o),s.drawPolygon(e,n)}var a=i.getText();if(a){var h=t.getReplay(i.getZIndex(),Ze.TEXT);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,n)}},MultiPoint:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=fn.a.LOADED)return;var o=t.getReplay(i.getZIndex(),Ze.IMAGE);o.setImageStyle(r,t.addDeclutter(!1)),o.drawMultiPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),Ze.TEXT);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},MultiLineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),Ze.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawMultiLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),Ze.TEXT);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(o||r){var s=t.getReplay(i.getZIndex(),Ze.POLYGON);s.setFillStrokeStyle(r,o),s.drawMultiPolygon(e,n)}var a=i.getText();if(a){var h=t.getReplay(i.getZIndex(),Ze.TEXT);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var r,o,s=e.getGeometriesArray();for(r=0,o=s.length;r<o;++r){var a=Gn[s[r].getType()];a(t,s[r],i,n)}},Circle:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),Ze.CIRCLE);s.setFillStrokeStyle(r,o),s.drawCircle(e,n)}var a=i.getText();if(a){var h=t.getReplay(i.getZIndex(),Ze.TEXT);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,n)}}};function zn(t,e){return Object(n.b)(t)-Object(n.b)(e)}function Un(t,e){var i=Bn(t,e);return i*i}function Bn(t,e){return Nn*t/e}function Yn(t,e,i,n,r,o){var s=!1,a=i.getImage();if(a){var h=a.getImageState();h==fn.a.LOADED||h==fn.a.ERROR?a.unlistenImageChange(r,o):(h==fn.a.IDLE&&a.load(),h=a.getImageState(),a.listenImageChange(r,o),s=!0)}return function(t,e,i,n){var r=i.getGeometryFunction()(e);if(!r)return;var o=r.getSimplifiedGeometry(n);if(i.getRenderer())!function t(e,i,n,r){if(i.getType()==Ke.a.GEOMETRY_COLLECTION){for(var o=i.getGeometries(),s=0,a=o.length;s<a;++s)t(e,o[s],n,r);return}var h=e.getReplay(n.getZIndex(),Ze.DEFAULT);h.drawCustom(i,r,n.getRenderer())}(t,o,i,e);else{var s=Gn[o.getType()];s(t,o,i,e)}}(t,e,i,n),s}var Wn=function(t){function e(e,i){t.call(this,e,i),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Object(vt.i)(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.composeFrame=function(t,e,i){this.layerState_=e;var n=t.viewState,r=this.replayGroup_,o=t.size,s=t.pixelRatio,a=this.mapRenderer.getGL();r&&!r.isEmpty()&&(a.enable(a.SCISSOR_TEST),a.scissor(0,0,o[0]*s,o[1]*s),r.replay(i,n.center,n.resolution,n.rotation,o,s,e.opacity,e.managed?t.skippedFeatureUids:{}),a.disable(a.SCISSOR_TEST))},e.prototype.disposeInternal=function(){var e=this.replayGroup_;if(e){var i=this.mapRenderer.getContext();e.getDeleteResourcesFunction(i)(),this.replayGroup_=null}t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,o){if(this.replayGroup_&&this.layerState_){var s=this.mapRenderer.getContext(),a=e.viewState,h=this.getLayer(),c=this.layerState_,l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,s,a.center,a.resolution,a.rotation,e.size,e.pixelRatio,c.opacity,{},function(t){var e=Object(n.b)(t).toString();if(!(e in l))return l[e]=!0,r.call(o,t,h)})}},e.prototype.hasFeatureAtCoordinate=function(t,e){if(this.replayGroup_&&this.layerState_){var i=this.mapRenderer.getContext(),n=e.viewState,r=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(t,i,n.center,n.resolution,n.rotation,e.size,e.pixelRatio,r.opacity,e.skippedFeatureUids)}return!1},e.prototype.forEachLayerAtPixel=function(t,e,i,n){var r=Object(Ot.a)(e.pixelToCoordinateTransform,t.slice());return this.hasFeatureAtCoordinate(r,e)?i.call(n,this.getLayer(),null):void 0},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t,e,i){var n=this.getLayer(),r=n.getSource(),o=t.viewHints[_t.a.ANIMATING],s=t.viewHints[_t.a.INTERACTING],a=n.getUpdateWhileAnimating(),h=n.getUpdateWhileInteracting();if(!this.dirty_&&!a&&o||!h&&s)return!0;var c=t.extent,l=t.viewState,u=l.projection,d=l.resolution,p=t.pixelRatio,f=n.getRevision(),_=n.getRenderBuffer(),g=n.getRenderOrder();void 0===g&&(g=zn);var v=Object(vt.c)(c,_*d);if(!this.dirty_&&this.renderedResolution_==d&&this.renderedRevision_==f&&this.renderedRenderOrder_==g&&Object(vt.g)(this.renderedExtent_,v))return!0;this.replayGroup_&&t.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(i)),this.dirty_=!1;var y=new dn(Bn(d,p),v,n.getRenderBuffer());r.loadFeatures(v,d,u);var m=function(t){var e,i=t.getStyleFunction()||n.getStyleFunction();if(i&&(e=i(t,d)),e){var r=this.renderFeature(t,d,p,e,y);this.dirty_=this.dirty_||r}};if(g){var b=[];r.forEachFeatureInExtent(v,function(t){b.push(t)},this),b.sort(g),b.forEach(m.bind(this))}else r.forEachFeatureInExtent(v,m,this);return y.finish(i),this.renderedResolution_=d,this.renderedRevision_=f,this.renderedRenderOrder_=g,this.renderedExtent_=v,this.replayGroup_=y,!0},e.prototype.renderFeature=function(t,e,i,n,r){if(!n)return!1;var o=!1;if(Array.isArray(n))for(var s=n.length-1;s>=0;--s)o=Yn(r,t,n[s],Un(e,i),this.handleStyleImageChange_,this)||o;else o=Yn(r,t,n,Un(e,i),this.handleStyleImageChange_,this)||o;return o},e}(bn);Wn.handles=function(t){return t.getType()===He.a.VECTOR},Wn.create=function(t,e){return new Wn(t,e)};var Hn=Wn,Vn=function(t){function e(e){(e=Object(lt.a)({},e)).controls||(e.controls=function(t){var e=t||{},i=new r.a;return(void 0===e.zoom||e.zoom)&&i.push(new At(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new Lt(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new Pt(e.attributionOptions)),i}()),e.interactions||(e.interactions=function(t){var e=t||{},i=new r.a,n=new Dt(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new ge),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new Ht({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new ue({kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new Ge),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new Ye({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new Pe),i.push(new je({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new Fe({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new Re({duration:e.zoomDuration})),i}()),t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){var t=new Mn(this);return t.registerLayerRenderers([En,kn,Hn]),t},e}(Tt);e.default=Vn},function(t,e,i){"use strict";i.r(e);var n=i(29),r=i(3),o=i(8),s=i(23),a=i(34),h=i(4),c=function(t){function e(e,i,n){t.call(this);var r=n||{};this.tileCoord=e,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===r.transition?250:r.transition,this.transitionStarts_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(h.a.CHANGE)},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==o.a.LOADED)return t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==o.a.LOADED){t.interimTile=null;break}t.getState()==o.a.LOADING?e=t:t.getState()==o.a.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){this.state=t,this.changed()},e.prototype.load=function(){},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:Object(s.a)(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(a.a),l=i(15),u=i(2);function d(){var t=Object(l.a)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}var p=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,s),this.crossOrigin_=r,this.src_=n,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.imageListenerKeys_=null,this.tileLoadFunction_=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==o.a.LOADING&&(this.unlistenImage_(),this.image_=d()),this.interimTile&&this.interimTile.dispose(),this.state=o.a.ABORT,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=o.a.ERROR,this.unlistenImage_(),this.image_=d(),this.changed()},e.prototype.handleImageLoad_=function(){this.image_.naturalWidth&&this.image_.naturalHeight?this.state=o.a.LOADED:this.state=o.a.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==o.a.ERROR&&(this.state=o.a.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==o.a.IDLE&&(this.state=o.a.LOADING,this.changed(),this.imageListenerKeys_=[Object(u.b)(this.image_,h.a.ERROR,this.handleImageError_,this),Object(u.b)(this.image_,h.a.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(u.e),this.imageListenerKeys_=null},e}(c);function f(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function _(t,e,i){return t+"/"+e+"/"+i}function g(t){return _(t[0],t[1],t[2])}var v=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.expireCache=function(t){for(;this.canExpireCache();){var e=this.peekLast(),i=e.tileCoord[0].toString();if(i in t&&t[i].contains(e.tileCoord))break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(g(e.tileCoord)),e.dispose())},this)}},e}(i(52).a),y=i(16),m=i(1),b=i(5);function x(t,e,i,n){var r=i-t,o=n-e,s=Math.sqrt(r*r+o*o);return[Math.round(i+r/s),Math.round(n+o/s)]}var E=function(t,e,i,n,r){this.sourceProj_=t,this.targetProj_=e;var o={},s=Object(y.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=s(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Object(m.D)(n)==Object(m.D)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Object(m.D)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Object(m.D)(this.targetProj_.getExtent()):null;var a=Object(m.B)(i),h=Object(m.C)(i),c=Object(m.v)(i),l=Object(m.u)(i),u=this.transformInv_(a),d=this.transformInv_(h),p=this.transformInv_(c),f=this.transformInv_(l);if(this.addQuad_(a,h,c,l,u,d,p,f,10),this.wrapsXInSource_){var _=1/0;this.triangles_.forEach(function(t,e,i){_=Math.min(_,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-_>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-_>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-_>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-_>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}};E.prototype.addTriangle_=function(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})},E.prototype.addQuad_=function(t,e,i,n,r,o,s,a,h){var c=Object(m.b)([r,o,s,a]),l=this.sourceWorldWidth_?Object(m.D)(c)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&l>.5&&l<1,p=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var f=Object(m.b)([t,e,i,n]);p|=Object(m.D)(f)/this.targetWorldWidth_>.25}!d&&this.sourceProj_.isGlobal()&&l&&(p|=l>.25)}if(p||!this.maxSourceExtent_||Object(m.E)(c,this.maxSourceExtent_)){if(!(p||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(h>0))return;p=!0}if(h>0){if(!p){var _,g=[(t[0]+i[0])/2,(t[1]+i[1])/2],v=this.transformInv_(g);if(d)_=(Object(b.d)(r[0],u)+Object(b.d)(s[0],u))/2-Object(b.d)(v[0],u);else _=(r[0]+s[0])/2-v[0];var y=(r[1]+s[1])/2-v[1];p=_*_+y*y>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var x=[(e[0]+i[0])/2,(e[1]+i[1])/2],E=this.transformInv_(x),C=[(n[0]+t[0])/2,(n[1]+t[1])/2],O=this.transformInv_(C);this.addQuad_(t,e,x,C,r,o,E,O,h-1),this.addQuad_(C,x,i,n,O,E,s,a,h-1)}else{var T=[(t[0]+e[0])/2,(t[1]+e[1])/2],w=this.transformInv_(T),R=[(i[0]+n[0])/2,(i[1]+n[1])/2],I=this.transformInv_(R);this.addQuad_(t,T,R,n,r,w,I,a,h-1),this.addQuad_(T,e,i,R,w,o,s,I,h-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,n,r,s,a),this.addTriangle_(t,e,i,r,o,s)}},E.prototype.calculateSourceExtent=function(){var t=Object(m.i)();return this.triangles_.forEach(function(e,i,n){var r=e.source;Object(m.q)(t,r[0]),Object(m.q)(t,r[1]),Object(m.q)(t,r[2])}),t},E.prototype.getTriangles=function(){return this.triangles_};var C=E,O=function(t){function e(e,i,r,s,a,h,c,l,u,d,p){t.call(this,a,o.a.IDLE),this.renderEdges_=void 0!==p&&p,this.pixelRatio_=c,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=s,this.wrappedTileCoord_=h||a,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var f=s.getTileCoordExtent(this.wrappedTileCoord_),_=this.targetTileGrid_.getExtent(),g=this.sourceTileGrid_.getExtent(),v=_?Object(m.A)(f,_):f;if(0!==Object(m.t)(v)){var x=e.getExtent();x&&(g=g?Object(m.A)(g,x):x);var E=s.getResolution(this.wrappedTileCoord_[0]),O=function(t,e,i,n){var r=Object(y.transform)(i,e,t),o=Object(y.getPointResolution)(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var h=t.getExtent();if(!h||Object(m.f)(h,r)){var c=Object(y.getPointResolution)(t,o,r)/o;isFinite(c)&&c>0&&(o/=c)}return o}(e,r,Object(m.w)(v),E);if(!isFinite(O)||O<=0)this.state=o.a.EMPTY;else{var T=void 0!==d?d:n.b;if(this.triangulation_=new C(e,r,v,g,O*T),0!==this.triangulation_.getTriangles().length){this.sourceZ_=i.getZForResolution(O);var w=this.triangulation_.calculateSourceExtent();if(g&&(e.canWrapX()?(w[1]=Object(b.a)(w[1],g[1],g[3]),w[3]=Object(b.a)(w[3],g[1],g[3])):w=Object(m.A)(w,g)),Object(m.t)(w)){for(var R=i.getTileRangeForExtentAndZ(w,this.sourceZ_),I=R.minX;I<=R.maxX;I++)for(var S=R.minY;S<=R.maxY;S++){var P=u(this.sourceZ_,I,S,c);P&&this.sourceTiles_.push(P)}0===this.sourceTiles_.length&&(this.state=o.a.EMPTY)}else this.state=o.a.EMPTY}else this.state=o.a.EMPTY}}else this.state=o.a.EMPTY}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==o.a.LOADING&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==o.a.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=o.a.ERROR;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],s=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,i,n,r,o,s,a,h,c,u){var d=Object(l.a)(Math.round(i*t),Math.round(i*e));if(0===h.length)return d.canvas;d.scale(i,i);var p=Object(m.i)();h.forEach(function(t,e,i){Object(m.p)(p,t.extent)});var f=Object(m.D)(p),_=Object(m.z)(p),g=Object(l.a)(Math.round(i*f/n),Math.round(i*_/n)),v=i/n;h.forEach(function(t,e,i){var n=t.extent[0]-p[0],r=-(t.extent[3]-p[3]),o=Object(m.D)(t.extent),s=Object(m.z)(t.extent);g.drawImage(t.image,c,c,t.image.width-2*c,t.image.height-2*c,n*v,r*v,o*v,s*v)});var y=Object(m.B)(s);return a.getTriangles().forEach(function(t,e,r){var s=t.source,a=t.target,h=s[0][0],c=s[0][1],l=s[1][0],u=s[1][1],f=s[2][0],_=s[2][1],v=(a[0][0]-y[0])/o,m=-(a[0][1]-y[1])/o,E=(a[1][0]-y[0])/o,C=-(a[1][1]-y[1])/o,O=(a[2][0]-y[0])/o,T=-(a[2][1]-y[1])/o,w=h,R=c;h=0,c=0;var I=[[l-=w,u-=R,0,0,E-v],[f-=w,_-=R,0,0,O-v],[0,0,l,u,C-m],[0,0,f,_,T-m]],S=Object(b.f)(I);if(S){d.save(),d.beginPath();var P=(v+E+O)/3,M=(m+C+T)/3,j=x(P,M,v,m),L=x(P,M,E,C),A=x(P,M,O,T);d.moveTo(L[0],L[1]),d.lineTo(j[0],j[1]),d.lineTo(A[0],A[1]),d.clip(),d.transform(S[0],S[2],S[1],S[3],v,m),d.translate(p[0]-w,p[3]-R),d.scale(n/i,-n/i),d.drawImage(g.canvas,0,0),d.restore()}}),u&&(d.save(),d.strokeStyle="black",d.lineWidth=1,a.getTriangles().forEach(function(t,e,i){var n=t.target,r=(n[0][0]-y[0])/o,s=-(n[0][1]-y[1])/o,a=(n[1][0]-y[0])/o,h=-(n[1][1]-y[1])/o,c=(n[2][0]-y[0])/o,l=-(n[2][1]-y[1])/o;d.beginPath(),d.moveTo(a,h),d.lineTo(r,s),d.lineTo(c,l),d.closePath(),d.stroke()}),d.restore()),d.canvas}(n,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),s,h,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=o.a.LOADED}this.changed()},e.prototype.load=function(){if(this.state==o.a.IDLE){this.state=o.a.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){var r=e.getState();if(r==o.a.IDLE||r==o.a.LOADING){t++;var s=Object(u.a)(e,h.a.CHANGE,function(i){var n=e.getState();n!=o.a.LOADED&&n!=o.a.ERROR&&n!=o.a.EMPTY||(Object(u.e)(s),0===--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(s)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,i){t.getState()==o.a.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(u.e),this.sourcesListenerKeys_=null},e}(c),T=i(11);function w(t,e){var i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,h){return s?t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(r,function(){return(-s[2]-1).toString()}).replace(o,function(){var t=s[0],i=e.getFullTileRange(t);return Object(T.a)(i,55),(i.getHeight()+s[2]).toString()}):void 0}}function R(t,e){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=w(t[r],e);return function(t){if(1===t.length)return t[0];return function(e,i,n){if(e){var r=function(t){return(t[1]<<t[0])+t[2]}(e),o=Object(b.d)(r,t.length);return t[o](e,i,n)}}}(n)}function I(t,e,i){}var S=i(9),P=i(17),M=i(27),j=i(70),L=i(47),A=i(48),F=i(10),D=i(18),k=i(50),N=i(13),G=[0,0,0],z=function(t){var e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Object(T.a)(Object(N.d)(this.resolutions_,function(t,e){return e-t},!0),17),!t.origins)for(var i=0,n=this.resolutions_.length-1;i<n;++i)if(e){if(this.resolutions_[i]/this.resolutions_[i+1]!==e){e=void 0;break}}else e=this.resolutions_[i]/this.resolutions_[i+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Object(T.a)(this.origins_.length==this.resolutions_.length,20));var r=t.extent;void 0===r||this.origin_||this.origins_||(this.origin_=Object(m.B)(r)),Object(T.a)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Object(T.a)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:L.b,Object(T.a)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==r?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){return new k.b(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):r&&this.calculateTileRanges_(r)};z.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),r=n.minX,o=n.maxX;r<=o;++r)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,r,s])},z.prototype.forEachTileCoordParentTileRange=function(t,e,i,n,r){var o,s,a,h=null,c=t[0]-1;for(2===this.zoomFactor_?(s=t[1],a=t[2]):h=this.getTileCoordExtent(t,r);c>=this.minZoom;){if(2===this.zoomFactor_?(s=Math.floor(s/2),a=Math.floor(a/2),o=Object(k.a)(s,s,a,a,n)):o=this.getTileRangeForExtentAndZ(h,c,n),e.call(i,c,o))return!0;--c}return!1},z.prototype.getExtent=function(){return this.extent_},z.prototype.getMaxZoom=function(){return this.maxZoom},z.prototype.getMinZoom=function(){return this.minZoom},z.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},z.prototype.getResolution=function(t){return this.resolutions_[t]},z.prototype.getResolutions=function(){return this.resolutions_},z.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],r=2*t[2];return Object(k.a)(n,n+1,r,r+1,e)}var o=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},z.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),r=this.getResolution(t),o=Object(M.c)(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*o[0]*r,a=n[0]+(e.maxX+1)*o[0]*r,h=n[1]+e.minY*o[1]*r,c=n[1]+(e.maxY+1)*o[1]*r;return Object(m.j)(s,h,a,c,i)},z.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=G;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n);var r=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,n),Object(k.a)(r,n[1],o,n[2],i)},z.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Object(M.c)(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]+(t[2]+.5)*n[1]*i]},z.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=Object(M.c)(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,s=i[1]+t[2]*r[1]*n,a=o+r[0]*n,h=s+r[1]*n;return Object(m.j)(o,s,a,h,e)},z.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},z.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,r){var o=this.getZForResolution(i),s=i/this.getResolution(o),a=this.getOrigin(o),h=Object(M.c)(this.getTileSize(o),this.tmpSize_),c=n?.5:0,l=n?0:.5,u=Math.floor((t-a[0])/i+c),d=Math.floor((e-a[1])/i+l),p=s*u/h[0],_=s*d/h[1];return n?(p=Math.ceil(p)-1,_=Math.ceil(_)-1):(p=Math.floor(p),_=Math.floor(_)),f(o,p,_,r)},z.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,r){var o=this.getOrigin(i),s=this.getResolution(i),a=Object(M.c)(this.getTileSize(i),this.tmpSize_),h=n?.5:0,c=n?0:.5,l=Math.floor((t-o[0])/s+h),u=Math.floor((e-o[1])/s+c),d=l/a[0],p=u/a[1];return n?(d=Math.ceil(d)-1,p=Math.ceil(p)-1):(d=Math.floor(d),p=Math.floor(p)),f(i,d,p,r)},z.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},z.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},z.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},z.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},z.prototype.getZForResolution=function(t,e){var i=Object(N.e)(this.resolutions_,t,e||0);return Object(b.a)(i,this.minZoom,this.maxZoom)},z.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i};var U=z;function B(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){return function(t,e,i,n){var r=void 0!==n?n:A.a.TOP_LEFT,o=Y(t,e,i);return new U({extent:t,origin:Object(m.x)(t,r),resolutions:o,tileSize:i})}(W(t),e,i,n)}(t),t.setDefaultTileGrid(e)),e}function Y(t,e,i){for(var n=void 0!==e?e:L.a,r=Object(m.z)(t),o=Object(m.D)(t),s=Object(M.c)(void 0!==i?i:L.b),a=Math.max(o/s[0],r/s[1]),h=n+1,c=new Array(h),l=0;l<h;++l)c[l]=a/Math.pow(2,l);return c}function W(t){var e=(t=Object(y.get)(t)).getExtent();if(!e){var i=180*D.a[D.b.DEGREES]/t.getMetersPerUnit();e=Object(m.j)(-i,-i,i,i)}return e}var H=function(t){function e(e){t.call(this,{attributions:e.attributions,extent:e.extent,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new v(e.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:e.transition}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var s,a,h,c=!0,l=i.minX;l<=i.maxX;++l)for(var u=i.minY;u<=i.maxY;++u)a=_(e,l,u),h=!1,r.containsKey(a)&&(h=(s=r.get(a)).getState()===o.a.LOADED)&&(h=!1!==n(s)),h||(c=!1);return c},e.prototype.getGutter=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,r){},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:B(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!Object(y.equivalent)(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),o=Object(M.c)(n.getTileSize(t),this.tmpSize);return 1==r?o:Object(M.b)(o,r,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],r=t.getTileCoordCenter(e),o=W(i);if(Object(m.f)(o,r))return e;var s=Object(m.D)(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,t.getTileCoordForCoordAndZ(r,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var o,s=e.getExtent();return!(o=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||o.containsXY(n,r)}(t,n)?t:null},e.prototype.refresh=function(){this.tileCache.clear(),this.changed()},e}(j.a);H.prototype.useTile=S.c;var V=function(t){function e(e,i){t.call(this,e),this.tile=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P.a),X="tileloadstart",K="tileloadend",Z="tileloaderror",q=function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition}),this.tileLoadFunction=e.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):I,this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),e.tileUrlFunction&&this.setTileUrlFunction(e.tileUrlFunction),this.tileLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=Object(r.b)(i),s=i.getState();s==o.a.LOADING?(this.tileLoadingKeys_[n]=!0,e=X):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=s==o.a.ERROR?Z:s==o.a.LOADED||s==o.a.ABORT?K:void 0),void 0!=e&&this.dispatchEvent(new V(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=function(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n,r=i[1].charCodeAt(0),o=i[2].charCodeAt(0);for(n=r;n<=o;++n)e.push(t.replace(i[0],String.fromCharCode(n)));return e}if(i=i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}(t);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):R(e,this.tileGrid),t)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):R(t,this.tileGrid),e)},e.prototype.useTile=function(t,e,i){var n=_(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(H);function $(t,e){t.getImage().src=e}q.prototype.fixedTileUrlFunction;var J=function(t){function e(e){var i=e||{},n=void 0!==i.projection?i.projection:"EPSG:3857",r=void 0!==i.tileGrid?i.tileGrid:function(t){var e={};return Object(F.a)(e,void 0!==t?t:{}),void 0===e.extent&&(e.extent=Object(y.get)("EPSG:3857").getExtent()),e.resolutions=Y(e.extent,e.maxZoom,e.tileSize),delete e.maxZoom,new U(e)}({extent:W(n),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:n,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:$,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:p,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){if(!n.a)return t.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1},e.prototype.expireCache=function(e,i){if(n.a){var r=this.getTileCacheForProjection(e);for(var o in this.tileCache.expireCache(this.tileCache==r?i:{}),this.tileCacheForProjection){var s=this.tileCacheForProjection[o];s.expireCache(s==r?i:{})}}else t.prototype.expireCache.call(this,e,i)},e.prototype.getGutter=function(t){return n.a&&this.getProjection()&&t&&!Object(y.equivalent)(this.getProjection(),t)?0:this.getGutterInternal()},e.prototype.getGutterInternal=function(){return 0},e.prototype.getOpaque=function(e){return!(n.a&&this.getProjection()&&e&&!Object(y.equivalent)(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(e){if(!n.a)return t.prototype.getTileGridForProjection.call(this,e);var i=this.getProjection();if(!this.tileGrid||i&&!Object(y.equivalent)(i,e)){var o=Object(r.b)(e).toString();return o in this.tileGridForProjection||(this.tileGridForProjection[o]=B(e)),this.tileGridForProjection[o]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(e){if(!n.a)return t.prototype.getTileCacheForProjection.call(this,e);var i=this.getProjection();if(!i||Object(y.equivalent)(i,e))return this.tileCache;var o=Object(r.b)(e).toString();return o in this.tileCacheForProjection||(this.tileCacheForProjection[o]=new v(this.tileCache.highWaterMark)),this.tileCacheForProjection[o]},e.prototype.createTile_=function(t,e,i,n,r,s){var a=[t,e,i],c=this.getTileCoordForTileUrlFunction(a,r),l=c?this.tileUrlFunction(c,n,r):void 0,d=new this.tileClass(a,void 0!==l?o.a.IDLE:o.a.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=s,Object(u.a)(d,h.a.CHANGE,this.handleTileChange,this),d},e.prototype.getTile=function(t,e,i,r,o){var s=this.getProjection();if(n.a&&s&&o&&!Object(y.equivalent)(s,o)){var a,h=this.getTileCacheForProjection(o),c=[t,e,i],l=g(c);h.containsKey(l)&&(a=h.get(l));var u=this.getKey();if(a&&a.key==u)return a;var d=this.getTileGridForProjection(s),p=this.getTileGridForProjection(o),f=this.getTileCoordForTileUrlFunction(c,o),_=new O(s,d,o,p,c,f,this.getTilePixelRatio(r),this.getGutterInternal(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,s)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return _.key=u,a?(_.interimTile=a,_.refreshInterimChain(),h.replace(l,_)):h.set(l,_),_}return this.getTileInternal(t,e,i,r,s||o)},e.prototype.getTileInternal=function(t,e,i,n,r){var s=null,a=_(t,e,i),h=this.getKey();if(this.tileCache.containsKey(a)){if((s=this.tileCache.get(a)).key!=h){var c=s;s=this.createTile_(t,e,i,n,r,h),c.getState()==o.a.IDLE?s.interimTile=c.interimTile:s.interimTile=c,s.refreshInterimChain(),this.tileCache.replace(a,s)}}else s=this.createTile_(t,e,i,n,r,h),this.tileCache.set(a,s);return s},e.prototype.setRenderReprojectionEdges=function(t){if(n.a&&this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){if(n.a){var i=Object(y.get)(t);if(i){var o=Object(r.b)(i).toString();o in this.tileGridForProjection||(this.tileGridForProjection[o]=e)}}},e}(q)),Q='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',tt=(function(t){function e(e){var i,n=e||{};i=void 0!==n.attributions?n.attributions:[Q];var r=void 0!==n.crossOrigin?n.crossOrigin:"anonymous",o=void 0!==n.url?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";t.call(this,{attributions:i,cacheSize:n.cacheSize,crossOrigin:r,opaque:void 0===n.opaque||n.opaque,maxZoom:void 0!==n.maxZoom?n.maxZoom:19,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,url:o,wrapX:n.wrapX})}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e}(J),['Map tiles by <a href="https://stamen.com/">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.',Q]),et={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},it={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:1,maxZoom:16}},nt=function(t){function e(e){var i=e.layer.indexOf("-"),n=-1==i?e.layer:e.layer.slice(0,i),r=it[n],o=et[e.layer],s=void 0!==e.url?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+o.extension;t.call(this,{attributions:tt,cacheSize:e.cacheSize,crossOrigin:"anonymous",maxZoom:void 0!=e.maxZoom?e.maxZoom:r.maxZoom,minZoom:void 0!=e.minZoom?e.minZoom:r.minZoom,opaque:o.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:s,wrapX:e.wrapX})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(J);e.default=nt},function(t,e,i){"use strict";i.r(e);var n=i(3),r=i(22),o=i(24),s=i(36),a=i(13),h=i(11),c=i(2),l=i(17),u=i(4),d=i(1),p=i(9),f={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};function _(t,e){return function(t,e,i,n){return function(r,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(r,o,s):t,!0),e.getType()==f.ARRAY_BUFFER&&(a.responseType="arraybuffer"),a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r,o=e.getType();o==f.JSON||o==f.TEXT?r=a.responseText:o==f.XML?(r=a.responseXML)||(r=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==f.ARRAY_BUFFER&&(r=a.response),r?i.call(this,e.readFeatures(r,{featureProjection:s}),e.readProjection(r),e.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),a.onerror=function(){n.call(this)}.bind(this),a.send()}}(t,e,function(t,e){this.addFeatures(t)},p.c)}function g(t,e){return[[-1/0,-1/0,1/0,1/0]]}var v=i(10),y=i(70),m=i(32),b="addfeature",x="changefeature",E="clear",C="removefeature",O=i(49);i.d(e,"VectorSourceEvent",function(){return T});var T=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(l.a),w=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:void 0,state:m.a.READY,wrapX:void 0===i.wrapX||i.wrapX}),this.loader_=p.c,this.format_=i.format,this.overlaps_=void 0==i.overlaps||i.overlaps,this.url_=i.url,void 0!==i.loader?this.loader_=i.loader:void 0!==this.url_&&(Object(h.a)(this.format_,7),this.loader_=_(this.url_,this.format_)),this.strategy_=void 0!==i.strategy?i.strategy:g;var n,o,s=void 0===i.useSpatialIndex||i.useSpatialIndex;this.featuresRtree_=s?new O.a:null,this.loadedExtentsRtree_=new O.a,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,i.features instanceof r.a?o=(n=i.features).getArray():Array.isArray(i.features)&&(o=i.features),s||void 0!==n||(n=new r.a(o)),void 0!==o&&this.addFeaturesInternal(o),void 0!==n&&this.bindFeaturesCollection_(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(y.a);w.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},w.prototype.addFeatureInternal=function(t){var e=Object(n.b)(t).toString();if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new T(b,t))}},w.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Object(c.a)(e,u.a.CHANGE,this.handleFeatureChange_,this),Object(c.a)(e,s.a.PROPERTYCHANGE,this.handleFeatureChange_,this)]},w.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n?n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e:(Object(h.a)(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),i},w.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},w.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],r=[],o=0,s=t.length;o<s;o++){var a=t[o],h=Object(n.b)(a).toString();this.addToIndex_(h,a)&&i.push(a)}for(var c=0,l=i.length;c<l;c++){var u=i[c],d=Object(n.b)(u).toString();this.setupChangeEvents_(d,u);var p=u.getGeometry();if(p){var f=p.getExtent();e.push(f),r.push(u)}else this.nullGeometryFeatures_[d]=u}this.featuresRtree_&&this.featuresRtree_.load(e,r);for(var _=0,g=i.length;_<g;_++)this.dispatchEvent(new T(b,i[_]))},w.prototype.bindFeaturesCollection_=function(t){var e=!1;Object(c.a)(this,b,function(i){e||(e=!0,t.push(i.feature),e=!1)}),Object(c.a)(this,C,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),Object(c.a)(t,o.a.ADD,function(t){e||(e=!0,this.addFeature(t.element),e=!1)},this),Object(c.a)(t,o.a.REMOVE,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)},this),this.featuresCollection_=t},w.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(c.e)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var n=new T(E);this.dispatchEvent(n),this.changed()},w.prototype.forEachFeature=function(t){return this.featuresRtree_?this.featuresRtree_.forEach(t):this.featuresCollection_?this.featuresCollection_.forEach(t):void 0},w.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0})},w.prototype.forEachFeatureInExtent=function(t,e){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(t,e):this.featuresCollection_?this.featuresCollection_.forEach(e):void 0},w.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}})},w.prototype.getFeaturesCollection=function(){return this.featuresCollection_},w.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Object(v.d)(this.nullGeometryFeatures_)||Object(a.b)(t,Object(v.c)(this.nullGeometryFeatures_))),t},w.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e},w.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},w.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],h=e||p.b;return this.featuresRtree_.forEachInExtent(a,function(t){if(h(t)){var e=t.getGeometry(),c=s;if((s=e.closestPointXY(i,n,o,s))<c){r=t;var l=Math.sqrt(s);a[0]=i-l,a[1]=n-l,a[2]=i+l,a[3]=n+l}}}),r},w.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},w.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},w.prototype.getFormat=function(){return this.format_},w.prototype.getOverlaps=function(){return this.overlaps_},w.prototype.getResolutions=function(){},w.prototype.getUrl=function(){return this.url_},w.prototype.handleFeatureChange_=function(t){var e=t.target,i=Object(n.b)(e).toString(),r=e.getGeometry();if(r){var o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var s=e.getId();if(void 0!==s){var a=s.toString();i in this.undefIdIndex_?(delete this.undefIdIndex_[i],this.idIndex_[a]=e):this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else i in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[i]=e);this.changed(),this.dispatchEvent(new T(x,e))},w.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:Object(n.b)(t).toString()in this.undefIdIndex_},w.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Object(v.d)(this.nullGeometryFeatures_)},w.prototype.loadFeatures=function(t,e,i){for(var n=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e),s=function(t,s){var a=o[t];r.forEachInExtent(a,function(t){return Object(d.g)(t.extent,a)})||(n.loader_.call(n,a,e,i),r.insert(a,{extent:a.slice()}))},a=0,h=o.length;a<h;++a)s(a)},w.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,function(i){if(Object(d.o)(i.extent,t))return e=i,!0}),e&&i.remove(e)},w.prototype.removeFeature=function(t){var e=Object(n.b)(t).toString();e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},w.prototype.removeFeatureInternal=function(t){var e=Object(n.b)(t).toString();this.featureChangeKeys_[e].forEach(c.e),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i?delete this.idIndex_[i.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new T(C,t))},w.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},w.prototype.setLoader=function(t){this.loader_=t};e.default=w},function(t,e,i){"use strict";i.r(e);var n=i(35),r=i(31),o="preload",s="useInterimTilesOnError",a=i(10),h=function(t){function e(e){var i=e||{},r=Object(a.a)({},i);delete r.preload,delete r.useInterimTilesOnError,t.call(this,r),this.setPreload(void 0!==i.preload?i.preload:0),this.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),this.type=n.a.TILE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPreload=function(){return this.get(o)},e.prototype.setPreload=function(t){this.set(o,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(s)},e.prototype.setUseInterimTilesOnError=function(t){this.set(s,t)},e}(r.a);h.prototype.getSource;e.default=h},function(t,e,i){"use strict";i.r(e);var n=i(35),r=i(31),o={IMAGE:"image",VECTOR:"vector"},s=i(10),a=i(51);i.d(e,"RenderType",function(){return h});var h={IMAGE:"image",VECTOR:"vector"},c="renderOrder",l=function(t){function e(e){var i=e||{},r=Object(s.a)({},i);delete r.style,delete r.renderBuffer,delete r.updateWhileAnimating,delete r.updateWhileInteracting,t.call(this,r),this.declutter_=void 0!==i.declutter&&i.declutter,this.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(i.style),this.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,this.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,this.renderMode_=i.renderMode||o.VECTOR,this.type=n.a.VECTOR}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(c)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(c,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:a.createDefaultStyle,this.styleFunction_=null===t?void 0:Object(a.toFunction)(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(r.a);l.prototype.getSource;e.default=l},function(t,e,i){"use strict";i.r(e);var n=i(45),r=i(12),o={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"},s=i(21),a=i(15),h=i(2),c=i(1),l={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},u=function(t){function e(e){t.call(this),this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("DIV"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container "+s.d,this.element.style.position="absolute",this.autoPan=void 0!==e.autoPan&&e.autoPan,this.autoPanAnimation=e.autoPanAnimation||{},this.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,Object(h.a)(this,Object(r.b)(l.ELEMENT),this.handleElementChanged,this),Object(h.a)(this,Object(r.b)(l.MAP),this.handleMapChanged,this),Object(h.a)(this,Object(r.b)(l.OFFSET),this.handleOffsetChanged,this),Object(h.a)(this,Object(r.b)(l.POSITION),this.handlePositionChanged,this),Object(h.a)(this,Object(r.b)(l.POSITIONING),this.handlePositioningChanged,this),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(void 0!==e.positioning?e.positioning:o.TOP_LEFT),void 0!==e.position&&this.setPosition(e.position)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getElement=function(){return this.get(l.ELEMENT)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(l.MAP)},e.prototype.getOffset=function(){return this.get(l.OFFSET)},e.prototype.getPosition=function(){return this.get(l.POSITION)},e.prototype.getPositioning=function(){return this.get(l.POSITIONING)},e.prototype.handleElementChanged=function(){Object(a.d)(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(Object(a.e)(this.element),Object(h.e)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=Object(h.a)(t,n.a.POSTRENDER,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(l.POSITION)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(l.ELEMENT,t)},e.prototype.setMap=function(t){this.set(l.MAP,t)},e.prototype.setOffset=function(t){this.set(l.OFFSET,t)},e.prototype.setPosition=function(t){this.set(l.POSITION,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),n=this.getRect(i,[Object(a.c)(i),Object(a.b)(i)]),r=this.autoPanMargin;if(!Object(c.g)(e,n)){var o=n[0]-e[0],s=e[2]-n[2],h=n[1]-e[1],l=e[3]-n[3],u=[0,0];if(o<0?u[0]=o-r:s<0&&(u[0]=Math.abs(s)+r),h<0?u[1]=h-r:l<0&&(u[1]=Math.abs(l)+r),0!==u[0]||0!==u[1]){var d=t.getView().getCenter(),p=t.getPixelFromCoordinate(d),f=[p[0]+u[0],p[1]+u[1]];t.getView().animate({center:t.getCoordinateFromPixel(f),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]},e.prototype.setPositioning=function(t){this.set(l.POSITIONING,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);var s=n[0],a=n[1];if(r==o.BOTTOM_RIGHT||r==o.CENTER_RIGHT||r==o.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_=i.left="");var h=Math.round(e[0]-t[0]-s)+"px";this.rendered.right_!=h&&(this.rendered.right_=i.right=h)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),r!=o.BOTTOM_CENTER&&r!=o.CENTER_CENTER&&r!=o.TOP_CENTER||(s-=this.element.offsetWidth/2);var c=Math.round(t[0]+s)+"px";this.rendered.left_!=c&&(this.rendered.left_=i.left=c)}if(r==o.BOTTOM_LEFT||r==o.BOTTOM_CENTER||r==o.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_=i.top="");var l=Math.round(e[1]-t[1]-a)+"px";this.rendered.bottom_!=l&&(this.rendered.bottom_=i.bottom=l)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),r!=o.CENTER_LEFT&&r!=o.CENTER_CENTER&&r!=o.CENTER_RIGHT||(a-=this.element.offsetHeight/2);var u=Math.round(t[1]+a)+"px";this.rendered.top_!=u&&(this.rendered.top_=i.top=u)}},e.prototype.getOptions=function(){return this.options},e}(r.a);e.default=u}])});